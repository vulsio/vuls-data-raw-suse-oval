{
	"id": "oval:org.opensuse.security:def:202352637",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"Title": "CVE-2023-52637",
		"affected": {
			"family": "unix",
			"Platform": [
				"openSUSE Leap 15.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2023-52637",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52637",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2023-52637",
				"ref_url": "https://www.suse.com/security/cve/CVE-2023-52637",
				"source": "SUSE CVE"
			}
		],
		"Description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\ncan: j1939: Fix UAF in j1939_sk_match_filter during setsockopt(SO_J1939_FILTER)\n\nLock jsk->sk to prevent UAF when setsockopt(..., SO_J1939_FILTER, ...)\nmodifies jsk->filters while receiving packets.\n\nFollowing trace was seen on affected system:\n ==================================================================\n BUG: KASAN: slab-use-after-free in j1939_sk_recv_match_one+0x1af/0x2d0 [can_j1939]\n Read of size 4 at addr ffff888012144014 by task j1939/350\n\n CPU: 0 PID: 350 Comm: j1939 Tainted: G        W  OE      6.5.0-rc5 #1\n Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014\n Call Trace:\n  print_report+0xd3/0x620\n  ? kasan_complete_mode_report_info+0x7d/0x200\n  ? j1939_sk_recv_match_one+0x1af/0x2d0 [can_j1939]\n  kasan_report+0xc2/0x100\n  ? j1939_sk_recv_match_one+0x1af/0x2d0 [can_j1939]\n  __asan_load4+0x84/0xb0\n  j1939_sk_recv_match_one+0x1af/0x2d0 [can_j1939]\n  j1939_sk_recv+0x20b/0x320 [can_j1939]\n  ? __kasan_check_write+0x18/0x20\n  ? __pfx_j1939_sk_recv+0x10/0x10 [can_j1939]\n  ? j1939_simple_recv+0x69/0x280 [can_j1939]\n  ? j1939_ac_recv+0x5e/0x310 [can_j1939]\n  j1939_can_recv+0x43f/0x580 [can_j1939]\n  ? __pfx_j1939_can_recv+0x10/0x10 [can_j1939]\n  ? raw_rcv+0x42/0x3c0 [can_raw]\n  ? __pfx_j1939_can_recv+0x10/0x10 [can_j1939]\n  can_rcv_filter+0x11f/0x350 [can]\n  can_receive+0x12f/0x190 [can]\n  ? __pfx_can_rcv+0x10/0x10 [can]\n  can_rcv+0xdd/0x130 [can]\n  ? __pfx_can_rcv+0x10/0x10 [can]\n  __netif_receive_skb_one_core+0x13d/0x150\n  ? __pfx___netif_receive_skb_one_core+0x10/0x10\n  ? __kasan_check_write+0x18/0x20\n  ? _raw_spin_lock_irq+0x8c/0xe0\n  __netif_receive_skb+0x23/0xb0\n  process_backlog+0x107/0x260\n  __napi_poll+0x69/0x310\n  net_rx_action+0x2a1/0x580\n  ? __pfx_net_rx_action+0x10/0x10\n  ? __pfx__raw_spin_lock+0x10/0x10\n  ? handle_irq_event+0x7d/0xa0\n  __do_softirq+0xf3/0x3f8\n  do_softirq+0x53/0x80\n  </IRQ>\n  <TASK>\n  __local_bh_enable_ip+0x6e/0x70\n  netif_rx+0x16b/0x180\n  can_send+0x32b/0x520 [can]\n  ? __pfx_can_send+0x10/0x10 [can]\n  ? __check_object_size+0x299/0x410\n  raw_sendmsg+0x572/0x6d0 [can_raw]\n  ? __pfx_raw_sendmsg+0x10/0x10 [can_raw]\n  ? apparmor_socket_sendmsg+0x2f/0x40\n  ? __pfx_raw_sendmsg+0x10/0x10 [can_raw]\n  sock_sendmsg+0xef/0x100\n  sock_write_iter+0x162/0x220\n  ? __pfx_sock_write_iter+0x10/0x10\n  ? __rtnl_unlock+0x47/0x80\n  ? security_file_permission+0x54/0x320\n  vfs_write+0x6ba/0x750\n  ? __pfx_vfs_write+0x10/0x10\n  ? __fget_light+0x1ca/0x1f0\n  ? __rcu_read_unlock+0x5b/0x280\n  ksys_write+0x143/0x170\n  ? __pfx_ksys_write+0x10/0x10\n  ? __kasan_check_read+0x15/0x20\n  ? fpregs_assert_state_consistent+0x62/0x70\n  __x64_sys_write+0x47/0x60\n  do_syscall_64+0x60/0x90\n  ? do_syscall_64+0x6d/0x90\n  ? irqentry_exit+0x3f/0x50\n  ? exc_page_fault+0x79/0xf0\n  entry_SYSCALL_64_after_hwframe+0x6e/0xd8\n\n Allocated by task 348:\n  kasan_save_stack+0x2a/0x50\n  kasan_set_track+0x29/0x40\n  kasan_save_alloc_info+0x1f/0x30\n  __kasan_kmalloc+0xb5/0xc0\n  __kmalloc_node_track_caller+0x67/0x160\n  j1939_sk_setsockopt+0x284/0x450 [can_j1939]\n  __sys_setsockopt+0x15c/0x2f0\n  __x64_sys_setsockopt+0x6b/0x80\n  do_syscall_64+0x60/0x90\n  entry_SYSCALL_64_after_hwframe+0x6e/0xd8\n\n Freed by task 349:\n  kasan_save_stack+0x2a/0x50\n  kasan_set_track+0x29/0x40\n  kasan_save_free_info+0x2f/0x50\n  __kasan_slab_free+0x12e/0x1c0\n  __kmem_cache_free+0x1b9/0x380\n  kfree+0x7a/0x120\n  j1939_sk_setsockopt+0x3b2/0x450 [can_j1939]\n  __sys_setsockopt+0x15c/0x2f0\n  __x64_sys_setsockopt+0x6b/0x80\n  do_syscall_64+0x60/0x90\n  entry_SYSCALL_64_after_hwframe+0x6e/0xd8\n    ",
		"advisory": {
			"from": "security@suse.de",
			"Severity": "Moderate",
			"cve": {
				"text": "CVE-2023-52637",
				"href": "https://www.suse.com/security/cve/CVE-2023-52637/",
				"impact": "moderate",
				"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
			},
			"bugzilla": [
				{
					"text": "SUSE bug 1222291",
					"href": "https://bugzilla.suse.com/1222291"
				}
			],
			"issued": {
				"date": "2024-04-17"
			},
			"updated": {
				"date": "2024-04-17"
			},
			"affected_cpe_list": {
				"Cpe": [
					"cpe:/o:opensuse:leap:15.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855110",
								"comment": "cluster-md-kmp-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342853",
								"comment": "cluster-md-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855111",
								"comment": "dlm-kmp-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342855",
								"comment": "dlm-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855112",
								"comment": "gfs2-kmp-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342857",
								"comment": "gfs2-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855113",
								"comment": "kernel-devel-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342859",
								"comment": "kernel-devel-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855114",
								"comment": "kernel-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342860",
								"comment": "kernel-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855115",
								"comment": "kernel-rt-devel-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342861",
								"comment": "kernel-rt-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855116",
								"comment": "kernel-rt-extra-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342862",
								"comment": "kernel-rt-extra is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855117",
								"comment": "kernel-rt-livepatch-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771783",
								"comment": "kernel-rt-livepatch is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855118",
								"comment": "kernel-rt-livepatch-devel-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623297",
								"comment": "kernel-rt-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855119",
								"comment": "kernel-rt-optional-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771784",
								"comment": "kernel-rt-optional is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855120",
								"comment": "kernel-rt-vdso-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771785",
								"comment": "kernel-rt-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855121",
								"comment": "kernel-rt_debug-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342863",
								"comment": "kernel-rt_debug is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855122",
								"comment": "kernel-rt_debug-devel-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342864",
								"comment": "kernel-rt_debug-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855123",
								"comment": "kernel-rt_debug-livepatch-devel-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623299",
								"comment": "kernel-rt_debug-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855124",
								"comment": "kernel-rt_debug-vdso-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771786",
								"comment": "kernel-rt_debug-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855125",
								"comment": "kernel-source-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342866",
								"comment": "kernel-source-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855126",
								"comment": "kernel-syms-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342867",
								"comment": "kernel-syms-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855127",
								"comment": "kselftests-kmp-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342868",
								"comment": "kselftests-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855128",
								"comment": "ocfs2-kmp-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342870",
								"comment": "ocfs2-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009855129",
								"comment": "reiserfs-kmp-rt-5.14.21-150500.13.43.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342872",
								"comment": "reiserfs-kmp-rt is signed with openSUSE key"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009752682",
				"comment": "openSUSE Leap 15.5 is installed"
			}
		]
	}
}

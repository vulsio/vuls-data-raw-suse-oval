{
	"id": "oval:org.opensuse.security:def:20244418",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-4418",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap 15.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-4418",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4418",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-4418",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-4418",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:1962-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035508.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    A race condition leading to a stack use-after-free flaw was found in libvirt. Due to a bad assumption in the virNetClientIOEventLoop() method, the `data` pointer to a stack-allocated virNetClientIOEventData structure ended up being used in the virNetClientIOEventFD callback while the data pointer's stack frame was concurrently being \"freed\" when returning from virNetClientIOEventLoop(). The 'virtproxyd' daemon can be used to trigger requests. If libvirt is configured with fine-grained access control, this issue, in theory, allows a user to escape their otherwise limited access. This flaw allows a local, unprivileged user to access virtproxyd without authenticating. Remote users would need to authenticate before they could access it.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-4418 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-4418/",
					"impact": "medium",
					"cvss3": "6.2/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-4418 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-4418"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1223849",
					"href": "https://bugzilla.suse.com/1223849"
				}
			],
			"issued": {
				"date": "2024-05-10"
			},
			"updated": {
				"date": "2024-07-03"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap:15.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009333954",
						"comment": "libvirt is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334932",
						"comment": "libvirt-client is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009765257",
						"comment": "libvirt-client-qemu is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334933",
						"comment": "libvirt-daemon is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334934",
						"comment": "libvirt-daemon-config-network is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334935",
						"comment": "libvirt-daemon-config-nwfilter is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334936",
						"comment": "libvirt-daemon-driver-interface is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334937",
						"comment": "libvirt-daemon-driver-libxl is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334938",
						"comment": "libvirt-daemon-driver-lxc is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334939",
						"comment": "libvirt-daemon-driver-network is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334940",
						"comment": "libvirt-daemon-driver-nodedev is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334941",
						"comment": "libvirt-daemon-driver-nwfilter is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334942",
						"comment": "libvirt-daemon-driver-qemu is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334943",
						"comment": "libvirt-daemon-driver-secret is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334944",
						"comment": "libvirt-daemon-driver-storage is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336191",
						"comment": "libvirt-daemon-driver-storage-core is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336192",
						"comment": "libvirt-daemon-driver-storage-disk is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870789",
						"comment": "libvirt-daemon-driver-storage-gluster is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336193",
						"comment": "libvirt-daemon-driver-storage-iscsi is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009654620",
						"comment": "libvirt-daemon-driver-storage-iscsi-direct is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336194",
						"comment": "libvirt-daemon-driver-storage-logical is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336195",
						"comment": "libvirt-daemon-driver-storage-mpath is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336196",
						"comment": "libvirt-daemon-driver-storage-rbd is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336197",
						"comment": "libvirt-daemon-driver-storage-scsi is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335515",
						"comment": "libvirt-daemon-hooks is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334945",
						"comment": "libvirt-daemon-lxc is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334946",
						"comment": "libvirt-daemon-qemu is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334947",
						"comment": "libvirt-daemon-xen is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334950",
						"comment": "libvirt-devel is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009337083",
						"comment": "libvirt-devel-32bit is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334948",
						"comment": "libvirt-doc is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009336198",
						"comment": "libvirt-libs is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334949",
						"comment": "libvirt-lock-sanlock is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335514",
						"comment": "libvirt-nss is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870790",
						"comment": "wireshark-plugin-libvirt is not affected"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009752682",
				"comment": "openSUSE Leap 15.5 is installed"
			}
		]
	}
}

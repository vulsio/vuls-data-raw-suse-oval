{
	"id": "oval:org.opensuse.security:def:202147185",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2021-47185",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap 15.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2021-47185",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47185",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2021-47185",
				"ref_url": "https://www.suse.com/security/cve/CVE-2021-47185",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:1454-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-April/035109.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1490-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035140.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\ntty: tty_buffer: Fix the softlockup issue in flush_to_ldisc\n\nWhen running ltp testcase(ltp/testcases/kernel/pty/pty04.c) with arm64, there is a soft lockup,\nwhich look like this one:\n\n  Workqueue: events_unbound flush_to_ldisc\n  Call trace:\n   dump_backtrace+0x0/0x1ec\n   show_stack+0x24/0x30\n   dump_stack+0xd0/0x128\n   panic+0x15c/0x374\n   watchdog_timer_fn+0x2b8/0x304\n   __run_hrtimer+0x88/0x2c0\n   __hrtimer_run_queues+0xa4/0x120\n   hrtimer_interrupt+0xfc/0x270\n   arch_timer_handler_phys+0x40/0x50\n   handle_percpu_devid_irq+0x94/0x220\n   __handle_domain_irq+0x88/0xf0\n   gic_handle_irq+0x84/0xfc\n   el1_irq+0xc8/0x180\n   slip_unesc+0x80/0x214 [slip]\n   tty_ldisc_receive_buf+0x64/0x80\n   tty_port_default_receive_buf+0x50/0x90\n   flush_to_ldisc+0xbc/0x110\n   process_one_work+0x1d4/0x4b0\n   worker_thread+0x180/0x430\n   kthread+0x11c/0x120\n\nIn the testcase pty04, The first process call the write syscall to send\ndata to the pty master. At the same time, the workqueue will do the\nflush_to_ldisc to pop data in a loop until there is no more data left.\nWhen the sender and workqueue running in different core, the sender sends\ndata fastly in full time which will result in workqueue doing work in loop\nfor a long time and occuring softlockup in flush_to_ldisc with kernel\nconfigured without preempt. So I add need_resched check and cond_resched\nin the flush_to_ldisc loop to avoid it.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2021-47185 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2021-47185/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2021-47185 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2021-47185"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1222669",
					"href": "https://bugzilla.suse.com/1222669"
				}
			],
			"issued": {
				"date": "2024-05-04"
			},
			"updated": {
				"date": "2024-05-04"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap:15.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858782",
								"comment": "cluster-md-kmp-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623277",
								"comment": "cluster-md-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858783",
								"comment": "dlm-kmp-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623279",
								"comment": "dlm-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858784",
								"comment": "gfs2-kmp-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623281",
								"comment": "gfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858785",
								"comment": "kernel-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623283",
								"comment": "kernel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858786",
								"comment": "kernel-azure-devel-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623285",
								"comment": "kernel-azure-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858787",
								"comment": "kernel-azure-extra-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623286",
								"comment": "kernel-azure-extra is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858788",
								"comment": "kernel-azure-livepatch-devel-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623287",
								"comment": "kernel-azure-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858789",
								"comment": "kernel-azure-optional-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623427",
								"comment": "kernel-azure-optional is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858790",
								"comment": "kernel-azure-vdso-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009769740",
								"comment": "kernel-azure-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858791",
								"comment": "kernel-devel-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623293",
								"comment": "kernel-devel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858792",
								"comment": "kernel-source-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623300",
								"comment": "kernel-source-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858793",
								"comment": "kernel-syms-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623301",
								"comment": "kernel-syms-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858794",
								"comment": "kselftests-kmp-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623305",
								"comment": "kselftests-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858795",
								"comment": "ocfs2-kmp-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623306",
								"comment": "ocfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858796",
								"comment": "reiserfs-kmp-azure-5.14.21-150500.33.48.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623308",
								"comment": "reiserfs-kmp-azure is signed with openSUSE key"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009752682",
				"comment": "openSUSE Leap 15.5 is installed"
			}
		]
	}
}

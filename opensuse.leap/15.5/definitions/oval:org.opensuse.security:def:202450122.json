{
	"id": "oval:org.opensuse.security:def:202450122",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-50122",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap 15.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-50122",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50122",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-50122",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-50122",
				"source": "SUSE CVE"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: Hold rescan lock while adding devices during host probe\n\nSince adding the PCI power control code, we may end up with a race between\nthe pwrctl platform device rescanning the bus and host controller probe\nfunctions. The latter need to take the rescan lock when adding devices or\nwe may end up in an undefined state having two incompletely added devices\nand hit the following crash when trying to remove the device over sysfs:\n\n  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000\n  Internal error: Oops: 0000000096000004 [#1] SMP\n  Call trace:\n    __pi_strlen+0x14/0x150\n    kernfs_find_ns+0x80/0x13c\n    kernfs_remove_by_name_ns+0x54/0xf0\n    sysfs_remove_bin_file+0x24/0x34\n    pci_remove_resource_files+0x3c/0x84\n    pci_remove_sysfs_dev_files+0x28/0x38\n    pci_stop_bus_device+0x8c/0xd8\n    pci_stop_bus_device+0x40/0xd8\n    pci_stop_and_remove_bus_device_locked+0x28/0x48\n    remove_store+0x70/0xb0\n    dev_attr_store+0x20/0x38\n    sysfs_kf_write+0x58/0x78\n    kernfs_fop_write_iter+0xe8/0x184\n    vfs_write+0x2dc/0x308\n    ksys_write+0x7c/0xec\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-50122 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-50122/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-50122 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-50122"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1232930",
					"href": "https://bugzilla.suse.com/1232930"
				}
			],
			"issued": {
				"date": "2024-11-07"
			},
			"updated": {
				"date": "2024-11-07"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap:15.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729794",
						"comment": "cluster-md-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729795",
						"comment": "dlm-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729796",
						"comment": "gfs2-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334017",
						"comment": "kernel-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335423",
						"comment": "kernel-default-devel is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335424",
						"comment": "kernel-default-extra is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009728675",
						"comment": "kernel-default-livepatch is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009728676",
						"comment": "kernel-default-livepatch-devel is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870467",
						"comment": "kernel-default-optional is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870468",
						"comment": "kernel-default-vdso is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870469",
						"comment": "kselftests-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729797",
						"comment": "ocfs2-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009338037",
						"comment": "reiserfs-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334791",
						"comment": "kernel-devel is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334792",
						"comment": "kernel-macros is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009333928",
						"comment": "kernel-source is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870470",
						"comment": "kernel-source-vanilla is not affected"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009752682",
				"comment": "openSUSE Leap 15.5 is installed"
			}
		]
	}
}

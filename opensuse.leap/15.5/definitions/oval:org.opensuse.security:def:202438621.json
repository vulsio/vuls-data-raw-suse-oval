{
	"id": "oval:org.opensuse.security:def:202438621",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-38621",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap 15.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-38621",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-38621",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-38621",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-38621",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2360-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035874.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2372-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035868.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: stk1160: fix bounds checking in stk1160_copy_video()\n\nThe subtract in this condition is reversed.  The ->length is the length\nof the buffer.  The ->bytesused is how many bytes we have copied thus\nfar.  When the condition is reversed that means the result of the\nsubtraction is always negative but since it's unsigned then the result\nis a very high positive value.  That means the overflow check is never\ntrue.\n\nAdditionally, the ->bytesused doesn't actually work for this purpose\nbecause we're not writing to \"buf->mem + buf->bytesused\".  Instead, the\nmath to calculate the destination where we are writing is a bit\ninvolved.  You calculate the number of full lines already written,\nmultiply by two, skip a line if necessary so that we start on an odd\nnumbered line, and add the offset into the line.\n\nTo fix this buffer overflow, just take the actual destination where we\nare writing, if the offset is already out of bounds print an error and\nreturn.  Otherwise, write up to buf->length bytes.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-38621 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-38621/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-38621 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-38621"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1226895",
					"href": "https://bugzilla.suse.com/1226895"
				}
			],
			"issued": {
				"date": "2024-07-10"
			},
			"updated": {
				"date": "2024-07-10"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap:15.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871891",
								"comment": "cluster-md-kmp-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623277",
								"comment": "cluster-md-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871892",
								"comment": "dlm-kmp-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623279",
								"comment": "dlm-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871893",
								"comment": "gfs2-kmp-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623281",
								"comment": "gfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871894",
								"comment": "kernel-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623283",
								"comment": "kernel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871895",
								"comment": "kernel-azure-devel-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623285",
								"comment": "kernel-azure-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871896",
								"comment": "kernel-azure-extra-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623286",
								"comment": "kernel-azure-extra is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871897",
								"comment": "kernel-azure-livepatch-devel-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623287",
								"comment": "kernel-azure-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871898",
								"comment": "kernel-azure-optional-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623427",
								"comment": "kernel-azure-optional is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871899",
								"comment": "kernel-azure-vdso-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009769740",
								"comment": "kernel-azure-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871900",
								"comment": "kernel-devel-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623293",
								"comment": "kernel-devel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871901",
								"comment": "kernel-source-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623300",
								"comment": "kernel-source-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871902",
								"comment": "kernel-syms-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623301",
								"comment": "kernel-syms-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871903",
								"comment": "kselftests-kmp-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623305",
								"comment": "kselftests-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871904",
								"comment": "ocfs2-kmp-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623306",
								"comment": "ocfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009871905",
								"comment": "reiserfs-kmp-azure-5.14.21-150500.33.60.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623308",
								"comment": "reiserfs-kmp-azure is signed with openSUSE key"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009752682",
				"comment": "openSUSE Leap 15.5 is installed"
			}
		]
	}
}

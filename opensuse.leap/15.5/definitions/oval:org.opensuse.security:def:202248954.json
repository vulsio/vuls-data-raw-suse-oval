{
	"id": "oval:org.opensuse.security:def:202248954",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2022-48954",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap 15.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2022-48954",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48954",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2022-48954",
				"ref_url": "https://www.suse.com/security/cve/CVE-2022-48954",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3983-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019816.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3985-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019814.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4082-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019851.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4131-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019887.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\ns390/qeth: fix use-after-free in hsci\n\nKASAN found that addr was dereferenced after br2dev_event_work was freed.\n\n==================================================================\nBUG: KASAN: use-after-free in qeth_l2_br2dev_worker+0x5ba/0x6b0\nRead of size 1 at addr 00000000fdcea440 by task kworker/u760:4/540\nCPU: 17 PID: 540 Comm: kworker/u760:4 Tainted: G            E      6.1.0-20221128.rc7.git1.5aa3bed4ce83.300.fc36.s390x+kasan #1\nHardware name: IBM 8561 T01 703 (LPAR)\nWorkqueue: 0.0.8000_event qeth_l2_br2dev_worker\nCall Trace:\n [<000000016944d4ce>] dump_stack_lvl+0xc6/0xf8\n [<000000016942cd9c>] print_address_description.constprop.0+0x34/0x2a0\n [<000000016942d118>] print_report+0x110/0x1f8\n [<0000000167a7bd04>] kasan_report+0xfc/0x128\n [<000000016938d79a>] qeth_l2_br2dev_worker+0x5ba/0x6b0\n [<00000001673edd1e>] process_one_work+0x76e/0x1128\n [<00000001673ee85c>] worker_thread+0x184/0x1098\n [<000000016740718a>] kthread+0x26a/0x310\n [<00000001672c606a>] __ret_from_fork+0x8a/0xe8\n [<00000001694711da>] ret_from_fork+0xa/0x40\nAllocated by task 108338:\n kasan_save_stack+0x40/0x68\n kasan_set_track+0x36/0x48\n __kasan_kmalloc+0xa0/0xc0\n qeth_l2_switchdev_event+0x25a/0x738\n atomic_notifier_call_chain+0x9c/0xf8\n br_switchdev_fdb_notify+0xf4/0x110\n fdb_notify+0x122/0x180\n fdb_add_entry.constprop.0.isra.0+0x312/0x558\n br_fdb_add+0x59e/0x858\n rtnl_fdb_add+0x58a/0x928\n rtnetlink_rcv_msg+0x5f8/0x8d8\n netlink_rcv_skb+0x1f2/0x408\n netlink_unicast+0x570/0x790\n netlink_sendmsg+0x752/0xbe0\n sock_sendmsg+0xca/0x110\n ____sys_sendmsg+0x510/0x6a8\n ___sys_sendmsg+0x12a/0x180\n __sys_sendmsg+0xe6/0x168\n __do_sys_socketcall+0x3c8/0x468\n do_syscall+0x22c/0x328\n __do_syscall+0x94/0xf0\n system_call+0x82/0xb0\nFreed by task 540:\n kasan_save_stack+0x40/0x68\n kasan_set_track+0x36/0x48\n kasan_save_free_info+0x4c/0x68\n ____kasan_slab_free+0x14e/0x1a8\n __kasan_slab_free+0x24/0x30\n __kmem_cache_free+0x168/0x338\n qeth_l2_br2dev_worker+0x154/0x6b0\n process_one_work+0x76e/0x1128\n worker_thread+0x184/0x1098\n kthread+0x26a/0x310\n __ret_from_fork+0x8a/0xe8\n ret_from_fork+0xa/0x40\nLast potentially related work creation:\n kasan_save_stack+0x40/0x68\n __kasan_record_aux_stack+0xbe/0xd0\n insert_work+0x56/0x2e8\n __queue_work+0x4ce/0xd10\n queue_work_on+0xf4/0x100\n qeth_l2_switchdev_event+0x520/0x738\n atomic_notifier_call_chain+0x9c/0xf8\n br_switchdev_fdb_notify+0xf4/0x110\n fdb_notify+0x122/0x180\n fdb_add_entry.constprop.0.isra.0+0x312/0x558\n br_fdb_add+0x59e/0x858\n rtnl_fdb_add+0x58a/0x928\n rtnetlink_rcv_msg+0x5f8/0x8d8\n netlink_rcv_skb+0x1f2/0x408\n netlink_unicast+0x570/0x790\n netlink_sendmsg+0x752/0xbe0\n sock_sendmsg+0xca/0x110\n ____sys_sendmsg+0x510/0x6a8\n ___sys_sendmsg+0x12a/0x180\n __sys_sendmsg+0xe6/0x168\n __do_sys_socketcall+0x3c8/0x468\n do_syscall+0x22c/0x328\n __do_syscall+0x94/0xf0\n system_call+0x82/0xb0\nSecond to last potentially related work creation:\n kasan_save_stack+0x40/0x68\n __kasan_record_aux_stack+0xbe/0xd0\n kvfree_call_rcu+0xb2/0x760\n kernfs_unlink_open_file+0x348/0x430\n kernfs_fop_release+0xc2/0x320\n __fput+0x1ae/0x768\n task_work_run+0x1bc/0x298\n exit_to_user_mode_prepare+0x1a0/0x1a8\n __do_syscall+0x94/0xf0\n system_call+0x82/0xb0\nThe buggy address belongs to the object at 00000000fdcea400\n which belongs to the cache kmalloc-96 of size 96\nThe buggy address is located 64 bytes inside of\n 96-byte region [00000000fdcea400, 00000000fdcea460)\nThe buggy address belongs to the physical page:\npage:000000005a9c26e8 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0xfdcea\nflags: 0x3ffff00000000200(slab|node=0|zone=1|lastcpupid=0x1ffff)\nraw: 3ffff00000000200 0000000000000000 0000000100000122 000000008008cc00\nraw: 0000000000000000 0020004100000000 ffffffff00000001 0000000000000000\npage dumped because: kasan: bad access detected\nMemory state around the buggy address:\n 00000000fdcea300: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc\n 00000000fdcea380: fb fb fb fb fb fb f\n---truncated---\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2022-48954 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2022-48954/",
					"impact": "medium",
					"cvss3": "6.1/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H"
				},
				{
					"text": "CVE-2022-48954 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2022-48954",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1231972",
					"href": "https://bugzilla.suse.com/1231972"
				}
			],
			"issued": {
				"date": "2024-10-23"
			},
			"updated": {
				"date": "2024-12-03"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap:15.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952003",
								"comment": "cluster-md-kmp-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623277",
								"comment": "cluster-md-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952018",
								"comment": "cluster-md-kmp-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342853",
								"comment": "cluster-md-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952004",
								"comment": "dlm-kmp-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623279",
								"comment": "dlm-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952019",
								"comment": "dlm-kmp-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342855",
								"comment": "dlm-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952005",
								"comment": "gfs2-kmp-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623281",
								"comment": "gfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952020",
								"comment": "gfs2-kmp-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342857",
								"comment": "gfs2-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952006",
								"comment": "kernel-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623283",
								"comment": "kernel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952007",
								"comment": "kernel-azure-devel-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623285",
								"comment": "kernel-azure-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952008",
								"comment": "kernel-azure-extra-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623286",
								"comment": "kernel-azure-extra is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952009",
								"comment": "kernel-azure-livepatch-devel-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623287",
								"comment": "kernel-azure-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952010",
								"comment": "kernel-azure-optional-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623427",
								"comment": "kernel-azure-optional is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952011",
								"comment": "kernel-azure-vdso-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009769740",
								"comment": "kernel-azure-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952012",
								"comment": "kernel-devel-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623293",
								"comment": "kernel-devel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952021",
								"comment": "kernel-devel-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342859",
								"comment": "kernel-devel-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952022",
								"comment": "kernel-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342860",
								"comment": "kernel-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952023",
								"comment": "kernel-rt-devel-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342861",
								"comment": "kernel-rt-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952024",
								"comment": "kernel-rt-extra-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342862",
								"comment": "kernel-rt-extra is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952025",
								"comment": "kernel-rt-livepatch-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771783",
								"comment": "kernel-rt-livepatch is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952026",
								"comment": "kernel-rt-livepatch-devel-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623297",
								"comment": "kernel-rt-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952027",
								"comment": "kernel-rt-optional-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771784",
								"comment": "kernel-rt-optional is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952028",
								"comment": "kernel-rt-vdso-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771785",
								"comment": "kernel-rt-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952029",
								"comment": "kernel-rt_debug-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342863",
								"comment": "kernel-rt_debug is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952030",
								"comment": "kernel-rt_debug-devel-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342864",
								"comment": "kernel-rt_debug-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952031",
								"comment": "kernel-rt_debug-livepatch-devel-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623299",
								"comment": "kernel-rt_debug-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952032",
								"comment": "kernel-rt_debug-vdso-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771786",
								"comment": "kernel-rt_debug-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952013",
								"comment": "kernel-source-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623300",
								"comment": "kernel-source-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952033",
								"comment": "kernel-source-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342866",
								"comment": "kernel-source-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952014",
								"comment": "kernel-syms-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623301",
								"comment": "kernel-syms-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952034",
								"comment": "kernel-syms-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342867",
								"comment": "kernel-syms-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952015",
								"comment": "kselftests-kmp-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623305",
								"comment": "kselftests-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952035",
								"comment": "kselftests-kmp-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342868",
								"comment": "kselftests-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952016",
								"comment": "ocfs2-kmp-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623306",
								"comment": "ocfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952036",
								"comment": "ocfs2-kmp-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342870",
								"comment": "ocfs2-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952017",
								"comment": "reiserfs-kmp-azure-5.14.21-150500.33.72.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623308",
								"comment": "reiserfs-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952037",
								"comment": "reiserfs-kmp-rt-5.14.21-150500.13.76.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342872",
								"comment": "reiserfs-kmp-rt is signed with openSUSE key"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009752682",
				"comment": "openSUSE Leap 15.5 is installed"
			}
		]
	}
}

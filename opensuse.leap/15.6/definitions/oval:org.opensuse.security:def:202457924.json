{
	"id": "oval:org.opensuse.security:def:202457924",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-57924",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap 15.6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-57924",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-57924",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-57924",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-57924",
				"source": "SUSE CVE"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nfs: relax assertions on failure to encode file handles\n\nEncoding file handles is usually performed by a filesystem >encode_fh()\nmethod that may fail for various reasons.\n\nThe legacy users of exportfs_encode_fh(), namely, nfsd and\nname_to_handle_at(2) syscall are ready to cope with the possibility\nof failure to encode a file handle.\n\nThere are a few other users of exportfs_encode_{fh,fid}() that\ncurrently have a WARN_ON() assertion when ->encode_fh() fails.\nRelax those assertions because they are wrong.\n\nThe second linked bug report states commit 16aac5ad1fa9 (\"ovl: support\nencoding non-decodable file handles\") in v6.6 as the regressing commit,\nbut this is not accurate.\n\nThe aforementioned commit only increases the chances of the assertion\nand allows triggering the assertion with the reproducer using overlayfs,\ninotify and drop_caches.\n\nTriggering this assertion was always possible with other filesystems and\nother reasons of ->encode_fh() failures and more particularly, it was\nalso possible with the exact same reproducer using overlayfs that is\nmounted with options index=on,nfs_export=on also on kernels < v6.6.\nTherefore, I am not listing the aforementioned commit as a Fixes commit.\n\nBackport hint: this patch will have a trivial conflict applying to\nv6.6.y, and other trivial conflicts applying to stable kernels < v6.6.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-57924 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-57924/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-57924 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-57924"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1236086",
					"href": "https://bugzilla.suse.com/1236086"
				}
			],
			"issued": {
				"date": "2025-01-21"
			},
			"updated": {
				"date": "2025-01-21"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap:15.6"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009766997",
						"comment": "cluster-md-kmp-default is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009766998",
						"comment": "dlm-kmp-default is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009766999",
						"comment": "gfs2-kmp-default is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009338032",
						"comment": "kernel-default is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009338034",
						"comment": "kernel-default-devel is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009715290",
						"comment": "kernel-default-extra is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009764854",
						"comment": "kernel-default-livepatch is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009764855",
						"comment": "kernel-default-livepatch-devel is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870815",
						"comment": "kernel-default-optional is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870816",
						"comment": "kernel-default-vdso is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870817",
						"comment": "kselftests-kmp-default is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009767000",
						"comment": "ocfs2-kmp-default is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009338038",
						"comment": "reiserfs-kmp-default is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335275",
						"comment": "kernel-devel is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335276",
						"comment": "kernel-macros is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009333995",
						"comment": "kernel-source is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870818",
						"comment": "kernel-source-vanilla is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009340777",
						"comment": "kernel-devel-azure is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009340767",
						"comment": "kernel-source-azure is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009728713",
						"comment": "kernel-devel-rt is affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009728714",
						"comment": "kernel-source-rt is affected"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009864054",
				"comment": "openSUSE Leap 15.6 is installed"
			}
		]
	}
}

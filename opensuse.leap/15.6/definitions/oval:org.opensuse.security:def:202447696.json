{
	"id": "oval:org.opensuse.security:def:202447696",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-47696",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap 15.6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-47696",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47696",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-47696",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-47696",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3984-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019815.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3986-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019813.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "openSUSE-SU-2024:14500-1",
				"ref_url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/2NO44GTYBSPPWKFDREFWHITK4XKTNVLP/",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/iwcm: Fix WARNING:at_kernel/workqueue.c:#check_flush_dependency\n\nIn the commit aee2424246f9 (\"RDMA/iwcm: Fix a use-after-free related to\ndestroying CM IDs\"), the function flush_workqueue is invoked to flush the\nwork queue iwcm_wq.\n\nBut at that time, the work queue iwcm_wq was created via the function\nalloc_ordered_workqueue without the flag WQ_MEM_RECLAIM.\n\nBecause the current process is trying to flush the whole iwcm_wq, if\niwcm_wq doesn't have the flag WQ_MEM_RECLAIM, verify that the current\nprocess is not reclaiming memory or running on a workqueue which doesn't\nhave the flag WQ_MEM_RECLAIM as that can break forward-progress guarantee\nleading to a deadlock.\n\nThe call trace is as below:\n\n[  125.350876][ T1430] Call Trace:\n[  125.356281][ T1430]  <TASK>\n[ 125.361285][ T1430] ? __warn (kernel/panic.c:693)\n[ 125.367640][ T1430] ? check_flush_dependency (kernel/workqueue.c:3706 (discriminator 9))\n[ 125.375689][ T1430] ? report_bug (lib/bug.c:180 lib/bug.c:219)\n[ 125.382505][ T1430] ? handle_bug (arch/x86/kernel/traps.c:239)\n[ 125.388987][ T1430] ? exc_invalid_op (arch/x86/kernel/traps.c:260 (discriminator 1))\n[ 125.395831][ T1430] ? asm_exc_invalid_op (arch/x86/include/asm/idtentry.h:621)\n[ 125.403125][ T1430] ? check_flush_dependency (kernel/workqueue.c:3706 (discriminator 9))\n[ 125.410984][ T1430] ? check_flush_dependency (kernel/workqueue.c:3706 (discriminator 9))\n[ 125.418764][ T1430] __flush_workqueue (kernel/workqueue.c:3970)\n[ 125.426021][ T1430] ? __pfx___might_resched (kernel/sched/core.c:10151)\n[ 125.433431][ T1430] ? destroy_cm_id (drivers/infiniband/core/iwcm.c:375) iw_cm\n[ 125.441209][ T1430] ? __pfx___flush_workqueue (kernel/workqueue.c:3910)\n[ 125.473900][ T1430] ? _raw_spin_lock_irqsave (arch/x86/include/asm/atomic.h:107 include/linux/atomic/atomic-arch-fallback.h:2170 include/linux/atomic/atomic-instrumented.h:1302 include/asm-generic/qspinlock.h:111 include/linux/spinlock.h:187 include/linux/spinlock_api_smp.h:111 kernel/locking/spinlock.c:162)\n[ 125.473909][ T1430] ? __pfx__raw_spin_lock_irqsave (kernel/locking/spinlock.c:161)\n[ 125.482537][ T1430] _destroy_id (drivers/infiniband/core/cma.c:2044) rdma_cm\n[ 125.495072][ T1430] nvme_rdma_free_queue (drivers/nvme/host/rdma.c:656 drivers/nvme/host/rdma.c:650) nvme_rdma\n[ 125.505827][ T1430] nvme_rdma_reset_ctrl_work (drivers/nvme/host/rdma.c:2180) nvme_rdma\n[ 125.505831][ T1430] process_one_work (kernel/workqueue.c:3231)\n[ 125.515122][ T1430] worker_thread (kernel/workqueue.c:3306 kernel/workqueue.c:3393)\n[ 125.515127][ T1430] ? __pfx_worker_thread (kernel/workqueue.c:3339)\n[ 125.531837][ T1430] kthread (kernel/kthread.c:389)\n[ 125.539864][ T1430] ? __pfx_kthread (kernel/kthread.c:342)\n[ 125.550628][ T1430] ret_from_fork (arch/x86/kernel/process.c:147)\n[ 125.558840][ T1430] ? __pfx_kthread (kernel/kthread.c:342)\n[ 125.558844][ T1430] ret_from_fork_asm (arch/x86/entry/entry_64.S:257)\n[  125.566487][ T1430]  </TASK>\n[  125.566488][ T1430] ---[ end trace 0000000000000000 ]---\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-47696 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-47696/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-47696 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-47696",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1231864",
					"href": "https://bugzilla.suse.com/1231864"
				}
			],
			"issued": {
				"date": "2024-10-22"
			},
			"updated": {
				"date": "2024-11-17"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap:15.6"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952038",
								"comment": "cluster-md-kmp-azure-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623277",
								"comment": "cluster-md-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952053",
								"comment": "cluster-md-kmp-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342853",
								"comment": "cluster-md-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952039",
								"comment": "dlm-kmp-azure-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623279",
								"comment": "dlm-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952054",
								"comment": "dlm-kmp-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342855",
								"comment": "dlm-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952040",
								"comment": "gfs2-kmp-azure-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623281",
								"comment": "gfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952055",
								"comment": "gfs2-kmp-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342857",
								"comment": "gfs2-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952041",
								"comment": "kernel-azure-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623283",
								"comment": "kernel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952042",
								"comment": "kernel-azure-devel-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623285",
								"comment": "kernel-azure-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952043",
								"comment": "kernel-azure-extra-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623286",
								"comment": "kernel-azure-extra is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952044",
								"comment": "kernel-azure-livepatch-devel-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623287",
								"comment": "kernel-azure-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952045",
								"comment": "kernel-azure-optional-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623427",
								"comment": "kernel-azure-optional is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952046",
								"comment": "kernel-azure-vdso-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009769740",
								"comment": "kernel-azure-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952047",
								"comment": "kernel-devel-azure-6.4.0-150600.8.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623293",
								"comment": "kernel-devel-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952056",
								"comment": "kernel-devel-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342859",
								"comment": "kernel-devel-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952057",
								"comment": "kernel-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342860",
								"comment": "kernel-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952058",
								"comment": "kernel-rt-devel-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342861",
								"comment": "kernel-rt-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952059",
								"comment": "kernel-rt-extra-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342862",
								"comment": "kernel-rt-extra is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952060",
								"comment": "kernel-rt-livepatch-devel-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623297",
								"comment": "kernel-rt-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952061",
								"comment": "kernel-rt-optional-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771784",
								"comment": "kernel-rt-optional is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952062",
								"comment": "kernel-rt-vdso-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771785",
								"comment": "kernel-rt-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952063",
								"comment": "kernel-rt_debug-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342863",
								"comment": "kernel-rt_debug is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952064",
								"comment": "kernel-rt_debug-devel-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342864",
								"comment": "kernel-rt_debug-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952065",
								"comment": "kernel-rt_debug-livepatch-devel-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623299",
								"comment": "kernel-rt_debug-livepatch-devel is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952066",
								"comment": "kernel-rt_debug-vdso-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009771786",
								"comment": "kernel-rt_debug-vdso is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952048",
								"comment": "kernel-source-azure-6.4.0-150600.8.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623300",
								"comment": "kernel-source-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952067",
								"comment": "kernel-source-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342866",
								"comment": "kernel-source-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952049",
								"comment": "kernel-syms-azure-6.4.0-150600.8.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623301",
								"comment": "kernel-syms-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952068",
								"comment": "kernel-syms-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342867",
								"comment": "kernel-syms-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952050",
								"comment": "kselftests-kmp-azure-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623305",
								"comment": "kselftests-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952069",
								"comment": "kselftests-kmp-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342868",
								"comment": "kselftests-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952051",
								"comment": "ocfs2-kmp-azure-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623306",
								"comment": "ocfs2-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952070",
								"comment": "ocfs2-kmp-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342870",
								"comment": "ocfs2-kmp-rt is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952052",
								"comment": "reiserfs-kmp-azure-6.4.0-150600.8.17.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009623308",
								"comment": "reiserfs-kmp-azure is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009952071",
								"comment": "reiserfs-kmp-rt-6.4.0-150600.10.17.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342872",
								"comment": "reiserfs-kmp-rt is signed with openSUSE key"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729794",
						"comment": "cluster-md-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729795",
						"comment": "dlm-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729796",
						"comment": "gfs2-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334017",
						"comment": "kernel-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335423",
						"comment": "kernel-default-devel is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009335424",
						"comment": "kernel-default-extra is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009728675",
						"comment": "kernel-default-livepatch is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009728676",
						"comment": "kernel-default-livepatch-devel is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870467",
						"comment": "kernel-default-optional is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870468",
						"comment": "kernel-default-vdso is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870469",
						"comment": "kselftests-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729797",
						"comment": "ocfs2-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009338037",
						"comment": "reiserfs-kmp-default is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334791",
						"comment": "kernel-devel is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009334792",
						"comment": "kernel-macros is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009333928",
						"comment": "kernel-source is not affected"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009870470",
						"comment": "kernel-source-vanilla is not affected"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009864054",
				"comment": "openSUSE Leap 15.6 is installed"
			}
		]
	}
}

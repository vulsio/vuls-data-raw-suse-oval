{
	"id": "oval:org.opensuse.security:def:202436938",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-36938",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Micro 5.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-36938",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36938",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-36938",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-36938",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2008-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035569.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2019-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035578.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2190-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035732.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2360-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035874.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2381-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035895.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2561-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/019001.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2571-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/036103.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2896-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019185.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2973-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019280.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, skmsg: Fix NULL pointer dereference in sk_psock_skb_ingress_enqueue\n\nFix NULL pointer data-races in sk_psock_skb_ingress_enqueue() which\nsyzbot reported [1].\n\n[1]\nBUG: KCSAN: data-race in sk_psock_drop / sk_psock_skb_ingress_enqueue\n\nwrite to 0xffff88814b3278b8 of 8 bytes by task 10724 on cpu 1:\n sk_psock_stop_verdict net/core/skmsg.c:1257 [inline]\n sk_psock_drop+0x13e/0x1f0 net/core/skmsg.c:843\n sk_psock_put include/linux/skmsg.h:459 [inline]\n sock_map_close+0x1a7/0x260 net/core/sock_map.c:1648\n unix_release+0x4b/0x80 net/unix/af_unix.c:1048\n __sock_release net/socket.c:659 [inline]\n sock_close+0x68/0x150 net/socket.c:1421\n __fput+0x2c1/0x660 fs/file_table.c:422\n __fput_sync+0x44/0x60 fs/file_table.c:507\n __do_sys_close fs/open.c:1556 [inline]\n __se_sys_close+0x101/0x1b0 fs/open.c:1541\n __x64_sys_close+0x1f/0x30 fs/open.c:1541\n do_syscall_64+0xd3/0x1d0\n entry_SYSCALL_64_after_hwframe+0x6d/0x75\n\nread to 0xffff88814b3278b8 of 8 bytes by task 10713 on cpu 0:\n sk_psock_data_ready include/linux/skmsg.h:464 [inline]\n sk_psock_skb_ingress_enqueue+0x32d/0x390 net/core/skmsg.c:555\n sk_psock_skb_ingress_self+0x185/0x1e0 net/core/skmsg.c:606\n sk_psock_verdict_apply net/core/skmsg.c:1008 [inline]\n sk_psock_verdict_recv+0x3e4/0x4a0 net/core/skmsg.c:1202\n unix_read_skb net/unix/af_unix.c:2546 [inline]\n unix_stream_read_skb+0x9e/0xf0 net/unix/af_unix.c:2682\n sk_psock_verdict_data_ready+0x77/0x220 net/core/skmsg.c:1223\n unix_stream_sendmsg+0x527/0x860 net/unix/af_unix.c:2339\n sock_sendmsg_nosec net/socket.c:730 [inline]\n __sock_sendmsg+0x140/0x180 net/socket.c:745\n ____sys_sendmsg+0x312/0x410 net/socket.c:2584\n ___sys_sendmsg net/socket.c:2638 [inline]\n __sys_sendmsg+0x1e9/0x280 net/socket.c:2667\n __do_sys_sendmsg net/socket.c:2676 [inline]\n __se_sys_sendmsg net/socket.c:2674 [inline]\n __x64_sys_sendmsg+0x46/0x50 net/socket.c:2674\n do_syscall_64+0xd3/0x1d0\n entry_SYSCALL_64_after_hwframe+0x6d/0x75\n\nvalue changed: 0xffffffff83d7feb0 -> 0x0000000000000000\n\nReported by Kernel Concurrency Sanitizer on:\nCPU: 0 PID: 10713 Comm: syz-executor.4 Tainted: G        W          6.8.0-syzkaller-08951-gfe46a7dd189e #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 02/29/2024\n\nPrior to this, commit 4cd12c6065df (\"bpf, sockmap: Fix NULL pointer\ndereference in sk_psock_verdict_data_ready()\") fixed one NULL pointer\nsimilarly due to no protection of saved_data_ready. Here is another\ndifferent caller causing the same issue because of the same reason. So\nwe should protect it with sk_callback_lock read lock because the writer\nside in the sk_psock_drop() uses \"write_lock_bh(&sk->sk_callback_lock);\".\n\nTo avoid errors that could happen in future, I move those two pairs of\nlock into the sk_psock_data_ready(), which is suggested by John Fastabend.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-36938 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-36938/",
					"impact": "medium",
					"cvss3": "4.7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-36938 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-36938",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1225761",
					"href": "https://bugzilla.suse.com/1225761"
				}
			],
			"issued": {
				"date": "2024-10-18"
			},
			"updated": {
				"date": "2024-10-18"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-micro:5.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009869880",
						"comment": "kernel-default-5.14.21-150500.55.68.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009869881",
						"comment": "kernel-default-base-5.14.21-150500.55.68.1.150500.6.31.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009865619",
						"comment": "kernel-rt-5.14.21-150500.13.58.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009865630",
						"comment": "kernel-source-rt-5.14.21-150500.13.58.1 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009800388",
				"comment": "SUSE Linux Enterprise Micro 5.5 is installed"
			}
		]
	}
}

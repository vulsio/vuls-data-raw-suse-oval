{
	"id": "oval:org.opensuse.security:def:202426589",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-26589",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Micro 6.1"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-26589",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26589",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-26589",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-26589",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:0855-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018151.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0856-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018155.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0857-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018154.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0858-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018153.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0900-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018167.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0900-2",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018182.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0910-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018181.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0926-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018204.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0977-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018210.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Reject variable offset alu on PTR_TO_FLOW_KEYS\n\nFor PTR_TO_FLOW_KEYS, check_flow_keys_access() only uses fixed off\nfor validation. However, variable offset ptr alu is not prohibited\nfor this ptr kind. So the variable offset is not checked.\n\nThe following prog is accepted:\n\n  func#0 @0\n  0: R1=ctx() R10=fp0\n  0: (bf) r6 = r1                       ; R1=ctx() R6_w=ctx()\n  1: (79) r7 = *(u64 *)(r6 +144)        ; R6_w=ctx() R7_w=flow_keys()\n  2: (b7) r8 = 1024                     ; R8_w=1024\n  3: (37) r8 /= 1                       ; R8_w=scalar()\n  4: (57) r8 &= 1024                    ; R8_w=scalar(smin=smin32=0,\n  smax=umax=smax32=umax32=1024,var_off=(0x0; 0x400))\n  5: (0f) r7 += r8\n  mark_precise: frame0: last_idx 5 first_idx 0 subseq_idx -1\n  mark_precise: frame0: regs=r8 stack= before 4: (57) r8 &= 1024\n  mark_precise: frame0: regs=r8 stack= before 3: (37) r8 /= 1\n  mark_precise: frame0: regs=r8 stack= before 2: (b7) r8 = 1024\n  6: R7_w=flow_keys(smin=smin32=0,smax=umax=smax32=umax32=1024,var_off\n  =(0x0; 0x400)) R8_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=1024,\n  var_off=(0x0; 0x400))\n  6: (79) r0 = *(u64 *)(r7 +0)          ; R0_w=scalar()\n  7: (95) exit\n\nThis prog loads flow_keys to r7, and adds the variable offset r8\nto r7, and finally causes out-of-bounds access:\n\n  BUG: unable to handle page fault for address: ffffc90014c80038\n  [...]\n  Call Trace:\n   <TASK>\n   bpf_dispatcher_nop_func include/linux/bpf.h:1231 [inline]\n   __bpf_prog_run include/linux/filter.h:651 [inline]\n   bpf_prog_run include/linux/filter.h:658 [inline]\n   bpf_prog_run_pin_on_cpu include/linux/filter.h:675 [inline]\n   bpf_flow_dissect+0x15f/0x350 net/core/flow_dissector.c:991\n   bpf_prog_test_run_flow_dissector+0x39d/0x620 net/bpf/test_run.c:1359\n   bpf_prog_test_run kernel/bpf/syscall.c:4107 [inline]\n   __sys_bpf+0xf8f/0x4560 kernel/bpf/syscall.c:5475\n   __do_sys_bpf kernel/bpf/syscall.c:5561 [inline]\n   __se_sys_bpf kernel/bpf/syscall.c:5559 [inline]\n   __x64_sys_bpf+0x73/0xb0 kernel/bpf/syscall.c:5559\n   do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n   do_syscall_64+0x3f/0x110 arch/x86/entry/common.c:83\n   entry_SYSCALL_64_after_hwframe+0x63/0x6b\n\nFix this by rejecting ptr alu with variable offset on flow_keys.\nApplying the patch rejects the program with \"R7 pointer arithmetic\non flow_keys prohibited\".\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-26589 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-26589/",
					"impact": "medium",
					"cvss3": "4.4/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N"
				},
				{
					"text": "CVE-2024-26589 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-26589",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1220255",
					"href": "https://bugzilla.suse.com/1220255"
				}
			],
			"issued": {
				"date": "2024-11-24"
			},
			"updated": {
				"date": "2024-12-23"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sl-micro:6.1"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954203",
						"comment": "kernel-default-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954204",
						"comment": "kernel-default-devel-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954205",
						"comment": "kernel-default-extra-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954206",
						"comment": "kernel-default-livepatch-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954207",
						"comment": "kernel-devel-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954208",
						"comment": "kernel-devel-rt-6.4.0-10.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954209",
						"comment": "kernel-kvmsmall-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954210",
						"comment": "kernel-macros-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954211",
						"comment": "kernel-rt-6.4.0-10.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954212",
						"comment": "kernel-rt-devel-6.4.0-10.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954213",
						"comment": "kernel-source-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009954214",
						"comment": "kernel-source-rt-6.4.0-10.1 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009954035",
				"comment": "SUSE Linux Micro 6.1 is installed"
			}
		]
	}
}

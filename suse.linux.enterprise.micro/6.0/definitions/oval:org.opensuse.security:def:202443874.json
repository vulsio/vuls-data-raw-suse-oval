{
	"id": "oval:org.opensuse.security:def:202443874",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-43874",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Micro 6.0"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-43874",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-43874",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-43874",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-43874",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3194-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036835.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3195-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036842.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3383-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019497.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\ncrypto: ccp - Fix null pointer dereference in __sev_snp_shutdown_locked\n\nFix a null pointer dereference induced by DEBUG_TEST_DRIVER_REMOVE.\nReturn from __sev_snp_shutdown_locked() if the psp_device or the\nsev_device structs are not initialized. Without the fix, the driver will\nproduce the following splat:\n\n   ccp 0000:55:00.5: enabling device (0000 -> 0002)\n   ccp 0000:55:00.5: sev enabled\n   ccp 0000:55:00.5: psp enabled\n   BUG: kernel NULL pointer dereference, address: 00000000000000f0\n   #PF: supervisor read access in kernel mode\n   #PF: error_code(0x0000) - not-present page\n   PGD 0 P4D 0\n   Oops: 0000 [#1] PREEMPT SMP DEBUG_PAGEALLOC NOPTI\n   CPU: 262 PID: 1 Comm: swapper/0 Not tainted 6.9.0-rc1+ #29\n   RIP: 0010:__sev_snp_shutdown_locked+0x2e/0x150\n   Code: 00 55 48 89 e5 41 57 41 56 41 54 53 48 83 ec 10 41 89 f7 49 89 fe 65 48 8b 04 25 28 00 00 00 48 89 45 d8 48 8b 05 6a 5a 7f 06 <4c> 8b a0 f0 00 00 00 41 0f b6 9c 24 a2 00 00 00 48 83 fb 02 0f 83\n   RSP: 0018:ffffb2ea4014b7b8 EFLAGS: 00010286\n   RAX: 0000000000000000 RBX: ffff9e4acd2e0a28 RCX: 0000000000000000\n   RDX: 0000000000000000 RSI: 0000000000000000 RDI: ffffb2ea4014b808\n   RBP: ffffb2ea4014b7e8 R08: 0000000000000106 R09: 000000000003d9c0\n   R10: 0000000000000001 R11: ffffffffa39ff070 R12: ffff9e49d40590c8\n   R13: 0000000000000000 R14: ffffb2ea4014b808 R15: 0000000000000000\n   FS:  0000000000000000(0000) GS:ffff9e58b1e00000(0000) knlGS:0000000000000000\n   CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n   CR2: 00000000000000f0 CR3: 0000000418a3e001 CR4: 0000000000770ef0\n   PKRU: 55555554\n   Call Trace:\n    <TASK>\n    ? __die_body+0x6f/0xb0\n    ? __die+0xcc/0xf0\n    ? page_fault_oops+0x330/0x3a0\n    ? save_trace+0x2a5/0x360\n    ? do_user_addr_fault+0x583/0x630\n    ? exc_page_fault+0x81/0x120\n    ? asm_exc_page_fault+0x2b/0x30\n    ? __sev_snp_shutdown_locked+0x2e/0x150\n    __sev_firmware_shutdown+0x349/0x5b0\n    ? pm_runtime_barrier+0x66/0xe0\n    sev_dev_destroy+0x34/0xb0\n    psp_dev_destroy+0x27/0x60\n    sp_destroy+0x39/0x90\n    sp_pci_remove+0x22/0x60\n    pci_device_remove+0x4e/0x110\n    really_probe+0x271/0x4e0\n    __driver_probe_device+0x8f/0x160\n    driver_probe_device+0x24/0x120\n    __driver_attach+0xc7/0x280\n    ? driver_attach+0x30/0x30\n    bus_for_each_dev+0x10d/0x130\n    driver_attach+0x22/0x30\n    bus_add_driver+0x171/0x2b0\n    ? unaccepted_memory_init_kdump+0x20/0x20\n    driver_register+0x67/0x100\n    __pci_register_driver+0x83/0x90\n    sp_pci_init+0x22/0x30\n    sp_mod_init+0x13/0x30\n    do_one_initcall+0xb8/0x290\n    ? sched_clock_noinstr+0xd/0x10\n    ? local_clock_noinstr+0x3e/0x100\n    ? stack_depot_save_flags+0x21e/0x6a0\n    ? local_clock+0x1c/0x60\n    ? stack_depot_save_flags+0x21e/0x6a0\n    ? sched_clock_noinstr+0xd/0x10\n    ? local_clock_noinstr+0x3e/0x100\n    ? __lock_acquire+0xd90/0xe30\n    ? sched_clock_noinstr+0xd/0x10\n    ? local_clock_noinstr+0x3e/0x100\n    ? __create_object+0x66/0x100\n    ? local_clock+0x1c/0x60\n    ? __create_object+0x66/0x100\n    ? parameq+0x1b/0x90\n    ? parse_one+0x6d/0x1d0\n    ? parse_args+0xd7/0x1f0\n    ? do_initcall_level+0x180/0x180\n    do_initcall_level+0xb0/0x180\n    do_initcalls+0x60/0xa0\n    ? kernel_init+0x1f/0x1d0\n    do_basic_setup+0x41/0x50\n    kernel_init_freeable+0x1ac/0x230\n    ? rest_init+0x1f0/0x1f0\n    kernel_init+0x1f/0x1d0\n    ? rest_init+0x1f0/0x1f0\n    ret_from_fork+0x3d/0x50\n    ? rest_init+0x1f0/0x1f0\n    ret_from_fork_asm+0x11/0x20\n    </TASK>\n   Modules linked in:\n   CR2: 00000000000000f0\n   ---[ end trace 0000000000000000 ]---\n   RIP: 0010:__sev_snp_shutdown_locked+0x2e/0x150\n   Code: 00 55 48 89 e5 41 57 41 56 41 54 53 48 83 ec 10 41 89 f7 49 89 fe 65 48 8b 04 25 28 00 00 00 48 89 45 d8 48 8b 05 6a 5a 7f 06 <4c> 8b a0 f0 00 00 00 41 0f b6 9c 24 a2 00 00 00 48 83 fb 02 0f 83\n   RSP: 0018:ffffb2ea4014b7b8 EFLAGS: 00010286\n   RAX: 0000000000000000 RBX: ffff9e4acd2e0a28 RCX: 0000000000000000\n   RDX: 0000000\n---truncated---\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-43874 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-43874/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-43874 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-43874",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1229487",
					"href": "https://bugzilla.suse.com/1229487"
				}
			],
			"issued": {
				"date": "2024-11-05"
			},
			"updated": {
				"date": "2024-12-23"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sl-micro:6.0"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009951651",
						"comment": "kernel-default-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881569",
						"comment": "kernel-default-base-6.4.0-17.1.1.51 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009951652",
						"comment": "kernel-default-extra-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950952",
						"comment": "kernel-default-livepatch-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950953",
						"comment": "kernel-devel-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950959",
						"comment": "kernel-devel-rt-6.4.0-10.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950954",
						"comment": "kernel-kvmsmall-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950960",
						"comment": "kernel-livepatch-6_4_0-10-rt-1-1.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950955",
						"comment": "kernel-livepatch-6_4_0-19-default-1-1.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950956",
						"comment": "kernel-macros-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950961",
						"comment": "kernel-rt-6.4.0-10.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950957",
						"comment": "kernel-source-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950962",
						"comment": "kernel-source-rt-6.4.0-10.1 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009864179",
				"comment": "SUSE Linux Micro 6.0 is installed"
			}
		]
	}
}

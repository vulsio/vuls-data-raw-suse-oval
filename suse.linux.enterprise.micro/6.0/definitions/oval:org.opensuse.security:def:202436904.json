{
	"id": "oval:org.opensuse.security:def:202436904",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-36904",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Micro 6.0"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-36904",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36904",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-36904",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-36904",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2362-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035872.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2365-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035864.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2372-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035868.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2384-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035906.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2385-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035905.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2394-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035907.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2495-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018982.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2571-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/036103.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2896-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019185.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2939-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019211.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2973-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019280.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4120-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019886.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4122-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019885.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4123-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019884.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4124-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019883.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4125-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019882.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4127-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019881.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4129-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019879.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4141-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019888.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4177-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019912.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4179-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019919.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4180-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019918.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4206-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019926.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4207-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019925.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4208-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019924.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4214-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019935.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4216-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019934.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4217-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019933.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4218-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019941.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4220-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019939.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4227-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019949.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4228-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019948.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4230-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019947.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4231-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019946.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4234-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019945.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4235-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019944.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4236-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019943.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4241-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019959.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4242-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019958.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4243-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019957.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4246-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019956.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4250-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019952.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4256-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019964.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4263-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019971.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4264-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019970.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4265-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019969.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4266-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019968.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\ntcp: Use refcount_inc_not_zero() in tcp_twsk_unique().\n\nAnderson Nascimento reported a use-after-free splat in tcp_twsk_unique()\nwith nice analysis.\n\nSince commit ec94c2696f0b (\"tcp/dccp: avoid one atomic operation for\ntimewait hashdance\"), inet_twsk_hashdance() sets TIME-WAIT socket's\nsk_refcnt after putting it into ehash and releasing the bucket lock.\n\nThus, there is a small race window where other threads could try to\nreuse the port during connect() and call sock_hold() in tcp_twsk_unique()\nfor the TIME-WAIT socket with zero refcnt.\n\nIf that happens, the refcnt taken by tcp_twsk_unique() is overwritten\nand sock_put() will cause underflow, triggering a real use-after-free\nsomewhere else.\n\nTo avoid the use-after-free, we need to use refcount_inc_not_zero() in\ntcp_twsk_unique() and give up on reusing the port if it returns false.\n\n[0]:\nrefcount_t: addition on 0; use-after-free.\nWARNING: CPU: 0 PID: 1039313 at lib/refcount.c:25 refcount_warn_saturate+0xe5/0x110\nCPU: 0 PID: 1039313 Comm: trigger Not tainted 6.8.6-200.fc39.x86_64 #1\nHardware name: VMware, Inc. VMware20,1/440BX Desktop Reference Platform, BIOS VMW201.00V.21805430.B64.2305221830 05/22/2023\nRIP: 0010:refcount_warn_saturate+0xe5/0x110\nCode: 42 8e ff 0f 0b c3 cc cc cc cc 80 3d aa 13 ea 01 00 0f 85 5e ff ff ff 48 c7 c7 f8 8e b7 82 c6 05 96 13 ea 01 01 e8 7b 42 8e ff <0f> 0b c3 cc cc cc cc 48 c7 c7 50 8f b7 82 c6 05 7a 13 ea 01 01 e8\nRSP: 0018:ffffc90006b43b60 EFLAGS: 00010282\nRAX: 0000000000000000 RBX: ffff888009bb3ef0 RCX: 0000000000000027\nRDX: ffff88807be218c8 RSI: 0000000000000001 RDI: ffff88807be218c0\nRBP: 0000000000069d70 R08: 0000000000000000 R09: ffffc90006b439f0\nR10: ffffc90006b439e8 R11: 0000000000000003 R12: ffff8880029ede84\nR13: 0000000000004e20 R14: ffffffff84356dc0 R15: ffff888009bb3ef0\nFS:  00007f62c10926c0(0000) GS:ffff88807be00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000000020ccb000 CR3: 000000004628c005 CR4: 0000000000f70ef0\nPKRU: 55555554\nCall Trace:\n <TASK>\n ? refcount_warn_saturate+0xe5/0x110\n ? __warn+0x81/0x130\n ? refcount_warn_saturate+0xe5/0x110\n ? report_bug+0x171/0x1a0\n ? refcount_warn_saturate+0xe5/0x110\n ? handle_bug+0x3c/0x80\n ? exc_invalid_op+0x17/0x70\n ? asm_exc_invalid_op+0x1a/0x20\n ? refcount_warn_saturate+0xe5/0x110\n tcp_twsk_unique+0x186/0x190\n __inet_check_established+0x176/0x2d0\n __inet_hash_connect+0x74/0x7d0\n ? __pfx___inet_check_established+0x10/0x10\n tcp_v4_connect+0x278/0x530\n __inet_stream_connect+0x10f/0x3d0\n inet_stream_connect+0x3a/0x60\n __sys_connect+0xa8/0xd0\n __x64_sys_connect+0x18/0x20\n do_syscall_64+0x83/0x170\n entry_SYSCALL_64_after_hwframe+0x78/0x80\nRIP: 0033:0x7f62c11a885d\nCode: ff c3 66 2e 0f 1f 84 00 00 00 00 00 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d a3 45 0c 00 f7 d8 64 89 01 48\nRSP: 002b:00007f62c1091e58 EFLAGS: 00000296 ORIG_RAX: 000000000000002a\nRAX: ffffffffffffffda RBX: 0000000020ccb004 RCX: 00007f62c11a885d\nRDX: 0000000000000010 RSI: 0000000020ccb000 RDI: 0000000000000003\nRBP: 00007f62c1091e90 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000296 R12: 00007f62c10926c0\nR13: ffffffffffffff88 R14: 0000000000000000 R15: 00007ffe237885b0\n </TASK>\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-36904 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-36904/",
					"impact": "high",
					"cvss3": "7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-36904 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-36904"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1225732",
					"href": "https://bugzilla.suse.com/1225732"
				},
				{
					"text": "SUSE bug 1225733",
					"href": "https://bugzilla.suse.com/1225733"
				}
			],
			"issued": {
				"date": "2024-11-30"
			},
			"updated": {
				"date": "2024-12-10"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sl-micro:6.0"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881568",
						"comment": "kernel-default-6.4.0-18.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881569",
						"comment": "kernel-default-base-6.4.0-17.1.1.51 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881570",
						"comment": "kernel-default-extra-6.4.0-18.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950906",
						"comment": "kernel-default-livepatch-6.4.0-18.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881571",
						"comment": "kernel-devel-6.4.0-18.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009942881",
						"comment": "kernel-devel-rt-6.4.0-9.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881572",
						"comment": "kernel-kvmsmall-6.4.0-18.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881573",
						"comment": "kernel-macros-6.4.0-18.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009942882",
						"comment": "kernel-rt-6.4.0-9.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009881574",
						"comment": "kernel-source-6.4.0-18.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009942883",
						"comment": "kernel-source-rt-6.4.0-9.1 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009864179",
				"comment": "SUSE Linux Enterprise Micro 6.0 is installed"
			}
		]
	}
}

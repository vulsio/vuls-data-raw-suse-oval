{
	"id": "oval:org.opensuse.security:def:202440954",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-40954",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Micro 6.0"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-40954",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-40954",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-40954",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-40954",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "RHSA-2024:7000",
				"ref_url": "https://lists.suse.com/pipermail/suse-liberty-linux-updates/2024-September/000095.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2894-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036430.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2902-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036443.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2929-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036473.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2939-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019211.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2947-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036488.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3194-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036835.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3195-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036842.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3383-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019497.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3623-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019600.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3624-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019601.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3625-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019599.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3626-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019598.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3627-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019597.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3628-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019596.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3631-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037247.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3632-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037246.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3635-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037248.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3636-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019603.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3638-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037254.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3639-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019610.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3643-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019614.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3655-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019616.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3666-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037295.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3670-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037292.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3672-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037291.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3679-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037287.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3680-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037286.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3694-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037288.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3695-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037284.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3696-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037283.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3697-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037282.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3700-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019632.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3701-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019631.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3702-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019630.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3706-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019651.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3707-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037299.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3708-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019653.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3710-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037298.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3780-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019696.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3793-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019702.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3806-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019710.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3815-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019732.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3829-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019726.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3830-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019725.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3831-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019724.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3833-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019723.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3835-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019721.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3836-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019720.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3837-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019719.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3840-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019735.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3842-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019734.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3851-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019740.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3852-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019739.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3855-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019737.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3856-1",
				"ref_url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/2LSLV3QQQYIAV376IANSLYZETKMXDLVZ/",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3857-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019748.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3860-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019750.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3880-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019771.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3881-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019770.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3882-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019769.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3884-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019768.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnet: do not leave a dangling sk pointer, when socket creation fails\n\nIt is possible to trigger a use-after-free by:\n  * attaching an fentry probe to __sock_release() and the probe calling the\n    bpf_get_socket_cookie() helper\n  * running traceroute -I 1.1.1.1 on a freshly booted VM\n\nA KASAN enabled kernel will log something like below (decoded and stripped):\n==================================================================\nBUG: KASAN: slab-use-after-free in __sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nRead of size 8 at addr ffff888007110dd8 by task traceroute/299\n\nCPU: 2 PID: 299 Comm: traceroute Tainted: G            E      6.10.0-rc2+ #2\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014\nCall Trace:\n <TASK>\ndump_stack_lvl (lib/dump_stack.c:117 (discriminator 1))\nprint_report (mm/kasan/report.c:378 mm/kasan/report.c:488)\n? __sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nkasan_report (mm/kasan/report.c:603)\n? __sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nkasan_check_range (mm/kasan/generic.c:183 mm/kasan/generic.c:189)\n__sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nbpf_get_socket_ptr_cookie (./arch/x86/include/asm/preempt.h:94 ./include/linux/sock_diag.h:42 net/core/filter.c:5094 net/core/filter.c:5092)\nbpf_prog_875642cf11f1d139___sock_release+0x6e/0x8e\nbpf_trampoline_6442506592+0x47/0xaf\n__sock_release (net/socket.c:652)\n__sock_create (net/socket.c:1601)\n...\nAllocated by task 299 on cpu 2 at 78.328492s:\nkasan_save_stack (mm/kasan/common.c:48)\nkasan_save_track (mm/kasan/common.c:68)\n__kasan_slab_alloc (mm/kasan/common.c:312 mm/kasan/common.c:338)\nkmem_cache_alloc_noprof (mm/slub.c:3941 mm/slub.c:4000 mm/slub.c:4007)\nsk_prot_alloc (net/core/sock.c:2075)\nsk_alloc (net/core/sock.c:2134)\ninet_create (net/ipv4/af_inet.c:327 net/ipv4/af_inet.c:252)\n__sock_create (net/socket.c:1572)\n__sys_socket (net/socket.c:1660 net/socket.c:1644 net/socket.c:1706)\n__x64_sys_socket (net/socket.c:1718)\ndo_syscall_64 (arch/x86/entry/common.c:52 arch/x86/entry/common.c:83)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\n\nFreed by task 299 on cpu 2 at 78.328502s:\nkasan_save_stack (mm/kasan/common.c:48)\nkasan_save_track (mm/kasan/common.c:68)\nkasan_save_free_info (mm/kasan/generic.c:582)\npoison_slab_object (mm/kasan/common.c:242)\n__kasan_slab_free (mm/kasan/common.c:256)\nkmem_cache_free (mm/slub.c:4437 mm/slub.c:4511)\n__sk_destruct (net/core/sock.c:2117 net/core/sock.c:2208)\ninet_create (net/ipv4/af_inet.c:397 net/ipv4/af_inet.c:252)\n__sock_create (net/socket.c:1572)\n__sys_socket (net/socket.c:1660 net/socket.c:1644 net/socket.c:1706)\n__x64_sys_socket (net/socket.c:1718)\ndo_syscall_64 (arch/x86/entry/common.c:52 arch/x86/entry/common.c:83)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\n\nFix this by clearing the struct socket reference in sk_common_release() to cover\nall protocol families create functions, which may already attached the\nreference to the sk object with sock_init_data().\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-40954 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-40954/",
					"impact": "high",
					"cvss3": "7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-40954 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-40954",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1227808",
					"href": "https://bugzilla.suse.com/1227808"
				},
				{
					"text": "SUSE bug 1228786",
					"href": "https://bugzilla.suse.com/1228786"
				}
			],
			"issued": {
				"date": "2024-11-05"
			},
			"updated": {
				"date": "2024-11-05"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sl-micro:6.0"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950949",
						"comment": "kernel-default-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950950",
						"comment": "kernel-default-base-6.4.0-17.1.1.51 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950951",
						"comment": "kernel-default-extra-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950952",
						"comment": "kernel-default-livepatch-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950953",
						"comment": "kernel-devel-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950959",
						"comment": "kernel-devel-rt-6.4.0-10.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950954",
						"comment": "kernel-kvmsmall-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950960",
						"comment": "kernel-livepatch-6_4_0-10-rt-1-1.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950955",
						"comment": "kernel-livepatch-6_4_0-19-default-1-1.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950956",
						"comment": "kernel-macros-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950961",
						"comment": "kernel-rt-6.4.0-10.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950957",
						"comment": "kernel-source-6.4.0-19.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009950962",
						"comment": "kernel-source-rt-6.4.0-10.1 is installed"
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009864179",
				"comment": "SUSE Linux Enterprise Micro 6.0 is installed"
			}
		]
	}
}

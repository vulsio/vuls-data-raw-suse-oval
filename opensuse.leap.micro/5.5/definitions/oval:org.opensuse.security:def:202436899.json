{
	"id": "oval:org.opensuse.security:def:202436899",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-36899",
		"affected": {
			"family": "unix",
			"platform": [
				"openSUSE Leap Micro 5.5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-36899",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36899",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-36899",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-36899",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "RHSA-2024:6997",
				"ref_url": "https://lists.suse.com/pipermail/suse-liberty-linux-updates/2024-September/000081.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2372-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035868.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2385-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035905.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2394-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035907.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2495-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018982.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2571-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/036103.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2896-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019185.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2939-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019211.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2973-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019280.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3623-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019600.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3624-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019601.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3625-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019599.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3628-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019596.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3631-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037247.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3632-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037246.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3635-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037248.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3636-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019603.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3638-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037254.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3639-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019610.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3643-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019614.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3655-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019616.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3666-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037295.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3670-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037292.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3672-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037291.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3679-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037287.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3680-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037286.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3694-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037288.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3695-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037284.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3696-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037283.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3697-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037282.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3700-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019632.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3701-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019631.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3702-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019630.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3706-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019651.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3710-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037298.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3780-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019696.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3793-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019702.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3806-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019710.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3815-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019732.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3829-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019726.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3830-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019725.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3831-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019724.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3833-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019723.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3837-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019719.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3840-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019735.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3842-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019734.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3851-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019740.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3852-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019739.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3855-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019737.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3857-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019748.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3860-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019750.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3880-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019771.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3881-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019770.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4122-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019885.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4123-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019884.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4124-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019883.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4125-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019882.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4127-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019881.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4207-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019925.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4208-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019924.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4214-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019935.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4216-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019934.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4218-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019941.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4228-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019948.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4234-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019945.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4235-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019944.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4236-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019943.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4243-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019957.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4266-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019968.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4275-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019975.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\ngpiolib: cdev: Fix use after free in lineinfo_changed_notify\n\nThe use-after-free issue occurs as follows: when the GPIO chip device file\nis being closed by invoking gpio_chrdev_release(), watched_lines is freed\nby bitmap_free(), but the unregistration of lineinfo_changed_nb notifier\nchain failed due to waiting write rwsem. Additionally, one of the GPIO\nchip's lines is also in the release process and holds the notifier chain's\nread rwsem. Consequently, a race condition leads to the use-after-free of\nwatched_lines.\n\nHere is the typical stack when issue happened:\n\n[free]\ngpio_chrdev_release()\n  --> bitmap_free(cdev->watched_lines)                  <-- freed\n  --> blocking_notifier_chain_unregister()\n    --> down_write(&nh->rwsem)                          <-- waiting rwsem\n          --> __down_write_common()\n            --> rwsem_down_write_slowpath()\n                  --> schedule_preempt_disabled()\n                    --> schedule()\n\n[use]\nst54spi_gpio_dev_release()\n  --> gpio_free()\n    --> gpiod_free()\n      --> gpiod_free_commit()\n        --> gpiod_line_state_notify()\n          --> blocking_notifier_call_chain()\n            --> down_read(&nh->rwsem);                  <-- held rwsem\n            --> notifier_call_chain()\n              --> lineinfo_changed_notify()\n                --> test_bit(xxxx, cdev->watched_lines) <-- use after free\n\nThe side effect of the use-after-free issue is that a GPIO line event is\nbeing generated for userspace where it shouldn't. However, since the chrdev\nis being closed, userspace won't have the chance to read that event anyway.\n\nTo fix the issue, call the bitmap_free() function after the unregistration\nof lineinfo_changed_nb notifier chain.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-36899 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-36899/",
					"impact": "high",
					"cvss3": "7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-36899 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-36899"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1225737",
					"href": "https://bugzilla.suse.com/1225737"
				},
				{
					"text": "SUSE bug 1225739",
					"href": "https://bugzilla.suse.com/1225739"
				}
			],
			"issued": {
				"date": "2024-07-11"
			},
			"updated": {
				"date": "2024-12-11"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:opensuse:leap-micro:5.5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterias": [
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009880171",
								"comment": "kernel-default-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009151354",
								"comment": "kernel-default is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009880170",
								"comment": "kernel-default-base-5.14.21-150500.55.73.1.150500.6.33.8 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009151960",
								"comment": "kernel-default-base is signed with openSUSE key"
							}
						]
					},
					{
						"operator": "AND",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009872349",
								"comment": "kernel-rt-5.14.21-150500.13.61.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009342860",
								"comment": "kernel-rt is signed with openSUSE key"
							}
						]
					}
				]
			}
		],
		"criterions": [
			{
				"test_ref": "oval:org.opensuse.security:tst:2009799821",
				"comment": "openSUSE Leap Micro 5.5 is installed"
			}
		]
	}
}

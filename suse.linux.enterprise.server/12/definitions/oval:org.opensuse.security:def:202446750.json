{
	"id": "oval:org.opensuse.security:def:202446750",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-46750",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 12 SP5",
				"SUSE Linux Enterprise Real Time 12 SP5",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"SUSE Linux Enterprise Workstation Extension 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-46750",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-46750",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-46750",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-46750",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3551-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037163.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3553-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037161.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3559-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037179.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3561-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019580.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3564-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037178.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3566-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019578.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3569-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019576.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: Add missing bridge lock to pci_bus_lock()\n\nOne of the true positives that the cfg_access_lock lockdep effort\nidentified is this sequence:\n\n  WARNING: CPU: 14 PID: 1 at drivers/pci/pci.c:4886 pci_bridge_secondary_bus_reset+0x5d/0x70\n  RIP: 0010:pci_bridge_secondary_bus_reset+0x5d/0x70\n  Call Trace:\n   <TASK>\n   ? __warn+0x8c/0x190\n   ? pci_bridge_secondary_bus_reset+0x5d/0x70\n   ? report_bug+0x1f8/0x200\n   ? handle_bug+0x3c/0x70\n   ? exc_invalid_op+0x18/0x70\n   ? asm_exc_invalid_op+0x1a/0x20\n   ? pci_bridge_secondary_bus_reset+0x5d/0x70\n   pci_reset_bus+0x1d8/0x270\n   vmd_probe+0x778/0xa10\n   pci_device_probe+0x95/0x120\n\nWhere pci_reset_bus() users are triggering unlocked secondary bus resets.\nIronically pci_bus_reset(), several calls down from pci_reset_bus(), uses\npci_bus_lock() before issuing the reset which locks everything *but* the\nbridge itself.\n\nFor the same motivation as adding:\n\n  bridge = pci_upstream_bridge(dev);\n  if (bridge)\n    pci_dev_lock(bridge);\n\nto pci_reset_function() for the \"bus\" and \"cxl_bus\" reset cases, add\npci_dev_lock() for @bus->self to pci_bus_lock().\n\n[bhelgaas: squash in recursive locking deadlock fix from Keith Busch:\nhttps://lore.kernel.org/r/20240711193650.701834-1-kbusch@meta.com]\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-46750 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-46750/",
					"impact": "medium",
					"cvss3": "4.7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-46750 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-46750",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1230783",
					"href": "https://bugzilla.suse.com/1230783"
				}
			],
			"issued": {
				"date": "2024-10-10"
			},
			"updated": {
				"date": "2024-10-10"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-live-patching:12:sp5",
					"cpe:/o:suse:sle-we:12:sp5",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp5",
					"cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258650",
								"comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009946372",
						"comment": "kernel-default-extra-4.12.14-122.231.1 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946334",
								"comment": "kernel-default-kgraft-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946335",
								"comment": "kernel-default-kgraft-devel-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946336",
								"comment": "kgraft-patch-4_12_14-122_231-default-1-8.3.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009273148",
						"comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946337",
								"comment": "cluster-md-kmp-rt-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946338",
								"comment": "dlm-kmp-rt-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946339",
								"comment": "gfs2-kmp-rt-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946340",
								"comment": "kernel-devel-rt-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946341",
								"comment": "kernel-rt-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946342",
								"comment": "kernel-rt-base-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946343",
								"comment": "kernel-rt-devel-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946344",
								"comment": "kernel-rt_debug-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946345",
								"comment": "kernel-rt_debug-devel-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946346",
								"comment": "kernel-source-rt-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946347",
								"comment": "kernel-syms-rt-4.12.14-10.203.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946348",
								"comment": "ocfs2-kmp-rt-4.12.14-10.203.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009279486",
						"comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946356",
								"comment": "kernel-default-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946357",
								"comment": "kernel-default-base-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946358",
								"comment": "kernel-default-devel-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946359",
								"comment": "kernel-default-man-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946360",
								"comment": "kernel-devel-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946361",
								"comment": "kernel-macros-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946362",
								"comment": "kernel-source-4.12.14-122.231.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009946363",
								"comment": "kernel-syms-4.12.14-122.231.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:202147517",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2021-47517",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 12 SP5",
				"SUSE Linux Enterprise Real Time 12 SP5",
				"SUSE Linux Enterprise Server 12 SP4-LTSS",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP4",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"SUSE Linux Enterprise Workstation Extension 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2021-47517",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47517",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2021-47517",
				"ref_url": "https://www.suse.com/security/cve/CVE-2021-47517",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3190-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019403.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3209-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036854.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3483-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/037089.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4120-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019886.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4122-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019885.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4123-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019884.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4124-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019883.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4125-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019882.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4127-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019881.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4128-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019880.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4141-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019888.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4160-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019905.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4206-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019926.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4207-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019925.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4214-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019935.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4216-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019934.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4218-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019941.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4220-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019939.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4227-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019949.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4228-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019948.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4240-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019960.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4243-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019957.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0114-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020121.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0115-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020120.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0138-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020140.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0146-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020144.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0158-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020154.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0164-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020153.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0181-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020173.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nethtool: do not perform operations on net devices being unregistered\n\nThere is a short period between a net device starts to be unregistered\nand when it is actually gone. In that time frame ethtool operations\ncould still be performed, which might end up in unwanted or undefined\nbehaviours[1].\n\nDo not allow ethtool operations after a net device starts its\nunregistration. This patch targets the netlink part as the ioctl one\nisn't affected: the reference to the net device is taken and the\noperation is executed within an rtnl lock section and the net device\nwon't be found after unregister.\n\n[1] For example adding Tx queues after unregister ends up in NULL\n    pointer exceptions and UaFs, such as:\n\n      BUG: KASAN: use-after-free in kobject_get+0x14/0x90\n      Read of size 1 at addr ffff88801961248c by task ethtool/755\n\n      CPU: 0 PID: 755 Comm: ethtool Not tainted 5.15.0-rc6+ #778\n      Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-4.fc34 04/014\n      Call Trace:\n       dump_stack_lvl+0x57/0x72\n       print_address_description.constprop.0+0x1f/0x140\n       kasan_report.cold+0x7f/0x11b\n       kobject_get+0x14/0x90\n       kobject_add_internal+0x3d1/0x450\n       kobject_init_and_add+0xba/0xf0\n       netdev_queue_update_kobjects+0xcf/0x200\n       netif_set_real_num_tx_queues+0xb4/0x310\n       veth_set_channels+0x1c3/0x550\n       ethnl_set_channels+0x524/0x610\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2021-47517 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2021-47517/",
					"impact": "medium",
					"cvss3": "6.5/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:H"
				},
				{
					"text": "CVE-2021-47517 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2021-47517"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1225428",
					"href": "https://bugzilla.suse.com/1225428"
				}
			],
			"issued": {
				"date": "2024-05-29"
			},
			"updated": {
				"date": "2025-01-22"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-live-patching:12:sp5",
					"cpe:/o:suse:sle-we:12:sp5",
					"cpe:/o:suse:sles-ltss:12:sp4",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp4",
					"cpe:/o:suse:sles_sap:12:sp5",
					"cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340305",
								"comment": "kernel-source-azure is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258806",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335425",
								"comment": "kernel-default-base is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258804",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP4 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335425",
								"comment": "kernel-default-base is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335426",
								"comment": "kernel-default-man is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340306",
								"comment": "kernel-devel-azure is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340305",
								"comment": "kernel-source-azure is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258033",
						"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335425",
								"comment": "kernel-default-base is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335426",
								"comment": "kernel-default-man is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009240280",
						"comment": "SUSE Linux Enterprise Server 12 SP4-LTSS is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258650",
								"comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335424",
								"comment": "kernel-default-extra is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338031",
								"comment": "kernel-default-kgraft is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009696923",
								"comment": "kernel-default-kgraft-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009273148",
						"comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728711",
								"comment": "kernel-devel-rt is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728712",
								"comment": "kernel-source-rt is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009279486",
						"comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
					}
				]
			}
		]
	}
}

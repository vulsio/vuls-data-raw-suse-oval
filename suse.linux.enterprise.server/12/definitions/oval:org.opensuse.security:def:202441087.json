{
	"id": "oval:org.opensuse.security:def:202441087",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-41087",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 12 SP5",
				"SUSE Linux Enterprise Real Time 12 SP5",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"SUSE Linux Enterprise Workstation Extension 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-41087",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41087",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-41087",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-41087",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2894-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036430.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2939-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019211.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2947-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036488.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3189-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019404.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3190-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019403.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3194-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036835.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3195-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036842.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3209-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036854.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3225-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036876.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3227-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036874.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3251-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036895.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3252-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036896.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3383-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019497.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3408-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/037033.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3483-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/037089.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3547-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-October/037167.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3565-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-October/019573.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nata: libata-core: Fix double free on error\n\nIf e.g. the ata_port_alloc() call in ata_host_alloc() fails, we will jump\nto the err_out label, which will call devres_release_group().\ndevres_release_group() will trigger a call to ata_host_release().\nata_host_release() calls kfree(host), so executing the kfree(host) in\nata_host_alloc() will lead to a double free:\n\nkernel BUG at mm/slub.c:553!\nOops: invalid opcode: 0000 [#1] PREEMPT SMP NOPTI\nCPU: 11 PID: 599 Comm: (udev-worker) Not tainted 6.10.0-rc5 #47\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-2.fc40 04/01/2014\nRIP: 0010:kfree+0x2cf/0x2f0\nCode: 5d 41 5e 41 5f 5d e9 80 d6 ff ff 4d 89 f1 41 b8 01 00 00 00 48 89 d9 48 89 da\nRSP: 0018:ffffc90000f377f0 EFLAGS: 00010246\nRAX: ffff888112b1f2c0 RBX: ffff888112b1f2c0 RCX: ffff888112b1f320\nRDX: 000000000000400b RSI: ffffffffc02c9de5 RDI: ffff888112b1f2c0\nRBP: ffffc90000f37830 R08: 0000000000000000 R09: 0000000000000000\nR10: ffffc90000f37610 R11: 617461203a736b6e R12: ffffea00044ac780\nR13: ffff888100046400 R14: ffffffffc02c9de5 R15: 0000000000000006\nFS:  00007f2f1cabe980(0000) GS:ffff88813b380000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f2f1c3acf75 CR3: 0000000111724000 CR4: 0000000000750ef0\nPKRU: 55555554\nCall Trace:\n <TASK>\n ? __die_body.cold+0x19/0x27\n ? die+0x2e/0x50\n ? do_trap+0xca/0x110\n ? do_error_trap+0x6a/0x90\n ? kfree+0x2cf/0x2f0\n ? exc_invalid_op+0x50/0x70\n ? kfree+0x2cf/0x2f0\n ? asm_exc_invalid_op+0x1a/0x20\n ? ata_host_alloc+0xf5/0x120 [libata]\n ? ata_host_alloc+0xf5/0x120 [libata]\n ? kfree+0x2cf/0x2f0\n ata_host_alloc+0xf5/0x120 [libata]\n ata_host_alloc_pinfo+0x14/0xa0 [libata]\n ahci_init_one+0x6c9/0xd20 [ahci]\n\nEnsure that we will not call kfree(host) twice, by performing the kfree()\nonly if the devres_open_group() call failed.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-41087 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-41087/",
					"impact": "high",
					"cvss3": "7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-41087 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-41087",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1228466",
					"href": "https://bugzilla.suse.com/1228466"
				},
				{
					"text": "SUSE bug 1228740",
					"href": "https://bugzilla.suse.com/1228740"
				}
			],
			"issued": {
				"date": "2024-09-11"
			},
			"updated": {
				"date": "2024-10-10"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-live-patching:12:sp5",
					"cpe:/o:suse:sle-we:12:sp5",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp5",
					"cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258650",
								"comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009942723",
						"comment": "kernel-default-extra-4.12.14-122.228.1 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942034",
								"comment": "cluster-md-kmp-rt-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942035",
								"comment": "dlm-kmp-rt-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942036",
								"comment": "gfs2-kmp-rt-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942037",
								"comment": "kernel-devel-rt-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942038",
								"comment": "kernel-rt-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942039",
								"comment": "kernel-rt-base-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942040",
								"comment": "kernel-rt-devel-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942041",
								"comment": "kernel-rt_debug-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942042",
								"comment": "kernel-rt_debug-devel-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942043",
								"comment": "kernel-source-rt-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942044",
								"comment": "kernel-syms-rt-4.12.14-10.200.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942045",
								"comment": "ocfs2-kmp-rt-4.12.14-10.200.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009279486",
						"comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942704",
								"comment": "kernel-default-kgraft-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942705",
								"comment": "kernel-default-kgraft-devel-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942706",
								"comment": "kgraft-patch-4_12_14-122_228-default-1-8.3.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009273148",
						"comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942717",
								"comment": "kernel-azure-4.12.14-16.197.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942718",
								"comment": "kernel-azure-base-4.12.14-16.197.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942719",
								"comment": "kernel-azure-devel-4.12.14-16.197.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942709",
								"comment": "kernel-default-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942710",
								"comment": "kernel-default-base-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942711",
								"comment": "kernel-default-devel-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942712",
								"comment": "kernel-default-man-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942713",
								"comment": "kernel-devel-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942720",
								"comment": "kernel-devel-azure-4.12.14-16.197.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942714",
								"comment": "kernel-macros-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942715",
								"comment": "kernel-source-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942721",
								"comment": "kernel-source-azure-4.12.14-16.197.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942716",
								"comment": "kernel-syms-4.12.14-122.228.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942722",
								"comment": "kernel-syms-azure-4.12.14-16.197.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

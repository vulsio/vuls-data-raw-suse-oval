{
	"id": "oval:org.opensuse.security:def:202248838",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2022-48838",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 12 SP5",
				"SUSE Linux Enterprise Real Time 12 SP5",
				"SUSE Linux Enterprise Server 12 SP4-LTSS",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP4",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"SUSE Linux Enterprise Workstation Extension 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2022-48838",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48838",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2022-48838",
				"ref_url": "https://www.suse.com/security/cve/CVE-2022-48838",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2894-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036430.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2902-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036443.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2929-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036473.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2939-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019211.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2947-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036488.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3225-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036876.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3249-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036898.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nusb: gadget: Fix use-after-free bug by not setting udc->dev.driver\n\nThe syzbot fuzzer found a use-after-free bug:\n\nBUG: KASAN: use-after-free in dev_uevent+0x712/0x780 drivers/base/core.c:2320\nRead of size 8 at addr ffff88802b934098 by task udevd/3689\n\nCPU: 2 PID: 3689 Comm: udevd Not tainted 5.17.0-rc4-syzkaller-00229-g4f12b742eb2b #0\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.14.0-2 04/01/2014\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106\n print_address_description.constprop.0.cold+0x8d/0x303 mm/kasan/report.c:255\n __kasan_report mm/kasan/report.c:442 [inline]\n kasan_report.cold+0x83/0xdf mm/kasan/report.c:459\n dev_uevent+0x712/0x780 drivers/base/core.c:2320\n uevent_show+0x1b8/0x380 drivers/base/core.c:2391\n dev_attr_show+0x4b/0x90 drivers/base/core.c:2094\n\nAlthough the bug manifested in the driver core, the real cause was a\nrace with the gadget core.  dev_uevent() does:\n\n\tif (dev->driver)\n\t\tadd_uevent_var(env, \"DRIVER=%s\", dev->driver->name);\n\nand between the test and the dereference of dev->driver, the gadget\ncore sets dev->driver to NULL.\n\nThe race wouldn't occur if the gadget core registered its devices on\na real bus, using the standard synchronization techniques of the\ndriver core.  However, it's not necessary to make such a large change\nin order to fix this bug; all we need to do is make sure that\nudc->dev.driver is always NULL.\n\nIn fact, there is no reason for udc->dev.driver ever to be set to\nanything, let alone to the value it currently gets: the address of the\ngadget's driver.  After all, a gadget driver only knows how to manage\na gadget, not how to manage a UDC.\n\nThis patch simply removes the statements in the gadget core that touch\nudc->dev.driver.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2022-48838 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2022-48838/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2022-48838 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2022-48838",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1227988",
					"href": "https://bugzilla.suse.com/1227988"
				}
			],
			"issued": {
				"date": "2024-07-22"
			},
			"updated": {
				"date": "2024-10-22"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-live-patching:12:sp5",
					"cpe:/o:suse:sle-we:12:sp5",
					"cpe:/o:suse:sles-ltss:12:sp4",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp4",
					"cpe:/o:suse:sles_sap:12:sp5",
					"cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340767",
								"comment": "kernel-source-azure is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258806",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338033",
								"comment": "kernel-default-base is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258804",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP4 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338033",
								"comment": "kernel-default-base is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338036",
								"comment": "kernel-default-man is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340777",
								"comment": "kernel-devel-azure is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340767",
								"comment": "kernel-source-azure is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258033",
						"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338033",
								"comment": "kernel-default-base is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338036",
								"comment": "kernel-default-man is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009240280",
						"comment": "SUSE Linux Enterprise Server 12 SP4-LTSS is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338035",
								"comment": "kernel-default-kgraft is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009809200",
								"comment": "kernel-default-kgraft-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009273148",
						"comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258650",
								"comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009715290",
								"comment": "kernel-default-extra is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728713",
								"comment": "kernel-devel-rt is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728714",
								"comment": "kernel-source-rt is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009279486",
						"comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
					}
				]
			}
		]
	}
}

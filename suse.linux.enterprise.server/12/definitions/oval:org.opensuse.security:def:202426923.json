{
	"id": "oval:org.opensuse.security:def:202426923",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-26923",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-26923",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26923",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-26923",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-26923",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2135-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035681.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2326-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035844.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2335-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035843.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2337-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018881.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2338-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018889.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2341-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018890.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2342-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035861.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2343-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035860.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2344-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018892.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2351-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018891.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2357-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035866.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2358-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035865.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2360-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035874.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2362-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035872.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2365-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035864.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2368-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035867.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2369-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018896.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2372-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035868.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2373-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018895.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2382-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018917.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2394-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035907.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2396-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018923.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2407-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018924.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2410-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018926.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2411-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018925.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2437-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035946.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2446-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035945.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2447-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035944.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2448-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035943.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2449-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018944.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2472-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018943.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2473-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018942.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2474-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018941.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2480-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018967.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2487-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018971.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2488-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018970.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2495-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018982.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2530-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/018985.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\naf_unix: Fix garbage collector racing against connect()\n\nGarbage collector does not take into account the risk of embryo getting\nenqueued during the garbage collection. If such embryo has a peer that\ncarries SCM_RIGHTS, two consecutive passes of scan_children() may see a\ndifferent set of children. Leading to an incorrectly elevated inflight\ncount, and then a dangling pointer within the gc_inflight_list.\n\nsockets are AF_UNIX/SOCK_STREAM\nS is an unconnected socket\nL is a listening in-flight socket bound to addr, not in fdtable\nV's fd will be passed via sendmsg(), gets inflight count bumped\n\nconnect(S, addr)\tsendmsg(S, [V]); close(V)\t__unix_gc()\n----------------\t-------------------------\t-----------\n\nNS = unix_create1()\nskb1 = sock_wmalloc(NS)\nL = unix_find_other(addr)\nunix_state_lock(L)\nunix_peer(S) = NS\n\t\t\t// V count=1 inflight=0\n\n \t\t\tNS = unix_peer(S)\n \t\t\tskb2 = sock_alloc()\n\t\t\tskb_queue_tail(NS, skb2[V])\n\n\t\t\t// V became in-flight\n\t\t\t// V count=2 inflight=1\n\n\t\t\tclose(V)\n\n\t\t\t// V count=1 inflight=1\n\t\t\t// GC candidate condition met\n\n\t\t\t\t\t\tfor u in gc_inflight_list:\n\t\t\t\t\t\t  if (total_refs == inflight_refs)\n\t\t\t\t\t\t    add u to gc_candidates\n\n\t\t\t\t\t\t// gc_candidates={L, V}\n\n\t\t\t\t\t\tfor u in gc_candidates:\n\t\t\t\t\t\t  scan_children(u, dec_inflight)\n\n\t\t\t\t\t\t// embryo (skb1) was not\n\t\t\t\t\t\t// reachable from L yet, so V's\n\t\t\t\t\t\t// inflight remains unchanged\n__skb_queue_tail(L, skb1)\nunix_state_unlock(L)\n\t\t\t\t\t\tfor u in gc_candidates:\n\t\t\t\t\t\t  if (u.inflight)\n\t\t\t\t\t\t    scan_children(u, inc_inflight_move_tail)\n\n\t\t\t\t\t\t// V count=1 inflight=2 (!)\n\nIf there is a GC-candidate listening socket, lock/unlock its state. This\nmakes GC wait until the end of any ongoing connect() to that socket. After\nflipping the lock, a possibly SCM-laden embryo is already enqueued. And if\nthere is another embryo coming, it can not possibly carry SCM_RIGHTS. At\nthis point, unix_inflight() can not happen because unix_gc_lock is already\ntaken. Inflight graph remains unaffected.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-26923 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-26923/",
					"impact": "high",
					"cvss3": "7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-26923 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-26923"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1223384",
					"href": "https://bugzilla.suse.com/1223384"
				},
				{
					"text": "SUSE bug 1223683",
					"href": "https://bugzilla.suse.com/1223683"
				}
			],
			"issued": {
				"date": "2024-07-10"
			},
			"updated": {
				"date": "2024-07-17"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258033",
						"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258806",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009872048",
						"comment": "kernel-azure-4.12.14-16.191.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009872049",
						"comment": "kernel-azure-base-4.12.14-16.191.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009872050",
						"comment": "kernel-azure-devel-4.12.14-16.191.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009872051",
						"comment": "kernel-devel-azure-4.12.14-16.191.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009872052",
						"comment": "kernel-source-azure-4.12.14-16.191.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009872053",
						"comment": "kernel-syms-azure-4.12.14-16.191.1 is installed"
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:201918423",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"Title": "CVE-2019-18423",
		"affected": {
			"family": "unix",
			"Platform": [
				"SUSE Linux Enterprise Server 12 SP1-LTSS",
				"SUSE Linux Enterprise Server 12 SP2-LTSS",
				"SUSE Linux Enterprise Server 12 SP3-BCL",
				"SUSE Linux Enterprise Server 12 SP3-ESPOS",
				"SUSE Linux Enterprise Server 12 SP3-LTSS",
				"SUSE Linux Enterprise Server 12 SP3-TERADATA",
				"SUSE Linux Enterprise Server 12 SP4",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP2",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP3",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP4"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2019-18423",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18423",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2019-18423",
				"ref_url": "https://www.suse.com/security/cve/CVE-2019-18423",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2019:2961-1",
				"ref_url": "https://www.suse.com/support/update/announcement/2019/suse-su-20192961-1.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2019:3297-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2019-December/006253.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2019:3309-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2019-December/006260.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2019:3310-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2019-December/006259.html",
				"source": "SUSE-SU"
			}
		],
		"Description": "\n    An issue was discovered in Xen through 4.12.x allowing ARM guest OS users to cause a denial of service via a XENMEM_add_to_physmap hypercall. p2m->max_mapped_gfn is used by the functions p2m_resolve_translation_fault() and p2m_get_entry() to sanity check guest physical frame. The rest of the code in the two functions will assume that there is a valid root table and check that with BUG_ON(). The function p2m_get_root_pointer() will ignore the unused top bits of a guest physical frame. This means that the function p2m_set_entry() will alias the frame. However, p2m->max_mapped_gfn will be updated using the original frame. It would be possible to set p2m->max_mapped_gfn high enough to cover a frame that would lead p2m_get_root_pointer() to return NULL in p2m_get_entry() and p2m_resolve_translation_fault(). Additionally, the sanity check on p2m->max_mapped_gfn is off-by-one allowing \"highest mapped + 1\" to be considered valid. However, p2m_get_root_pointer() will return NULL. The problem could be triggered with a specially crafted hypercall XENMEM_add_to_physmap{, _batch} followed by an access to an address (via hypercall or direct access) that passes the sanity check but cause p2m_get_root_pointer() to return NULL. A malicious guest administrator may cause a hypervisor crash, resulting in a Denial of Service (DoS). Xen version 4.8 and newer are vulnerable. Only Arm systems are vulnerable. x86 systems are not affected.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"Severity": "Important",
			"cve": {
				"text": "CVE-2019-18423",
				"href": "https://www.suse.com/security/cve/CVE-2019-18423/",
				"impact": "important",
				"cvss3": "8.8/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
			},
			"bugzilla": [
				{
					"text": "SUSE bug 1154460",
					"href": "https://bugzilla.suse.com/1154460"
				}
			],
			"issued": {
				"date": "2021-04-30"
			},
			"updated": {
				"date": "2023-01-14"
			},
			"affected_cpe_list": {
				"Cpe": [
					"cpe:/o:suse:sles-bcl:12:sp3",
					"cpe:/o:suse:sles-espos:12:sp3",
					"cpe:/o:suse:sles-ltss:12:sp1",
					"cpe:/o:suse:sles-ltss:12:sp2",
					"cpe:/o:suse:sles-ltss:12:sp3",
					"cpe:/o:suse:sles:12:sp4",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp2",
					"cpe:/o:suse:sles_sap:12:sp3",
					"cpe:/o:suse:sles_sap:12:sp4",
					"cpe:/o:suse:sles_teradata:12:sp3"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009128018",
								"comment": "SUSE Linux Enterprise Server 12 SP2-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258802",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP2 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333937",
								"comment": "xen is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334821",
								"comment": "xen-doc-html is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334819",
								"comment": "xen-libs is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334820",
								"comment": "xen-libs-32bit is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334822",
								"comment": "xen-tools is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334823",
								"comment": "xen-tools-domU is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333937",
								"comment": "xen is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334821",
								"comment": "xen-doc-html is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335249",
								"comment": "xen-kmp-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334819",
								"comment": "xen-libs is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334820",
								"comment": "xen-libs-32bit is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334822",
								"comment": "xen-tools is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334823",
								"comment": "xen-tools-domU is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009118803",
						"comment": "SUSE Linux Enterprise Server 12 SP1-LTSS is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009513445",
								"comment": "xen-4.12.1_06-1.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009513446",
								"comment": "xen-doc-html-4.12.1_06-1.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009513447",
								"comment": "xen-libs-4.12.1_06-1.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009513448",
								"comment": "xen-libs-32bit-4.12.1_06-1.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009513449",
								"comment": "xen-tools-4.12.1_06-1.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009513450",
								"comment": "xen-tools-domU-4.12.1_06-1.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258033",
						"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009240280",
								"comment": "SUSE Linux Enterprise Server 12 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258804",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP4 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009522429",
								"comment": "xen-4.11.3_02-2.20.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009558316",
								"comment": "xen-doc-html-4.11.3_02-2.20.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009522430",
								"comment": "xen-libs-4.11.3_02-2.20.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009522431",
								"comment": "xen-libs-32bit-4.11.3_02-2.20.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009558317",
								"comment": "xen-tools-4.11.3_02-2.20.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009558318",
								"comment": "xen-tools-domU-4.11.3_02-2.20.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009722236",
								"comment": "SUSE Linux Enterprise Server 12 SP3-BCL is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009132443",
								"comment": "SUSE Linux Enterprise Server 12 SP3-ESPOS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009158922",
								"comment": "SUSE Linux Enterprise Server 12 SP3-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009158922",
								"comment": "SUSE Linux Enterprise Server 12 SP3-TERADATA is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258803",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP3 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009538360",
								"comment": "xen-4.9.4_06-3.59.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009538361",
								"comment": "xen-doc-html-4.9.4_06-3.59.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009538362",
								"comment": "xen-libs-4.9.4_06-3.59.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009538363",
								"comment": "xen-libs-32bit-4.9.4_06-3.59.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009538364",
								"comment": "xen-tools-4.9.4_06-3.59.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009538365",
								"comment": "xen-tools-domU-4.9.4_06-3.59.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

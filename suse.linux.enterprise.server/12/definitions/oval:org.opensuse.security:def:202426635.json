{
	"id": "oval:org.opensuse.security:def:202426635",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-26635",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 12 SP5",
				"SUSE Linux Enterprise Real Time 12 SP5",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"SUSE Linux Enterprise Workstation Extension 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-26635",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26635",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-26635",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-26635",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2493-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/036017.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2561-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-July/019001.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2802-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019133.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2894-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036430.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2896-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019185.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nllc: Drop support for ETH_P_TR_802_2.\n\nsyzbot reported an uninit-value bug below. [0]\n\nllc supports ETH_P_802_2 (0x0004) and used to support ETH_P_TR_802_2\n(0x0011), and syzbot abused the latter to trigger the bug.\n\n  write$tun(r0, &(0x7f0000000040)={@val={0x0, 0x11}, @val, @mpls={[], @llc={@snap={0xaa, 0x1, ')', \"90e5dd\"}}}}, 0x16)\n\nllc_conn_handler() initialises local variables {saddr,daddr}.mac\nbased on skb in llc_pdu_decode_sa()/llc_pdu_decode_da() and passes\nthem to __llc_lookup().\n\nHowever, the initialisation is done only when skb->protocol is\nhtons(ETH_P_802_2), otherwise, __llc_lookup_established() and\n__llc_lookup_listener() will read garbage.\n\nThe missing initialisation existed prior to commit 211ed865108e\n(\"net: delete all instances of special processing for token ring\").\n\nIt removed the part to kick out the token ring stuff but forgot to\nclose the door allowing ETH_P_TR_802_2 packets to sneak into llc_rcv().\n\nLet's remove llc_tr_packet_type and complete the deprecation.\n\n[0]:\nBUG: KMSAN: uninit-value in __llc_lookup_established+0xe9d/0xf90\n __llc_lookup_established+0xe9d/0xf90\n __llc_lookup net/llc/llc_conn.c:611 [inline]\n llc_conn_handler+0x4bd/0x1360 net/llc/llc_conn.c:791\n llc_rcv+0xfbb/0x14a0 net/llc/llc_input.c:206\n __netif_receive_skb_one_core net/core/dev.c:5527 [inline]\n __netif_receive_skb+0x1a6/0x5a0 net/core/dev.c:5641\n netif_receive_skb_internal net/core/dev.c:5727 [inline]\n netif_receive_skb+0x58/0x660 net/core/dev.c:5786\n tun_rx_batched+0x3ee/0x980 drivers/net/tun.c:1555\n tun_get_user+0x53af/0x66d0 drivers/net/tun.c:2002\n tun_chr_write_iter+0x3af/0x5d0 drivers/net/tun.c:2048\n call_write_iter include/linux/fs.h:2020 [inline]\n new_sync_write fs/read_write.c:491 [inline]\n vfs_write+0x8ef/0x1490 fs/read_write.c:584\n ksys_write+0x20f/0x4c0 fs/read_write.c:637\n __do_sys_write fs/read_write.c:649 [inline]\n __se_sys_write fs/read_write.c:646 [inline]\n __x64_sys_write+0x93/0xd0 fs/read_write.c:646\n do_syscall_x64 arch/x86/entry/common.c:51 [inline]\n do_syscall_64+0x44/0x110 arch/x86/entry/common.c:82\n entry_SYSCALL_64_after_hwframe+0x63/0x6b\n\nLocal variable daddr created at:\n llc_conn_handler+0x53/0x1360 net/llc/llc_conn.c:783\n llc_rcv+0xfbb/0x14a0 net/llc/llc_input.c:206\n\nCPU: 1 PID: 5004 Comm: syz-executor994 Not tainted 6.6.0-syzkaller-14500-g1c41041124bd #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/09/2023\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-26635 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-26635/",
					"impact": "medium",
					"cvss3": "6.1/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H"
				},
				{
					"text": "CVE-2024-26635 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-26635"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1221656",
					"href": "https://bugzilla.suse.com/1221656"
				}
			],
			"issued": {
				"date": "2024-07-16"
			},
			"updated": {
				"date": "2024-08-14"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-live-patching:12:sp5",
					"cpe:/o:suse:sle-we:12:sp5",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp5",
					"cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258650",
								"comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009874933",
						"comment": "kernel-default-extra-4.12.14-122.222.1 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873819",
								"comment": "cluster-md-kmp-rt-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873820",
								"comment": "dlm-kmp-rt-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873821",
								"comment": "gfs2-kmp-rt-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873822",
								"comment": "kernel-devel-rt-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873823",
								"comment": "kernel-rt-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873824",
								"comment": "kernel-rt-base-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873825",
								"comment": "kernel-rt-devel-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873826",
								"comment": "kernel-rt_debug-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873827",
								"comment": "kernel-rt_debug-devel-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873828",
								"comment": "kernel-source-rt-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873829",
								"comment": "kernel-syms-rt-4.12.14-10.194.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009873830",
								"comment": "ocfs2-kmp-rt-4.12.14-10.194.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009279486",
						"comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874890",
								"comment": "kernel-default-kgraft-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874891",
								"comment": "kernel-default-kgraft-devel-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874892",
								"comment": "kgraft-patch-4_12_14-122_222-default-1-8.3.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009273148",
						"comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874914",
								"comment": "kernel-default-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874915",
								"comment": "kernel-default-base-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874916",
								"comment": "kernel-default-devel-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874917",
								"comment": "kernel-default-man-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874918",
								"comment": "kernel-devel-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874919",
								"comment": "kernel-macros-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874920",
								"comment": "kernel-source-4.12.14-122.222.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009874921",
								"comment": "kernel-syms-4.12.14-122.222.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

{
  "id": "oval:org.opensuse.security:def:20222977",
  "version": "1",
  "class": "vulnerability",
  "metadata": {
    "Title": "CVE-2022-2977",
    "affected": {
      "family": "unix",
      "Platform": [
        "SUSE Linux Enterprise Live Patching 12 SP4",
        "SUSE Linux Enterprise Live Patching 12 SP5",
        "SUSE Linux Enterprise Real Time 12 SP5",
        "SUSE Linux Enterprise Server 12 SP2-BCL",
        "SUSE Linux Enterprise Server 12 SP3-BCL",
        "SUSE Linux Enterprise Server 12 SP4-ESPOS",
        "SUSE Linux Enterprise Server 12 SP4-LTSS",
        "SUSE Linux Enterprise Server 12 SP5",
        "SUSE Linux Enterprise Server for SAP Applications 12 SP4",
        "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
        "SUSE Linux Enterprise Workstation Extension 12 SP5"
      ]
    },
    "reference": [
      {
        "ref_id": "Mitre CVE-2022-2977",
        "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2977",
        "source": "CVE"
      },
      {
        "ref_id": "SUSE CVE-2022-2977",
        "ref_url": "https://www.suse.com/security/cve/CVE-2022-2977",
        "source": "SUSE CVE"
      },
      {
        "ref_id": "SUSE-CU-2022:2342-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012344.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-IU-2022:1081-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012298.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-IU-2022:1082-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012299.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-IU-2022:1083-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012300.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-IU-2022:1084-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012301.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-IU-2022:1110-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-October/012587.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-IU-2022:1118-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-October/012606.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3264-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012229.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3265-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-updates/2022-September/025152.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3274-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012234.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3282-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012250.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3288-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012270.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3291-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012271.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3293-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012273.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3408-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012386.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3422-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012397.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3450-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012439.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3609-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-October/012557.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:3809-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-October/012771.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2022:4617-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-December/013342.html",
        "source": "SUSE-SU"
      }
    ],
    "Description": "\n    A flaw was found in the Linux kernel implementation of proxied virtualized TPM devices. On a system where virtualized TPM devices are configured (this is not the default) a local attacker can create a use-after-free and create a situation where it may be possible to escalate privileges on the system.\n    ",
    "advisory": {
      "from": "security@suse.de",
      "Severity": "Moderate",
      "cve": {
        "text": "CVE-2022-2977",
        "href": "https://www.suse.com/security/cve/CVE-2022-2977/",
        "impact": "moderate",
        "cvss3": "4.2/CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:N/I:N/A:H"
      },
      "bugzilla": [
        {
          "text": "SUSE bug 1202672",
          "href": "https://bugzilla.suse.com/1202672"
        }
      ],
      "issued": {
        "date": "2022-09-15"
      },
      "updated": {
        "date": "2023-01-26"
      },
      "affected_cpe_list": {
        "Cpe": [
          "cpe:/o:suse:sle-live-patching:12:sp4",
          "cpe:/o:suse:sle-live-patching:12:sp5",
          "cpe:/o:suse:sle-we:12:sp5",
          "cpe:/o:suse:sles-bcl:12:sp2",
          "cpe:/o:suse:sles-bcl:12:sp3",
          "cpe:/o:suse:sles-espos:12:sp4",
          "cpe:/o:suse:sles-ltss:12:sp4",
          "cpe:/o:suse:sles:12:sp5",
          "cpe:/o:suse:sles_sap:12:sp4",
          "cpe:/o:suse:sles_sap:12:sp5",
          "cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
        ]
      }
    }
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009258033",
                "comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009258806",
                "comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009258650",
                "comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:org.opensuse.security:tst:2009710871",
            "comment": "kernel-default-extra-4.12.14-122.133.1 is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009722235",
                "comment": "SUSE Linux Enterprise Server 12 SP2-BCL is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009722236",
                "comment": "SUSE Linux Enterprise Server 12 SP3-BCL is installed"
              }
            ]
          },
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009334017",
                "comment": "kernel-default is not affected"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009335425",
                "comment": "kernel-default-base is not affected"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009335423",
                "comment": "kernel-default-devel is not affected"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009334791",
                "comment": "kernel-devel is not affected"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009334792",
                "comment": "kernel-macros is not affected"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009333928",
                "comment": "kernel-source is not affected"
              }
            ]
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710842",
                "comment": "kernel-default-kgraft-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710843",
                "comment": "kernel-default-kgraft-devel-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710844",
                "comment": "kgraft-patch-4_12_14-122_133-default-1-8.3.1 is installed"
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:org.opensuse.security:tst:2009273148",
            "comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009258033",
                "comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009258806",
                "comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
              }
            ]
          },
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710849",
                "comment": "kernel-azure-4.12.14-16.109.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710850",
                "comment": "kernel-azure-base-4.12.14-16.109.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710851",
                "comment": "kernel-azure-devel-4.12.14-16.109.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710863",
                "comment": "kernel-default-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710864",
                "comment": "kernel-default-base-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710865",
                "comment": "kernel-default-devel-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710866",
                "comment": "kernel-default-man-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710867",
                "comment": "kernel-devel-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710852",
                "comment": "kernel-devel-azure-4.12.14-16.109.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710868",
                "comment": "kernel-macros-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710869",
                "comment": "kernel-source-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710853",
                "comment": "kernel-source-azure-4.12.14-16.109.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710870",
                "comment": "kernel-syms-4.12.14-122.133.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009710854",
                "comment": "kernel-syms-azure-4.12.14-16.109.1 is installed"
              }
            ]
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711084",
                "comment": "kernel-default-kgraft-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711085",
                "comment": "kernel-default-kgraft-devel-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711086",
                "comment": "kgraft-patch-4_12_14-95_108-default-1-6.3.1 is installed"
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:org.opensuse.security:tst:2009241620",
            "comment": "SUSE Linux Enterprise Live Patching 12 SP4 is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711087",
                "comment": "kernel-default-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711088",
                "comment": "kernel-default-base-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711089",
                "comment": "kernel-default-devel-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711090",
                "comment": "kernel-devel-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711091",
                "comment": "kernel-macros-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711092",
                "comment": "kernel-source-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711093",
                "comment": "kernel-syms-4.12.14-95.108.1 is installed"
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:org.opensuse.security:tst:2009258804",
            "comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP4 is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711123",
                "comment": "kernel-default-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711124",
                "comment": "kernel-default-base-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711125",
                "comment": "kernel-default-devel-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711090",
                "comment": "kernel-devel-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711091",
                "comment": "kernel-macros-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711092",
                "comment": "kernel-source-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711126",
                "comment": "kernel-syms-4.12.14-95.108.1 is installed"
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:org.opensuse.security:tst:2009286813",
            "comment": "SUSE Linux Enterprise Server 12 SP4-ESPOS is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711127",
                "comment": "kernel-default-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711128",
                "comment": "kernel-default-base-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711129",
                "comment": "kernel-default-devel-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711130",
                "comment": "kernel-default-man-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711090",
                "comment": "kernel-devel-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711091",
                "comment": "kernel-macros-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711092",
                "comment": "kernel-source-4.12.14-95.108.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009711131",
                "comment": "kernel-syms-4.12.14-95.108.1 is installed"
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:org.opensuse.security:tst:2009240280",
            "comment": "SUSE Linux Enterprise Server 12 SP4-LTSS is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714199",
                "comment": "cluster-md-kmp-rt-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714200",
                "comment": "dlm-kmp-rt-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714201",
                "comment": "gfs2-kmp-rt-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714202",
                "comment": "kernel-devel-rt-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714203",
                "comment": "kernel-rt-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714204",
                "comment": "kernel-rt-base-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714205",
                "comment": "kernel-rt-devel-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714206",
                "comment": "kernel-rt_debug-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714207",
                "comment": "kernel-rt_debug-devel-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714208",
                "comment": "kernel-source-rt-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714209",
                "comment": "kernel-syms-rt-4.12.14-10.100.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009714210",
                "comment": "ocfs2-kmp-rt-4.12.14-10.100.1 is installed"
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:org.opensuse.security:tst:2009279486",
            "comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
          }
        ]
      }
    ]
  }
}

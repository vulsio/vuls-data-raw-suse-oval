{
	"id": "oval:org.opensuse.security:def:202426671",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-26671",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 12 SP5",
				"SUSE Linux Enterprise Real Time 12 SP5",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"SUSE Linux Enterprise Workstation Extension 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-26671",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26671",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-26671",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-26671",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:1643-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035264.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1644-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035263.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1646-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035261.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1648-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035259.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1659-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035281.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nblk-mq: fix IO hang from sbitmap wakeup race\n\nIn blk_mq_mark_tag_wait(), __add_wait_queue() may be re-ordered\nwith the following blk_mq_get_driver_tag() in case of getting driver\ntag failure.\n\nThen in __sbitmap_queue_wake_up(), waitqueue_active() may not observe\nthe added waiter in blk_mq_mark_tag_wait() and wake up nothing, meantime\nblk_mq_mark_tag_wait() can't get driver tag successfully.\n\nThis issue can be reproduced by running the following test in loop, and\nfio hang can be observed in < 30min when running it on my test VM\nin laptop.\n\n\tmodprobe -r scsi_debug\n\tmodprobe scsi_debug delay=0 dev_size_mb=4096 max_queue=1 host_max_queue=1 submit_queues=4\n\tdev=`ls -d /sys/bus/pseudo/drivers/scsi_debug/adapter*/host*/target*/*/block/* | head -1 | xargs basename`\n\tfio --filename=/dev/\"$dev\" --direct=1 --rw=randrw --bs=4k --iodepth=1 \\\n       \t\t--runtime=100 --numjobs=40 --time_based --name=test \\\n        \t--ioengine=libaio\n\nFix the issue by adding one explicit barrier in blk_mq_mark_tag_wait(), which\nis just fine in case of running out of tag.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-26671 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-26671/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-26671 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-26671"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1222357",
					"href": "https://bugzilla.suse.com/1222357"
				}
			],
			"issued": {
				"date": "2024-05-15"
			},
			"updated": {
				"date": "2024-05-16"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-live-patching:12:sp5",
					"cpe:/o:suse:sle-we:12:sp5",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp5",
					"cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258650",
								"comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009861004",
						"comment": "kernel-default-extra-4.12.14-122.212.1 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860964",
								"comment": "kernel-default-kgraft-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860965",
								"comment": "kernel-default-kgraft-devel-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860966",
								"comment": "kgraft-patch-4_12_14-122_212-default-1-8.11.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009273148",
						"comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860967",
								"comment": "cluster-md-kmp-rt-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860968",
								"comment": "dlm-kmp-rt-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860969",
								"comment": "gfs2-kmp-rt-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860970",
								"comment": "kernel-devel-rt-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860971",
								"comment": "kernel-rt-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860972",
								"comment": "kernel-rt-base-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860973",
								"comment": "kernel-rt-devel-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860974",
								"comment": "kernel-rt_debug-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860975",
								"comment": "kernel-rt_debug-devel-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860976",
								"comment": "kernel-source-rt-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860977",
								"comment": "kernel-syms-rt-4.12.14-10.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860978",
								"comment": "ocfs2-kmp-rt-4.12.14-10.182.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009279486",
						"comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860989",
								"comment": "kernel-azure-4.12.14-16.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860990",
								"comment": "kernel-azure-base-4.12.14-16.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860991",
								"comment": "kernel-azure-devel-4.12.14-16.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860995",
								"comment": "kernel-default-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860996",
								"comment": "kernel-default-base-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860997",
								"comment": "kernel-default-devel-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860998",
								"comment": "kernel-default-man-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860999",
								"comment": "kernel-devel-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860992",
								"comment": "kernel-devel-azure-4.12.14-16.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861000",
								"comment": "kernel-macros-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861001",
								"comment": "kernel-source-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860993",
								"comment": "kernel-source-azure-4.12.14-16.182.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861002",
								"comment": "kernel-syms-4.12.14-122.212.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009860994",
								"comment": "kernel-syms-azure-4.12.14-16.182.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

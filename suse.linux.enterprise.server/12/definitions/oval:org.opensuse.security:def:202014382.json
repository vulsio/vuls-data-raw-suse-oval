{
	"id": "oval:org.opensuse.security:def:202014382",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"Title": "CVE-2020-14382",
		"affected": {
			"family": "unix",
			"Platform": [
				"SUSE Linux Enterprise Server 12 SP2-BCL",
				"SUSE Linux Enterprise Server 12 SP2-LTSS",
				"SUSE Linux Enterprise Server 12 SP3-BCL",
				"SUSE Linux Enterprise Server 12 SP3-LTSS",
				"SUSE Linux Enterprise Server 12 SP4-LTSS",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP2",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP3",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP4",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2020-14382",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14382",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2020-14382",
				"ref_url": "https://www.suse.com/security/cve/CVE-2020-14382",
				"source": "SUSE CVE"
			}
		],
		"Description": "\n    A vulnerability was found in upstream release cryptsetup-2.2.0 where, there's a bug in LUKS2 format validation code, that is effectively invoked on every device/image presenting itself as LUKS2 container. The bug is in segments validation code in file 'lib/luks2/luks2_json_metadata.c' in function hdr_validate_segments(struct crypt_device *cd, json_object *hdr_jobj) where the code does not check for possible overflow on memory allocation used for intervals array (see statement \"intervals = malloc(first_backup * sizeof(*intervals));\"). Due to the bug, library can be *tricked* to expect such allocation was successful but for far less memory then originally expected. Later it may read data FROM image crafted by an attacker and actually write such data BEYOND allocated memory.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"Severity": "Moderate",
			"cve": {
				"text": "CVE-2020-14382 at NVD",
				"href": "https://nvd.nist.gov/vuln/detail/CVE-2020-14382",
				"impact": "moderate",
				"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
			},
			"bugzilla": [
				{
					"text": "SUSE bug 1176128",
					"href": "https://bugzilla.suse.com/1176128"
				}
			],
			"issued": {
				"date": "2021-11-24"
			},
			"updated": {
				"date": "2024-04-18"
			},
			"affected_cpe_list": {
				"Cpe": [
					"cpe:/o:suse:sles-bcl:12:sp2",
					"cpe:/o:suse:sles-bcl:12:sp3",
					"cpe:/o:suse:sles-ltss:12:sp2",
					"cpe:/o:suse:sles-ltss:12:sp3",
					"cpe:/o:suse:sles-ltss:12:sp4",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12:sp2",
					"cpe:/o:suse:sles_sap:12:sp3",
					"cpe:/o:suse:sles_sap:12:sp4",
					"cpe:/o:suse:sles_sap:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258806",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009339165",
						"comment": "cryptsetup is not affected"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339165",
								"comment": "cryptsetup is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339166",
								"comment": "libcryptsetup12 is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339167",
								"comment": "libcryptsetup12-32bit is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339168",
								"comment": "libcryptsetup12-hmac is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339169",
								"comment": "libcryptsetup12-hmac-32bit is not affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258033",
						"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009722235",
								"comment": "SUSE Linux Enterprise Server 12 SP2-BCL is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009128018",
								"comment": "SUSE Linux Enterprise Server 12 SP2-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009722236",
								"comment": "SUSE Linux Enterprise Server 12 SP3-BCL is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009158922",
								"comment": "SUSE Linux Enterprise Server 12 SP3-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009240280",
								"comment": "SUSE Linux Enterprise Server 12 SP4-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258802",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258803",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258804",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP4 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339165",
								"comment": "cryptsetup is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339170",
								"comment": "libcryptsetup4 is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339171",
								"comment": "libcryptsetup4-32bit is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339172",
								"comment": "libcryptsetup4-hmac is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339173",
								"comment": "libcryptsetup4-hmac-32bit is not affected"
							}
						]
					}
				]
			}
		]
	}
}

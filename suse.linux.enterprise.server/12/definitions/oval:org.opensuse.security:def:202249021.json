{
	"id": "oval:org.opensuse.security:def:202249021",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2022-49021",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 12",
				"SUSE Linux Enterprise Live Patching 12 SP5",
				"SUSE Linux Enterprise Module for Public Cloud 12",
				"SUSE Linux Enterprise Real Time 12 SP5",
				"SUSE Linux Enterprise Server 12",
				"SUSE Linux Enterprise Server 12 SP2-LTSS",
				"SUSE Linux Enterprise Server 12 SP3",
				"SUSE Linux Enterprise Server 12 SP3-TERADATA",
				"SUSE Linux Enterprise Server 12 SP4",
				"SUSE Linux Enterprise Server 12 SP4-LTSS",
				"SUSE Linux Enterprise Server 12 SP5",
				"SUSE Linux Enterprise Server 12 SP5-LTSS",
				"SUSE Linux Enterprise Server LTSS Extended Security 12 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 12",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP3",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP4",
				"SUSE Linux Enterprise Server for SAP Applications 12 SP5",
				"SUSE Linux Enterprise Workstation Extension 12 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2022-49021",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-49021",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2022-49021",
				"ref_url": "https://www.suse.com/security/cve/CVE-2022-49021",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3983-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019816.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3985-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019814.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4082-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019851.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4100-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019864.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnet: phy: fix null-ptr-deref while probe() failed\n\nI got a null-ptr-deref report as following when doing fault injection test:\n\nBUG: kernel NULL pointer dereference, address: 0000000000000058\nOops: 0000 [#1] PREEMPT SMP KASAN PTI\nCPU: 1 PID: 253 Comm: 507-spi-dm9051 Tainted: G    B            N 6.1.0-rc3+\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014\nRIP: 0010:klist_put+0x2d/0xd0\nCall Trace:\n <TASK>\n klist_remove+0xf1/0x1c0\n device_release_driver_internal+0x23e/0x2d0\n bus_remove_device+0x1bd/0x240\n device_del+0x357/0x770\n phy_device_remove+0x11/0x30\n mdiobus_unregister+0xa5/0x140\n release_nodes+0x6a/0xa0\n devres_release_all+0xf8/0x150\n device_unbind_cleanup+0x19/0xd0\n\n//probe path:\nphy_device_register()\n  device_add()\n\nphy_connect\n  phy_attach_direct() //set device driver\n    probe() //it's failed, driver is not bound\n    device_bind_driver() // probe failed, it's not called\n\n//remove path:\nphy_device_remove()\n  device_del()\n    device_release_driver_internal()\n      __device_release_driver() //dev->drv is not NULL\n        klist_remove() <- knode_driver is not added yet, cause null-ptr-deref\n\nIn phy_attach_direct(), after setting the 'dev->driver', probe() fails,\ndevice_bind_driver() is not called, so the knode_driver->n_klist is not\nset, then it causes null-ptr-deref in __device_release_driver() while\ndeleting device. Fix this by setting dev->driver to NULL in the error\npath in phy_attach_direct().\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2022-49021 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2022-49021/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2022-49021 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2022-49021",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1231939",
					"href": "https://bugzilla.suse.com/1231939"
				}
			],
			"issued": {
				"date": "2024-10-23"
			},
			"updated": {
				"date": "2024-11-29"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-live-patching:12:sp5",
					"cpe:/o:suse:sle-module-public-cloud:12",
					"cpe:/o:suse:sle-we:12:sp5",
					"cpe:/o:suse:sle_hpc:12",
					"cpe:/o:suse:sles-ltss-extended-security:12:sp5",
					"cpe:/o:suse:sles-ltss:12:sp2",
					"cpe:/o:suse:sles-ltss:12:sp4",
					"cpe:/o:suse:sles:12",
					"cpe:/o:suse:sles:12:sp3",
					"cpe:/o:suse:sles:12:sp4",
					"cpe:/o:suse:sles:12:sp5",
					"cpe:/o:suse:sles_sap:12",
					"cpe:/o:suse:sles_sap:12:sp3",
					"cpe:/o:suse:sles_sap:12:sp4",
					"cpe:/o:suse:sles_sap:12:sp5",
					"cpe:/o:suse:sles_teradata:12:sp3",
					"cpe:/o:suse:suse-linux-enterprise-rt:12:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340767",
								"comment": "kernel-source-azure is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258806",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009703659",
								"comment": "SUSE Linux Enterprise High Performance Computing 12 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009178199",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 12 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009116126",
								"comment": "SUSE Linux Enterprise Server 12 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009158922",
								"comment": "SUSE Linux Enterprise Server 12 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009240280",
								"comment": "SUSE Linux Enterprise Server 12 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258800",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258803",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258804",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338033",
								"comment": "kernel-default-base is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338036",
								"comment": "kernel-default-man is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340777",
								"comment": "kernel-devel-azure is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340767",
								"comment": "kernel-source-azure is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258033",
						"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009128018",
								"comment": "SUSE Linux Enterprise Server 12 SP2-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009240280",
								"comment": "SUSE Linux Enterprise Server 12 SP4-LTSS is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338033",
								"comment": "kernel-default-base is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338036",
								"comment": "kernel-default-man is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258033",
								"comment": "SUSE Linux Enterprise Server 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258806",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 12 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009258650",
								"comment": "SUSE Linux Enterprise Workstation Extension 12 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009715290",
								"comment": "kernel-default-extra is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728713",
								"comment": "kernel-devel-rt is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728714",
								"comment": "kernel-source-rt is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009279486",
						"comment": "SUSE Linux Enterprise Real Time 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955203",
								"comment": "kernel-default-4.4.140-96.152.TDC.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955204",
								"comment": "kernel-default-base-4.4.140-96.152.TDC.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955205",
								"comment": "kernel-default-devel-4.4.140-96.152.TDC.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955206",
								"comment": "kernel-devel-4.4.140-96.152.TDC.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955207",
								"comment": "kernel-macros-4.4.140-96.152.TDC.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955208",
								"comment": "kernel-source-4.4.140-96.152.TDC.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955209",
								"comment": "kernel-syms-4.4.140-96.152.TDC.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009876317",
						"comment": "SUSE Linux Enterprise Server 12 SP3-TERADATA is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955428",
								"comment": "kernel-default-kgraft-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955429",
								"comment": "kernel-default-kgraft-devel-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955430",
								"comment": "kgraft-patch-4_12_14-122_234-default-1-8.3.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009273148",
						"comment": "SUSE Linux Enterprise Live Patching 12 SP5 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955452",
								"comment": "kernel-default-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955453",
								"comment": "kernel-default-base-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955454",
								"comment": "kernel-default-devel-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955455",
								"comment": "kernel-default-man-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955456",
								"comment": "kernel-devel-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955457",
								"comment": "kernel-macros-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955458",
								"comment": "kernel-source-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955459",
								"comment": "kernel-syms-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340777",
								"comment": "kernel-devel-azure is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340767",
								"comment": "kernel-source-azure is affected"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009258033",
						"comment": "SUSE Linux Enterprise Server 12 SP5-LTSS is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955478",
								"comment": "kernel-default-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955479",
								"comment": "kernel-default-base-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955480",
								"comment": "kernel-default-devel-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955456",
								"comment": "kernel-devel-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955457",
								"comment": "kernel-macros-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955458",
								"comment": "kernel-source-4.12.14-122.234.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009955481",
								"comment": "kernel-syms-4.12.14-122.234.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009952096",
						"comment": "SUSE Linux Enterprise Server LTSS Extended Security 12 SP5 is installed"
					}
				]
			}
		]
	}
}

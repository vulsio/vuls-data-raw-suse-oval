{
	"id": "oval:org.opensuse.security:def:202435960",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-35960",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP6",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP6",
				"SUSE Linux Enterprise Server 15 SP6",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-35960",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35960",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-35960",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-35960",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2135-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035681.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: Properly link new fs rules into the tree\n\nPreviously, add_rule_fg would only add newly created rules from the\nhandle into the tree when they had a refcount of 1. On the other hand,\ncreate_flow_handle tries hard to find and reference already existing\nidentical rules instead of creating new ones.\n\nThese two behaviors can result in a situation where create_flow_handle\n1) creates a new rule and references it, then\n2) in a subsequent step during the same handle creation references it\n   again,\nresulting in a rule with a refcount of 2 that is not linked into the\ntree, will have a NULL parent and root and will result in a crash when\nthe flow group is deleted because del_sw_hw_rule, invoked on rule\ndeletion, assumes node->parent is != NULL.\n\nThis happened in the wild, due to another bug related to incorrect\nhandling of duplicate pkt_reformat ids, which lead to the code in\ncreate_flow_handle incorrectly referencing a just-added rule in the same\nflow handle, resulting in the problem described above. Full details are\nat [1].\n\nThis patch changes add_rule_fg to add new rules without parents into\nthe tree, properly initializing them and avoiding the crash. This makes\nit more consistent with how rules are added to an FTE in\ncreate_flow_handle.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-35960 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-35960/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-35960 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-35960"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1224588",
					"href": "https://bugzilla.suse.com/1224588"
				}
			],
			"issued": {
				"date": "2024-06-22"
			},
			"updated": {
				"date": "2024-06-22"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-public-cloud:15:sp6"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009856172",
						"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009856320",
						"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP6 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009856174",
						"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009856175",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
					}
				]
			},
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009868541",
						"comment": "kernel-azure-6.4.0-150600.8.5.4 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009868542",
						"comment": "kernel-azure-devel-6.4.0-150600.8.5.4 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009868547",
						"comment": "kernel-devel-azure-6.4.0-150600.8.5.4 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009868548",
						"comment": "kernel-source-azure-6.4.0-150600.8.5.4 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009868549",
						"comment": "kernel-syms-azure-6.4.0-150600.8.5.1 is installed"
					}
				]
			}
		]
	}
}

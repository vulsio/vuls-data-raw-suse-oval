{
	"id": "oval:org.opensuse.security:def:202426689",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-26689",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-26689",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26689",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-26689",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-26689",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:1490-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035140.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nceph: prevent use-after-free in encode_cap_msg()\n\nIn fs/ceph/caps.c, in encode_cap_msg(), \"use after free\" error was\ncaught by KASAN at this line - 'ceph_buffer_get(arg->xattr_buf);'. This\nimplies before the refcount could be increment here, it was freed.\n\nIn same file, in \"handle_cap_grant()\" refcount is decremented by this\nline - 'ceph_buffer_put(ci->i_xattrs.blob);'. It appears that a race\noccurred and resource was freed by the latter line before the former\nline could increment it.\n\nencode_cap_msg() is called by __send_cap() and __send_cap() is called by\nceph_check_caps() after calling __prep_cap(). __prep_cap() is where\narg->xattr_buf is assigned to ci->i_xattrs.blob. This is the spot where\nthe refcount must be increased to prevent \"use after free\" error.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-26689 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-26689/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-26689 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-26689"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1222503",
					"href": "https://bugzilla.suse.com/1222503"
				}
			],
			"issued": {
				"date": "2024-05-04"
			},
			"updated": {
				"date": "2024-05-04"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-public-cloud:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759899",
						"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009762868",
						"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759901",
						"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759902",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
					}
				]
			},
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009858785",
						"comment": "kernel-azure-5.14.21-150500.33.48.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009858786",
						"comment": "kernel-azure-devel-5.14.21-150500.33.48.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009858791",
						"comment": "kernel-devel-azure-5.14.21-150500.33.48.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009858792",
						"comment": "kernel-source-azure-5.14.21-150500.33.48.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009858793",
						"comment": "kernel-syms-azure-5.14.21-150500.33.48.1 is installed"
					}
				]
			}
		]
	}
}

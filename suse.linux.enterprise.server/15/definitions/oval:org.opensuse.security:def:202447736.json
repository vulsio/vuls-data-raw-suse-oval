{
	"id": "oval:org.opensuse.security:def:202447736",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-47736",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 15 SP2",
				"SUSE Linux Enterprise Live Patching 15 SP3",
				"SUSE Linux Enterprise Server 15 SP1-LTSS",
				"SUSE Linux Enterprise Server 15 SP2-LTSS",
				"SUSE Linux Enterprise Server 15 SP3-LTSS",
				"SUSE Linux Enterprise Server 15-LTSS",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP2",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP3"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-47736",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47736",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-47736",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-47736",
				"source": "SUSE CVE"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: handle overlapped pclusters out of crafted images properly\n\nsyzbot reported a task hang issue due to a deadlock case where it is\nwaiting for the folio lock of a cached folio that will be used for\ncache I/Os.\n\nAfter looking into the crafted fuzzed image, I found it's formed with\nseveral overlapped big pclusters as below:\n\n Ext:   logical offset   |  length :     physical offset    |  length\n   0:        0..   16384 |   16384 :     151552..    167936 |   16384\n   1:    16384..   32768 |   16384 :     155648..    172032 |   16384\n   2:    32768..   49152 |   16384 :  537223168.. 537239552 |   16384\n...\n\nHere, extent 0/1 are physically overlapped although it's entirely\n_impossible_ for normal filesystem images generated by mkfs.\n\nFirst, managed folios containing compressed data will be marked as\nup-to-date and then unlocked immediately (unlike in-place folios) when\ncompressed I/Os are complete.  If physical blocks are not submitted in\nthe incremental order, there should be separate BIOs to avoid dependency\nissues.  However, the current code mis-arranges z_erofs_fill_bio_vec()\nand BIO submission which causes unexpected BIO waits.\n\nSecond, managed folios will be connected to their own pclusters for\nefficient inter-queries.  However, this is somewhat hard to implement\neasily if overlapped big pclusters exist.  Again, these only appear in\nfuzzed images so let's simply fall back to temporary short-lived pages\nfor correctness.\n\nAdditionally, it justifies that referenced managed folios cannot be\ntruncated for now and reverts part of commit 2080ca1ed3e4 (\"erofs: tidy\nup `struct z_erofs_bvec`\") for simplicity although it shouldn't be any\ndifference.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-47736 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-47736/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-47736 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-47736",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1232112",
					"href": "https://bugzilla.suse.com/1232112"
				}
			],
			"issued": {
				"date": "2024-10-27"
			},
			"updated": {
				"date": "2024-10-27"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-live-patching:15:sp2",
					"cpe:/o:suse:sle-module-live-patching:15:sp3",
					"cpe:/o:suse:sles-ltss:15",
					"cpe:/o:suse:sles-ltss:15:sp1",
					"cpe:/o:suse:sles-ltss:15:sp2",
					"cpe:/o:suse:sles-ltss:15:sp3",
					"cpe:/o:suse:sles_sap:15:sp2",
					"cpe:/o:suse:sles_sap:15:sp3"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009660213",
								"comment": "SUSE Linux Enterprise Server 15 SP2-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009729178",
								"comment": "SUSE Linux Enterprise Server 15 SP3-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009659637",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669878",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338037",
								"comment": "reiserfs-kmp-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009341508",
								"comment": "SUSE Linux Enterprise Server 15 SP1-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302033",
								"comment": "SUSE Linux Enterprise Server 15-LTSS is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335425",
								"comment": "kernel-default-base is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335426",
								"comment": "kernel-default-man is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338037",
								"comment": "reiserfs-kmp-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009288462",
								"comment": "SUSE Linux Enterprise Live Patching 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009478738",
								"comment": "SUSE Linux Enterprise Live Patching 15 SP3 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728675",
								"comment": "kernel-default-livepatch is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009728676",
								"comment": "kernel-default-livepatch-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:202436971",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-36971",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-36971",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36971",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-36971",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-36971",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2372-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035868.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnet: fix __dst_negative_advice() race\n\n__dst_negative_advice() does not enforce proper RCU rules when\nsk->dst_cache must be cleared, leading to possible UAF.\n\nRCU rules are that we must first clear sk->sk_dst_cache,\nthen call dst_release(old_dst).\n\nNote that sk_dst_reset(sk) is implementing this protocol correctly,\nwhile __dst_negative_advice() uses the wrong order.\n\nGiven that ip6_negative_advice() has special logic\nagainst RTF_CACHE, this means each of the three ->negative_advice()\nexisting methods must perform the sk_dst_reset() themselves.\n\nNote the check against NULL dst is centralized in\n__dst_negative_advice(), there is no need to duplicate\nit in various callbacks.\n\nMany thanks to Clement Lecigne for tracking this issue.\n\nThis old bug became visible after the blamed commit, using UDP sockets.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-36971 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-36971/",
					"impact": "high",
					"cvss3": "7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-36971 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-36971",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1226145",
					"href": "https://bugzilla.suse.com/1226145"
				},
				{
					"text": "SUSE bug 1226324",
					"href": "https://bugzilla.suse.com/1226324"
				}
			],
			"issued": {
				"date": "2024-07-10"
			},
			"updated": {
				"date": "2024-07-10"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-public-cloud:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759899",
						"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009762868",
						"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759901",
						"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759902",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
					}
				]
			},
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871894",
						"comment": "kernel-azure-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871895",
						"comment": "kernel-azure-devel-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871900",
						"comment": "kernel-devel-azure-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871901",
						"comment": "kernel-source-azure-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871902",
						"comment": "kernel-syms-azure-5.14.21-150500.33.60.1 is installed"
					}
				]
			}
		]
	}
}

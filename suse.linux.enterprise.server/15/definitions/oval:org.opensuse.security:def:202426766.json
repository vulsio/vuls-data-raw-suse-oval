{
	"id": "oval:org.opensuse.security:def:202426766",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"Title": "CVE-2024-26766",
		"affected": {
			"family": "unix",
			"Platform": [
				"SUSE Enterprise Storage 7",
				"SUSE Enterprise Storage 7.1",
				"SUSE Linux Enterprise High Performance Computing 15 SP2",
				"SUSE Linux Enterprise High Performance Computing 15 SP3",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP2",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP3",
				"SUSE Linux Enterprise Server 15 SP1-LTSS",
				"SUSE Linux Enterprise Server 15 SP2",
				"SUSE Linux Enterprise Server 15 SP2-LTSS",
				"SUSE Linux Enterprise Server 15 SP3",
				"SUSE Linux Enterprise Server 15 SP3-LTSS",
				"SUSE Linux Enterprise Server 15-LTSS",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP2",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP3",
				"SUSE Manager Proxy 4.1",
				"SUSE Manager Proxy 4.2",
				"SUSE Manager Retail Branch Server 4.1",
				"SUSE Manager Retail Branch Server 4.2",
				"SUSE Manager Server 4.1",
				"SUSE Manager Server 4.2"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-26766",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26766",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-26766",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-26766",
				"source": "SUSE CVE"
			}
		],
		"Description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nIB/hfi1: Fix sdma.h tx->num_descs off-by-one error\n\nUnfortunately the commit `fd8958efe877` introduced another error\ncausing the `descs` array to overflow. This reults in further crashes\neasily reproducible by `sendmsg` system call.\n\n[ 1080.836473] general protection fault, probably for non-canonical address 0x400300015528b00a: 0000 [#1] PREEMPT SMP PTI\n[ 1080.869326] RIP: 0010:hfi1_ipoib_build_ib_tx_headers.constprop.0+0xe1/0x2b0 [hfi1]\n--\n[ 1080.974535] Call Trace:\n[ 1080.976990]  <TASK>\n[ 1081.021929]  hfi1_ipoib_send_dma_common+0x7a/0x2e0 [hfi1]\n[ 1081.027364]  hfi1_ipoib_send_dma_list+0x62/0x270 [hfi1]\n[ 1081.032633]  hfi1_ipoib_send+0x112/0x300 [hfi1]\n[ 1081.042001]  ipoib_start_xmit+0x2a9/0x2d0 [ib_ipoib]\n[ 1081.046978]  dev_hard_start_xmit+0xc4/0x210\n--\n[ 1081.148347]  __sys_sendmsg+0x59/0xa0\n\ncrash> ipoib_txreq 0xffff9cfeba229f00\nstruct ipoib_txreq {\n  txreq = {\n    list = {\n      next = 0xffff9cfeba229f00,\n      prev = 0xffff9cfeba229f00\n    },\n    descp = 0xffff9cfeba229f40,\n    coalesce_buf = 0x0,\n    wait = 0xffff9cfea4e69a48,\n    complete = 0xffffffffc0fe0760 <hfi1_ipoib_sdma_complete>,\n    packet_len = 0x46d,\n    tlen = 0x0,\n    num_desc = 0x0,\n    desc_limit = 0x6,\n    next_descq_idx = 0x45c,\n    coalesce_idx = 0x0,\n    flags = 0x0,\n    descs = {{\n        qw = {0x8024000120dffb00, 0x4}  # SDMA_DESC0_FIRST_DESC_FLAG (bit 63)\n      }, {\n        qw = {  0x3800014231b108, 0x4}\n      }, {\n        qw = { 0x310000e4ee0fcf0, 0x8}\n      }, {\n        qw = {  0x3000012e9f8000, 0x8}\n      }, {\n        qw = {  0x59000dfb9d0000, 0x8}\n      }, {\n        qw = {  0x78000e02e40000, 0x8}\n      }}\n  },\n  sdma_hdr =  0x400300015528b000,  <<< invalid pointer in the tx request structure\n  sdma_status = 0x0,                   SDMA_DESC0_LAST_DESC_FLAG (bit 62)\n  complete = 0x0,\n  priv = 0x0,\n  txq = 0xffff9cfea4e69880,\n  skb = 0xffff9d099809f400\n}\n\nIf an SDMA send consists of exactly 6 descriptors and requires dword\npadding (in the 7th descriptor), the sdma_txreq descriptor array is not\nproperly expanded and the packet will overflow into the container\nstructure. This results in a panic when the send completion runs. The\nexact panic varies depending on what elements of the container structure\nget corrupted. The fix is to use the correct expression in\n_pad_sdma_tx_descs() to test the need to expand the descriptor array.\n\nWith this patch the crashes are no longer reproducible and the machine is\nstable.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"Severity": "Important",
			"cve": {
				"text": "CVE-2024-26766",
				"href": "https://www.suse.com/security/cve/CVE-2024-26766/",
				"impact": "important",
				"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
			},
			"bugzilla": [
				{
					"text": "SUSE bug 1222726",
					"href": "https://bugzilla.suse.com/1222726"
				},
				{
					"text": "SUSE bug 1222882",
					"href": "https://bugzilla.suse.com/1222882"
				}
			],
			"issued": {
				"date": "2024-04-13"
			},
			"updated": {
				"date": "2024-04-17"
			},
			"affected_cpe_list": {
				"Cpe": [
					"cpe:/o:suse:ses:7",
					"cpe:/o:suse:ses:7.1",
					"cpe:/o:suse:sle-module-public-cloud:15:sp2",
					"cpe:/o:suse:sle-module-public-cloud:15:sp3",
					"cpe:/o:suse:sle_hpc:15:sp2",
					"cpe:/o:suse:sle_hpc:15:sp3",
					"cpe:/o:suse:sles-ltss:15",
					"cpe:/o:suse:sles-ltss:15:sp1",
					"cpe:/o:suse:sles-ltss:15:sp2",
					"cpe:/o:suse:sles-ltss:15:sp3",
					"cpe:/o:suse:sles:15:sp2",
					"cpe:/o:suse:sles:15:sp3",
					"cpe:/o:suse:sles_sap:15:sp2",
					"cpe:/o:suse:sles_sap:15:sp3",
					"cpe:/o:suse:suse-manager-proxy:4.1",
					"cpe:/o:suse:suse-manager-proxy:4.2",
					"cpe:/o:suse:suse-manager-retail-branch-server:4.1",
					"cpe:/o:suse:suse-manager-retail-branch-server:4.2",
					"cpe:/o:suse:suse-manager-server:4.1",
					"cpe:/o:suse:suse-manager-server:4.2"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009660213",
								"comment": "SUSE Linux Enterprise Server 15 SP2-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009729178",
								"comment": "SUSE Linux Enterprise Server 15 SP3-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009659637",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669878",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338037",
								"comment": "reiserfs-kmp-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009341508",
								"comment": "SUSE Linux Enterprise Server 15 SP1-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302033",
								"comment": "SUSE Linux Enterprise Server 15-LTSS is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335425",
								"comment": "kernel-default-base is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335426",
								"comment": "kernel-default-man is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338037",
								"comment": "reiserfs-kmp-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302786",
								"comment": "SUSE Enterprise Storage 7 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009681000",
								"comment": "SUSE Enterprise Storage 7.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009479728",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669877",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009287160",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009351817",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009303870",
								"comment": "SUSE Linux Enterprise Server 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009476340",
								"comment": "SUSE Linux Enterprise Server 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009659637",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669878",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302537",
								"comment": "SUSE Manager Proxy 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669879",
								"comment": "SUSE Manager Proxy 4.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009346072",
								"comment": "SUSE Manager Retail Branch Server 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009677266",
								"comment": "SUSE Manager Retail Branch Server 4.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302605",
								"comment": "SUSE Manager Server 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669880",
								"comment": "SUSE Manager Server 4.2 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340306",
								"comment": "kernel-devel-azure is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009340305",
								"comment": "kernel-source-azure is not affected"
							}
						]
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:202352559",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"Title": "CVE-2023-52559",
		"affected": {
			"family": "unix",
			"Platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Live Patching 15 SP4",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP5",
				"SUSE Linux Enterprise Server 15 SP1-LTSS",
				"SUSE Linux Enterprise Server 15 SP2-LTSS",
				"SUSE Linux Enterprise Server 15 SP3-LTSS",
				"SUSE Linux Enterprise Server 15 SP4-LTSS",
				"SUSE Linux Enterprise Server 15 SP4-TERADATA",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server 15-LTSS",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP2",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP3",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP4",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2023-52559",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52559",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2023-52559",
				"ref_url": "https://www.suse.com/security/cve/CVE-2023-52559",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:0855-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018151.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0900-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018167.html",
				"source": "SUSE-SU"
			}
		],
		"Description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\niommu/vt-d: Avoid memory allocation in iommu_suspend()\n\nThe iommu_suspend() syscore suspend callback is invoked with IRQ disabled.\nAllocating memory with the GFP_KERNEL flag may re-enable IRQs during\nthe suspend callback, which can cause intermittent suspend/hibernation\nproblems with the following kernel traces:\n\nCalling iommu_suspend+0x0/0x1d0\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 15 at kernel/time/timekeeping.c:868 ktime_get+0x9b/0xb0\n...\nCPU: 0 PID: 15 Comm: rcu_preempt Tainted: G     U      E      6.3-intel #r1\nRIP: 0010:ktime_get+0x9b/0xb0\n...\nCall Trace:\n <IRQ>\n tick_sched_timer+0x22/0x90\n ? __pfx_tick_sched_timer+0x10/0x10\n __hrtimer_run_queues+0x111/0x2b0\n hrtimer_interrupt+0xfa/0x230\n __sysvec_apic_timer_interrupt+0x63/0x140\n sysvec_apic_timer_interrupt+0x7b/0xa0\n </IRQ>\n <TASK>\n asm_sysvec_apic_timer_interrupt+0x1f/0x30\n...\n------------[ cut here ]------------\nInterrupts enabled after iommu_suspend+0x0/0x1d0\nWARNING: CPU: 0 PID: 27420 at drivers/base/syscore.c:68 syscore_suspend+0x147/0x270\nCPU: 0 PID: 27420 Comm: rtcwake Tainted: G     U  W   E      6.3-intel #r1\nRIP: 0010:syscore_suspend+0x147/0x270\n...\nCall Trace:\n <TASK>\n hibernation_snapshot+0x25b/0x670\n hibernate+0xcd/0x390\n state_store+0xcf/0xe0\n kobj_attr_store+0x13/0x30\n sysfs_kf_write+0x3f/0x50\n kernfs_fop_write_iter+0x128/0x200\n vfs_write+0x1fd/0x3c0\n ksys_write+0x6f/0xf0\n __x64_sys_write+0x1d/0x30\n do_syscall_64+0x3b/0x90\n entry_SYSCALL_64_after_hwframe+0x72/0xdc\n\nGiven that only 4 words memory is needed, avoid the memory allocation in\niommu_suspend().\n    ",
		"advisory": {
			"from": "security@suse.de",
			"Severity": "Moderate",
			"cve": {
				"text": "CVE-2023-52559",
				"href": "https://www.suse.com/security/cve/CVE-2023-52559/",
				"impact": "moderate",
				"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
			},
			"bugzilla": [
				{
					"text": "SUSE bug 1220933",
					"href": "https://bugzilla.suse.com/1220933"
				}
			],
			"issued": {
				"date": "2024-03-07"
			},
			"updated": {
				"date": "2024-03-15"
			},
			"affected_cpe_list": {
				"Cpe": [
					"cpe:/o:suse:sle-module-live-patching:15:sp4",
					"cpe:/o:suse:sle-module-public-cloud:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sles-ltss:15",
					"cpe:/o:suse:sles-ltss:15:sp1",
					"cpe:/o:suse:sles-ltss:15:sp2",
					"cpe:/o:suse:sles-ltss:15:sp3",
					"cpe:/o:suse:sles-ltss:15:sp4",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp2",
					"cpe:/o:suse:sles_sap:15:sp3",
					"cpe:/o:suse:sles_sap:15:sp4",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009660213",
								"comment": "SUSE Linux Enterprise Server 15 SP2-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009729178",
								"comment": "SUSE Linux Enterprise Server 15 SP3-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009659637",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669878",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338037",
								"comment": "reiserfs-kmp-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009341508",
								"comment": "SUSE Linux Enterprise Server 15 SP1-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302033",
								"comment": "SUSE Linux Enterprise Server 15-LTSS is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334017",
								"comment": "kernel-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335425",
								"comment": "kernel-default-base is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335423",
								"comment": "kernel-default-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335426",
								"comment": "kernel-default-man is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338037",
								"comment": "reiserfs-kmp-default is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334791",
								"comment": "kernel-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009334792",
								"comment": "kernel-macros is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333928",
								"comment": "kernel-source is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009762868",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009850486",
								"comment": "kernel-azure-5.14.21-150500.33.37.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009850487",
								"comment": "kernel-azure-devel-5.14.21-150500.33.37.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009850492",
								"comment": "kernel-devel-azure-5.14.21-150500.33.37.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009850493",
								"comment": "kernel-source-azure-5.14.21-150500.33.37.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009850494",
								"comment": "kernel-syms-azure-5.14.21-150500.33.37.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851082",
								"comment": "kernel-default-livepatch-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851083",
								"comment": "kernel-default-livepatch-devel-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851084",
								"comment": "kernel-livepatch-5_14_21-150400_24_111-default-1-150400.9.3.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009698985",
						"comment": "SUSE Linux Enterprise Live Patching 15 SP4 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851094",
								"comment": "kernel-64kb-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851095",
								"comment": "kernel-64kb-devel-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851109",
								"comment": "kernel-default-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851110",
								"comment": "kernel-default-base-5.14.21-150400.24.111.2.150400.24.52.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851111",
								"comment": "kernel-default-devel-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851099",
								"comment": "kernel-devel-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851100",
								"comment": "kernel-docs-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851101",
								"comment": "kernel-macros-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851112",
								"comment": "kernel-obs-build-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851103",
								"comment": "kernel-source-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851113",
								"comment": "kernel-syms-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851114",
								"comment": "kernel-zfcpdump-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851115",
								"comment": "reiserfs-kmp-default-5.14.21-150400.24.111.2 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009816749",
						"comment": "SUSE Linux Enterprise Server 15 SP4-LTSS is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851147",
								"comment": "kernel-default-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851148",
								"comment": "kernel-default-base-5.14.21-150400.24.111.2.150400.24.52.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851149",
								"comment": "kernel-default-devel-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851099",
								"comment": "kernel-devel-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851100",
								"comment": "kernel-docs-5.14.21-150400.24.111.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851101",
								"comment": "kernel-macros-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851150",
								"comment": "kernel-obs-build-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851103",
								"comment": "kernel-source-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851151",
								"comment": "kernel-syms-5.14.21-150400.24.111.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009851152",
								"comment": "reiserfs-kmp-default-5.14.21-150400.24.111.2 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009669928",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP4 is installed"
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:202146992",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2021-46992",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Enterprise Storage 7",
				"SUSE Enterprise Storage 7.1",
				"SUSE Linux Enterprise High Performance Computing 15 SP2",
				"SUSE Linux Enterprise High Performance Computing 15 SP3",
				"SUSE Linux Enterprise Live Patching 15 SP2",
				"SUSE Linux Enterprise Live Patching 15 SP3",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP2",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP3",
				"SUSE Linux Enterprise Server 15 SP1-LTSS",
				"SUSE Linux Enterprise Server 15 SP2",
				"SUSE Linux Enterprise Server 15 SP2-LTSS",
				"SUSE Linux Enterprise Server 15 SP3",
				"SUSE Linux Enterprise Server 15 SP3-LTSS",
				"SUSE Linux Enterprise Server 15-LTSS",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP2",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP3",
				"SUSE Manager Proxy 4.1",
				"SUSE Manager Proxy 4.2",
				"SUSE Manager Retail Branch Server 4.1",
				"SUSE Manager Retail Branch Server 4.2",
				"SUSE Manager Server 4.1",
				"SUSE Manager Server 4.2"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2021-46992",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46992",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2021-46992",
				"ref_url": "https://www.suse.com/security/cve/CVE-2021-46992",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:0925-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018205.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0975-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018186.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:0976-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-March/018185.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1454-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-April/035109.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1465-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019273.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1489-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019270.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nftables: avoid overflows in nft_hash_buckets()\n\nNumber of buckets being stored in 32bit variables, we have to\nensure that no overflows occur in nft_hash_buckets()\n\nsyzbot injected a size == 0x40000000 and reported:\n\nUBSAN: shift-out-of-bounds in ./include/linux/log2.h:57:13\nshift exponent 64 is too large for 64-bit type 'long unsigned int'\nCPU: 1 PID: 29539 Comm: syz-executor.4 Not tainted 5.12.0-rc7-syzkaller #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011\nCall Trace:\n __dump_stack lib/dump_stack.c:79 [inline]\n dump_stack+0x141/0x1d7 lib/dump_stack.c:120\n ubsan_epilogue+0xb/0x5a lib/ubsan.c:148\n __ubsan_handle_shift_out_of_bounds.cold+0xb1/0x181 lib/ubsan.c:327\n __roundup_pow_of_two include/linux/log2.h:57 [inline]\n nft_hash_buckets net/netfilter/nft_set_hash.c:411 [inline]\n nft_hash_estimate.cold+0x19/0x1e net/netfilter/nft_set_hash.c:652\n nft_select_set_ops net/netfilter/nf_tables_api.c:3586 [inline]\n nf_tables_newset+0xe62/0x3110 net/netfilter/nf_tables_api.c:4322\n nfnetlink_rcv_batch+0xa09/0x24b0 net/netfilter/nfnetlink.c:488\n nfnetlink_rcv_skb_batch net/netfilter/nfnetlink.c:612 [inline]\n nfnetlink_rcv+0x3af/0x420 net/netfilter/nfnetlink.c:630\n netlink_unicast_kernel net/netlink/af_netlink.c:1312 [inline]\n netlink_unicast+0x533/0x7d0 net/netlink/af_netlink.c:1338\n netlink_sendmsg+0x856/0xd90 net/netlink/af_netlink.c:1927\n sock_sendmsg_nosec net/socket.c:654 [inline]\n sock_sendmsg+0xcf/0x120 net/socket.c:674\n ____sys_sendmsg+0x6e8/0x810 net/socket.c:2350\n ___sys_sendmsg+0xf3/0x170 net/socket.c:2404\n __sys_sendmsg+0xe5/0x1b0 net/socket.c:2433\n do_syscall_64+0x2d/0x70 arch/x86/entry/common.c:46\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2021-46992 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2021-46992/",
					"impact": "medium",
					"cvss3": "5.3/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L"
				},
				{
					"text": "CVE-2021-46992 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2021-46992"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1220638",
					"href": "https://bugzilla.suse.com/1220638"
				}
			],
			"issued": {
				"date": "2024-03-01"
			},
			"updated": {
				"date": "2024-08-20"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:ses:7",
					"cpe:/o:suse:ses:7.1",
					"cpe:/o:suse:sle-module-live-patching:15:sp2",
					"cpe:/o:suse:sle-module-live-patching:15:sp3",
					"cpe:/o:suse:sle-module-public-cloud:15:sp2",
					"cpe:/o:suse:sle-module-public-cloud:15:sp3",
					"cpe:/o:suse:sle_hpc:15:sp2",
					"cpe:/o:suse:sle_hpc:15:sp3",
					"cpe:/o:suse:sles-ltss:15",
					"cpe:/o:suse:sles-ltss:15:sp1",
					"cpe:/o:suse:sles-ltss:15:sp2",
					"cpe:/o:suse:sles-ltss:15:sp3",
					"cpe:/o:suse:sles:15:sp2",
					"cpe:/o:suse:sles:15:sp3",
					"cpe:/o:suse:sles_sap:15:sp2",
					"cpe:/o:suse:sles_sap:15:sp3",
					"cpe:/o:suse:suse-manager-proxy:4.1",
					"cpe:/o:suse:suse-manager-proxy:4.2",
					"cpe:/o:suse:suse-manager-retail-branch-server:4.1",
					"cpe:/o:suse:suse-manager-retail-branch-server:4.2",
					"cpe:/o:suse:suse-manager-server:4.1",
					"cpe:/o:suse:suse-manager-server:4.2"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302786",
								"comment": "SUSE Enterprise Storage 7 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009681000",
								"comment": "SUSE Enterprise Storage 7.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009479728",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669877",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009287160",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009351817",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009303870",
								"comment": "SUSE Linux Enterprise Server 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009476340",
								"comment": "SUSE Linux Enterprise Server 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009659637",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669878",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302537",
								"comment": "SUSE Manager Proxy 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669879",
								"comment": "SUSE Manager Proxy 4.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009346072",
								"comment": "SUSE Manager Retail Branch Server 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009677266",
								"comment": "SUSE Manager Retail Branch Server 4.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302605",
								"comment": "SUSE Manager Server 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669880",
								"comment": "SUSE Manager Server 4.2 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009340767",
						"comment": "kernel-source-azure is affected"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009341508",
								"comment": "SUSE Linux Enterprise Server 15 SP1-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302033",
								"comment": "SUSE Linux Enterprise Server 15-LTSS is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338033",
								"comment": "kernel-default-base is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338036",
								"comment": "kernel-default-man is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338038",
								"comment": "reiserfs-kmp-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858120",
								"comment": "kernel-default-livepatch-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858121",
								"comment": "kernel-default-livepatch-devel-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858122",
								"comment": "kernel-livepatch-5_3_18-150200_24_188-default-1-150200.5.3.3 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009288462",
						"comment": "SUSE Linux Enterprise Live Patching 15 SP2 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858138",
								"comment": "kernel-default-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858139",
								"comment": "kernel-default-base-5.3.18-150200.24.188.1.150200.9.95.3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858140",
								"comment": "kernel-default-devel-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858130",
								"comment": "kernel-devel-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858131",
								"comment": "kernel-docs-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858132",
								"comment": "kernel-macros-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858141",
								"comment": "kernel-obs-build-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858134",
								"comment": "kernel-preempt-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858135",
								"comment": "kernel-preempt-devel-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858136",
								"comment": "kernel-source-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858142",
								"comment": "kernel-syms-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858143",
								"comment": "reiserfs-kmp-default-5.3.18-150200.24.188.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009660213",
						"comment": "SUSE Linux Enterprise Server 15 SP2-LTSS is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858144",
								"comment": "kernel-default-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858145",
								"comment": "kernel-default-base-5.3.18-150200.24.188.1.150200.9.95.3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858146",
								"comment": "kernel-default-devel-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858130",
								"comment": "kernel-devel-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858131",
								"comment": "kernel-docs-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858132",
								"comment": "kernel-macros-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858147",
								"comment": "kernel-obs-build-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858148",
								"comment": "kernel-preempt-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858149",
								"comment": "kernel-preempt-devel-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858136",
								"comment": "kernel-source-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858150",
								"comment": "kernel-syms-5.3.18-150200.24.188.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858151",
								"comment": "reiserfs-kmp-default-5.3.18-150200.24.188.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009659637",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP2 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858799",
								"comment": "kernel-default-livepatch-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858800",
								"comment": "kernel-default-livepatch-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858801",
								"comment": "kernel-livepatch-5_3_18-150300_59_158-default-1-150300.7.3.5 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009478738",
						"comment": "SUSE Linux Enterprise Live Patching 15 SP3 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858806",
								"comment": "kernel-64kb-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858807",
								"comment": "kernel-64kb-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858820",
								"comment": "kernel-default-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858821",
								"comment": "kernel-default-base-5.3.18-150300.59.158.1.150300.18.92.5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858822",
								"comment": "kernel-default-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858811",
								"comment": "kernel-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858812",
								"comment": "kernel-docs-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858813",
								"comment": "kernel-macros-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858823",
								"comment": "kernel-obs-build-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858815",
								"comment": "kernel-preempt-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858816",
								"comment": "kernel-preempt-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858817",
								"comment": "kernel-source-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858824",
								"comment": "kernel-syms-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858825",
								"comment": "kernel-zfcpdump-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858826",
								"comment": "reiserfs-kmp-default-5.3.18-150300.59.158.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009729178",
						"comment": "SUSE Linux Enterprise Server 15 SP3-LTSS is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858827",
								"comment": "kernel-default-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858828",
								"comment": "kernel-default-base-5.3.18-150300.59.158.1.150300.18.92.5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858829",
								"comment": "kernel-default-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858811",
								"comment": "kernel-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858812",
								"comment": "kernel-docs-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858813",
								"comment": "kernel-macros-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858830",
								"comment": "kernel-obs-build-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858831",
								"comment": "kernel-preempt-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858832",
								"comment": "kernel-preempt-devel-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858817",
								"comment": "kernel-source-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858833",
								"comment": "kernel-syms-5.3.18-150300.59.158.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009858834",
								"comment": "reiserfs-kmp-default-5.3.18-150300.59.158.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009669878",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:202457849",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-57849",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Live Patching 15 SP3",
				"SUSE Linux Enterprise Live Patching 15 SP4",
				"SUSE Linux Enterprise Live Patching 15 SP5",
				"SUSE Linux Enterprise Module for Confidential Computing Technical Preview 15 SP6",
				"SUSE Linux Enterprise Server 15 SP1-LTSS",
				"SUSE Linux Enterprise Server 15 SP2-LTSS",
				"SUSE Linux Enterprise Server 15 SP3-LTSS",
				"SUSE Linux Enterprise Server 15 SP4-LTSS",
				"SUSE Linux Enterprise Server 15 SP5-LTSS",
				"SUSE Linux Enterprise Server 15-LTSS",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP3",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP4",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-57849",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-57849",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-57849",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-57849",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2025:0236-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020196.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2025:0289-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2025-January/020239.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\ns390/cpum_sf: Handle CPU hotplug remove during sampling\n\nCPU hotplug remove handling triggers the following function\ncall sequence:\n\n   CPUHP_AP_PERF_S390_SF_ONLINE  --> s390_pmu_sf_offline_cpu()\n   ...\n   CPUHP_AP_PERF_ONLINE          --> perf_event_exit_cpu()\n\nThe s390 CPUMF sampling CPU hotplug handler invokes:\n\n s390_pmu_sf_offline_cpu()\n +-->  cpusf_pmu_setup()\n       +--> setup_pmc_cpu()\n            +--> deallocate_buffers()\n\nThis function de-allocates all sampling data buffers (SDBs) allocated\nfor that CPU at event initialization. It also clears the\nPMU_F_RESERVED bit. The CPU is gone and can not be sampled.\n\nWith the event still being active on the removed CPU, the CPU event\nhotplug support in kernel performance subsystem triggers the\nfollowing function calls on the removed CPU:\n\n  perf_event_exit_cpu()\n  +--> perf_event_exit_cpu_context()\n       +--> __perf_event_exit_context()\n\t    +--> __perf_remove_from_context()\n\t         +--> event_sched_out()\n\t              +--> cpumsf_pmu_del()\n\t                   +--> cpumsf_pmu_stop()\n                                +--> hw_perf_event_update()\n\nto stop and remove the event. During removal of the event, the\nsampling device driver tries to read out the remaining samples from\nthe sample data buffers (SDBs). But they have already been freed\n(and may have been re-assigned). This may lead to a use after free\nsituation in which case the samples are most likely invalid. In the\nbest case the memory has not been reassigned and still contains\nvalid data.\n\nRemedy this situation and check if the CPU is still in reserved\nstate (bit PMU_F_RESERVED set). In this case the SDBs have not been\nreleased an contain valid data. This is always the case when\nthe event is removed (and no CPU hotplug off occured).\nIf the PMU_F_RESERVED bit is not set, the SDB buffers are gone.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Important",
			"cve": [
				{
					"text": "CVE-2024-57849 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-57849/",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-57849 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-57849"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1235814",
					"href": "https://bugzilla.suse.com/1235814"
				},
				{
					"text": "SUSE bug 1235815",
					"href": "https://bugzilla.suse.com/1235815"
				}
			],
			"issued": {
				"date": "2025-01-15"
			},
			"updated": {
				"date": "2025-02-03"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-live-patching:15:sp3",
					"cpe:/o:suse:sle-module-live-patching:15:sp4",
					"cpe:/o:suse:sle-module-live-patching:15:sp5",
					"cpe:/o:suse:sles-ltss:15",
					"cpe:/o:suse:sles-ltss:15:sp1",
					"cpe:/o:suse:sles-ltss:15:sp2",
					"cpe:/o:suse:sles-ltss:15:sp3",
					"cpe:/o:suse:sles-ltss:15:sp4",
					"cpe:/o:suse:sles-ltss:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp3",
					"cpe:/o:suse:sles_sap:15:sp4",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009341508",
								"comment": "SUSE Linux Enterprise Server 15 SP1-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302033",
								"comment": "SUSE Linux Enterprise Server 15-LTSS is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338033",
								"comment": "kernel-default-base is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338036",
								"comment": "kernel-default-man is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338038",
								"comment": "reiserfs-kmp-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009660213",
								"comment": "SUSE Linux Enterprise Server 15 SP2-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009729178",
								"comment": "SUSE Linux Enterprise Server 15 SP3-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009816749",
								"comment": "SUSE Linux Enterprise Server 15 SP4-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958873",
								"comment": "SUSE Linux Enterprise Server 15 SP5-LTSS is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669878",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669928",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338038",
								"comment": "reiserfs-kmp-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009478738",
								"comment": "SUSE Linux Enterprise Live Patching 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009698985",
								"comment": "SUSE Linux Enterprise Live Patching 15 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009764853",
								"comment": "SUSE Linux Enterprise Live Patching 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009764854",
								"comment": "kernel-default-livepatch is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009764855",
								"comment": "kernel-default-livepatch-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961656",
								"comment": "kernel-coco-6.4.0-15061.12.coco15sp6.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961657",
								"comment": "kernel-coco-devel-6.4.0-15061.12.coco15sp6.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961658",
								"comment": "kernel-coco_debug-6.4.0-15061.12.coco15sp6.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961659",
								"comment": "kernel-coco_debug-devel-6.4.0-15061.12.coco15sp6.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961660",
								"comment": "kernel-devel-coco-6.4.0-15061.12.coco15sp6.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961661",
								"comment": "kernel-source-coco-6.4.0-15061.12.coco15sp6.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961662",
								"comment": "kernel-syms-coco-6.4.0-15061.12.coco15sp6.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009961663",
								"comment": "reiserfs-kmp-coco-6.4.0-15061.12.coco15sp6.1 is installed"
							}
						]
					}
				],
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009945160",
						"comment": "SUSE Linux Enterprise Module for Confidential Computing Technical Preview 15 SP6 is installed"
					}
				]
			}
		]
	}
}

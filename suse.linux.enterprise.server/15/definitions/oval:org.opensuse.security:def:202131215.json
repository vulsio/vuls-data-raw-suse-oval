{
  "id": "oval:org.opensuse.security:def:202131215",
  "version": "1",
  "class": "vulnerability",
  "metadata": {
    "Title": "CVE-2021-31215",
    "affected": {
      "family": "unix",
      "Platform": [
        "SUSE Linux Enterprise High Performance Computing 15 SP2",
        "SUSE Linux Enterprise High Performance Computing 15 SP3",
        "SUSE Linux Enterprise High Performance Computing 15 SP4",
        "SUSE Linux Enterprise Module for HPC 15 SP2",
        "SUSE Linux Enterprise Module for HPC 15 SP3",
        "SUSE Linux Enterprise Module for HPC 15 SP4"
      ]
    },
    "reference": [
      {
        "ref_id": "Mitre CVE-2021-31215",
        "ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31215",
        "source": "CVE"
      },
      {
        "ref_id": "SUSE CVE-2021-31215",
        "ref_url": "https://www.suse.com/security/cve/CVE-2021-31215",
        "source": "SUSE CVE"
      },
      {
        "ref_id": "SUSE-SU-2021:1787-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008874.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1788-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008880.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1789-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008872.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1790-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008877.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1791-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008870.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1793-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008871.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1810-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008893.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1811-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008891.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1855-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-June/008930.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:1856-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-updates/2021-June/019202.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:2295-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-July/009122.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "SUSE-SU-2021:2473-1",
        "ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2021-July/009216.html",
        "source": "SUSE-SU"
      },
      {
        "ref_id": "openSUSE-SU-2021:0821-1",
        "ref_url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/KQZ3XESX2ESDFJO4Y7ZLU4AIJYQKBO4W/",
        "source": "SUSE-SU"
      }
    ],
    "Description": "\n    SchedMD Slurm before 20.02.7 and 20.03.x through 20.11.x before 20.11.7 allows remote code execution as SlurmUser because use of a PrologSlurmctld or EpilogSlurmctld script leads to environment mishandling.\n    ",
    "advisory": {
      "from": "security@suse.de",
      "Severity": "Important",
      "cve": {
        "text": "CVE-2021-31215",
        "href": "https://www.suse.com/security/cve/CVE-2021-31215/",
        "impact": "important",
        "cvss3": "8.6/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H"
      },
      "bugzilla": [
        {
          "text": "SUSE bug 1186024",
          "href": "https://bugzilla.suse.com/1186024"
        }
      ],
      "issued": {
        "date": "2022-03-01"
      },
      "updated": {
        "date": "2023-01-20"
      },
      "affected_cpe_list": {
        "Cpe": [
          "cpe:/o:suse:sle-module-hpc:15:sp2",
          "cpe:/o:suse:sle-module-hpc:15:sp3",
          "cpe:/o:suse:sle-module-hpc:15:sp4",
          "cpe:/o:suse:sle_hpc:15:sp2",
          "cpe:/o:suse:sle_hpc:15:sp3",
          "cpe:/o:suse:sle_hpc:15:sp4"
        ]
      }
    }
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009479728",
                "comment": "SUSE Linux Enterprise High Performance Computing 15 SP2 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009299864",
                "comment": "SUSE Linux Enterprise Module for HPC 15 SP2 is installed"
              }
            ]
          },
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496894",
                "comment": "libnss_slurm2-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496914",
                "comment": "libnss_slurm2_20_11-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496895",
                "comment": "libpmi0-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496915",
                "comment": "libpmi0_20_11-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496896",
                "comment": "libslurm35-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496916",
                "comment": "libslurm36-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496897",
                "comment": "perl-slurm-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496917",
                "comment": "perl-slurm_20_11-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496898",
                "comment": "slurm-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496899",
                "comment": "slurm-auth-none-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496900",
                "comment": "slurm-config-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496901",
                "comment": "slurm-config-man-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496902",
                "comment": "slurm-devel-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496903",
                "comment": "slurm-doc-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496904",
                "comment": "slurm-lua-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496905",
                "comment": "slurm-munge-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496906",
                "comment": "slurm-node-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496907",
                "comment": "slurm-pam_slurm-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496908",
                "comment": "slurm-plugins-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496909",
                "comment": "slurm-slurmdbd-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496910",
                "comment": "slurm-sql-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496911",
                "comment": "slurm-sview-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496912",
                "comment": "slurm-torque-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496913",
                "comment": "slurm-webdoc-20.02.7-3.6.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496918",
                "comment": "slurm_20_11-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496919",
                "comment": "slurm_20_11-auth-none-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496920",
                "comment": "slurm_20_11-config-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496921",
                "comment": "slurm_20_11-config-man-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496922",
                "comment": "slurm_20_11-devel-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496923",
                "comment": "slurm_20_11-doc-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496924",
                "comment": "slurm_20_11-lua-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496925",
                "comment": "slurm_20_11-munge-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496926",
                "comment": "slurm_20_11-node-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496927",
                "comment": "slurm_20_11-pam_slurm-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496928",
                "comment": "slurm_20_11-plugins-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496929",
                "comment": "slurm_20_11-slurmdbd-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496930",
                "comment": "slurm_20_11-sql-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496931",
                "comment": "slurm_20_11-sview-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496932",
                "comment": "slurm_20_11-torque-20.11.7-6.5.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009496933",
                "comment": "slurm_20_11-webdoc-20.11.7-6.5.1 is installed"
              }
            ]
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009669877",
                "comment": "SUSE Linux Enterprise High Performance Computing 15 SP3 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626847",
                "comment": "SUSE Linux Enterprise Module for HPC 15 SP3 is installed"
              }
            ]
          },
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626826",
                "comment": "libnss_slurm2-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626827",
                "comment": "libpmi0-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626828",
                "comment": "libslurm36-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626829",
                "comment": "perl-slurm-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626830",
                "comment": "slurm-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626831",
                "comment": "slurm-auth-none-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626832",
                "comment": "slurm-config-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626833",
                "comment": "slurm-config-man-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626834",
                "comment": "slurm-devel-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626835",
                "comment": "slurm-doc-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626836",
                "comment": "slurm-lua-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626837",
                "comment": "slurm-munge-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626838",
                "comment": "slurm-node-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626839",
                "comment": "slurm-pam_slurm-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626840",
                "comment": "slurm-plugins-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626841",
                "comment": "slurm-rest-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626842",
                "comment": "slurm-slurmdbd-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626843",
                "comment": "slurm-sql-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626844",
                "comment": "slurm-sview-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626845",
                "comment": "slurm-torque-20.11.7-4.3.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009626846",
                "comment": "slurm-webdoc-20.11.7-4.3.1 is installed"
              }
            ]
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009669926",
                "comment": "SUSE Linux Enterprise High Performance Computing 15 SP4 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009683486",
                "comment": "SUSE Linux Enterprise Module for HPC 15 SP4 is installed"
              }
            ]
          },
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733813",
                "comment": "libnss_slurm2-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733814",
                "comment": "libpmi0-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733815",
                "comment": "libslurm36-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733816",
                "comment": "perl-slurm-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733817",
                "comment": "slurm-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733818",
                "comment": "slurm-auth-none-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733819",
                "comment": "slurm-config-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733820",
                "comment": "slurm-config-man-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733821",
                "comment": "slurm-cray-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733822",
                "comment": "slurm-devel-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733823",
                "comment": "slurm-doc-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733824",
                "comment": "slurm-lua-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733825",
                "comment": "slurm-munge-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733826",
                "comment": "slurm-node-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733827",
                "comment": "slurm-pam_slurm-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733828",
                "comment": "slurm-plugins-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733829",
                "comment": "slurm-rest-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733830",
                "comment": "slurm-slurmdbd-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733831",
                "comment": "slurm-sql-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733832",
                "comment": "slurm-sview-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733833",
                "comment": "slurm-torque-20.11.9-150400.1.1 is installed"
              },
              {
                "test_ref": "oval:org.opensuse.security:tst:2009733834",
                "comment": "slurm-webdoc-20.11.9-150400.1.1 is installed"
              }
            ]
          }
        ]
      }
    ]
  }
}

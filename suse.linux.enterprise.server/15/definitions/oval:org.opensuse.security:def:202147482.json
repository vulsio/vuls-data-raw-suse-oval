{
	"id": "oval:org.opensuse.security:def:202147482",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2021-47482",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Live Patching 15 SP5",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2021-47482",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47482",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2021-47482",
				"ref_url": "https://www.suse.com/security/cve/CVE-2021-47482",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2008-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035569.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2010-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035576.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2011-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035575.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2019-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035578.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnet: batman-adv: fix error handling\n\nSyzbot reported ODEBUG warning in batadv_nc_mesh_free(). The problem was\nin wrong error handling in batadv_mesh_init().\n\nBefore this patch batadv_mesh_init() was calling batadv_mesh_free() in case\nof any batadv_*_init() calls failure. This approach may work well, when\nthere is some kind of indicator, which can tell which parts of batadv are\ninitialized; but there isn't any.\n\nAll written above lead to cleaning up uninitialized fields. Even if we hide\nODEBUG warning by initializing bat_priv->nc.work, syzbot was able to hit\nGPF in batadv_nc_purge_paths(), because hash pointer in still NULL. [1]\n\nTo fix these bugs we can unwind batadv_*_init() calls one by one.\nIt is good approach for 2 reasons: 1) It fixes bugs on error handling\npath 2) It improves the performance, since we won't call unneeded\nbatadv_*_free() functions.\n\nSo, this patch makes all batadv_*_init() clean up all allocated memory\nbefore returning with an error to no call correspoing batadv_*_free()\nand open-codes batadv_mesh_free() with proper order to avoid touching\nuninitialized fields.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Low",
			"cve": [
				{
					"text": "CVE-2021-47482 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2021-47482/",
					"impact": "low",
					"cvss3": "3.3/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L"
				},
				{
					"text": "CVE-2021-47482 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2021-47482"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1224909",
					"href": "https://bugzilla.suse.com/1224909"
				}
			],
			"issued": {
				"date": "2024-06-13"
			},
			"updated": {
				"date": "2024-06-14"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-live-patching:15:sp5",
					"cpe:/o:suse:sle-module-public-cloud:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009764853",
						"comment": "SUSE Linux Enterprise Live Patching 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009865673",
						"comment": "kernel-livepatch-5_14_21-150500_13_58-rt-1-150500.11.3.1 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009762868",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865728",
								"comment": "kernel-azure-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865729",
								"comment": "kernel-azure-devel-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865734",
								"comment": "kernel-devel-azure-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865735",
								"comment": "kernel-source-azure-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865736",
								"comment": "kernel-syms-azure-5.14.21-150500.33.57.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

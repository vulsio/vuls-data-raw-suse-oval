{
	"id": "oval:org.opensuse.security:def:202438582",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-38582",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-38582",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-38582",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-38582",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-38582",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2372-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-July/035868.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnilfs2: fix potential hang in nilfs_detach_log_writer()\n\nSyzbot has reported a potential hang in nilfs_detach_log_writer() called\nduring nilfs2 unmount.\n\nAnalysis revealed that this is because nilfs_segctor_sync(), which\nsynchronizes with the log writer thread, can be called after\nnilfs_segctor_destroy() terminates that thread, as shown in the call trace\nbelow:\n\nnilfs_detach_log_writer\n  nilfs_segctor_destroy\n    nilfs_segctor_kill_thread  --> Shut down log writer thread\n    flush_work\n      nilfs_iput_work_func\n        nilfs_dispose_list\n          iput\n            nilfs_evict_inode\n              nilfs_transaction_commit\n                nilfs_construct_segment (if inode needs sync)\n                  nilfs_segctor_sync  --> Attempt to synchronize with\n                                          log writer thread\n                           *** DEADLOCK ***\n\nFix this issue by changing nilfs_segctor_sync() so that the log writer\nthread returns normally without synchronizing after it terminates, and by\nforcing tasks that are already waiting to complete once after the thread\nterminates.\n\nThe skipped inode metadata flushout will then be processed together in the\nsubsequent cleanup work in nilfs_segctor_destroy().\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-38582 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-38582/",
					"impact": "medium",
					"cvss3": "4.7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-38582 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-38582"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1226658",
					"href": "https://bugzilla.suse.com/1226658"
				}
			],
			"issued": {
				"date": "2024-07-10"
			},
			"updated": {
				"date": "2024-07-10"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-public-cloud:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "AND",
		"criterias": [
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759899",
						"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009762868",
						"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759901",
						"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009759902",
						"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
					}
				]
			},
			{
				"operator": "OR",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871894",
						"comment": "kernel-azure-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871895",
						"comment": "kernel-azure-devel-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871900",
						"comment": "kernel-devel-azure-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871901",
						"comment": "kernel-source-azure-5.14.21-150500.33.60.1 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009871902",
						"comment": "kernel-syms-azure-5.14.21-150500.33.60.1 is installed"
					}
				]
			}
		]
	}
}

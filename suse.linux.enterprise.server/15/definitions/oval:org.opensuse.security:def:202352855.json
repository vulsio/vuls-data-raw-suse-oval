{
	"id": "oval:org.opensuse.security:def:202352855",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2023-52855",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Live Patching 15 SP5",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2023-52855",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52855",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2023-52855",
				"ref_url": "https://www.suse.com/security/cve/CVE-2023-52855",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2008-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035569.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2011-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035575.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2019-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035578.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nusb: dwc2: fix possible NULL pointer dereference caused by driver concurrency\n\nIn _dwc2_hcd_urb_enqueue(), \"urb->hcpriv = NULL\" is executed without\nholding the lock \"hsotg->lock\". In _dwc2_hcd_urb_dequeue():\n\n    spin_lock_irqsave(&hsotg->lock, flags);\n    ...\n\tif (!urb->hcpriv) {\n\t\tdev_dbg(hsotg->dev, \"## urb->hcpriv is NULL ##\\n\");\n\t\tgoto out;\n\t}\n    rc = dwc2_hcd_urb_dequeue(hsotg, urb->hcpriv); // Use urb->hcpriv\n    ...\nout:\n    spin_unlock_irqrestore(&hsotg->lock, flags);\n\nWhen _dwc2_hcd_urb_enqueue() and _dwc2_hcd_urb_dequeue() are\nconcurrently executed, the NULL check of \"urb->hcpriv\" can be executed\nbefore \"urb->hcpriv = NULL\". After urb->hcpriv is NULL, it can be used\nin the function call to dwc2_hcd_urb_dequeue(), which can cause a NULL\npointer dereference.\n\nThis possible bug is found by an experimental static analysis tool\ndeveloped by myself. This tool analyzes the locking APIs to extract\nfunction pairs that can be concurrently executed, and then analyzes the\ninstructions in the paired functions to identify possible concurrency\nbugs including data races and atomicity violations. The above possible\nbug is reported, when my tool analyzes the source code of Linux 6.5.\n\nTo fix this possible bug, \"urb->hcpriv = NULL\" should be executed with\nholding the lock \"hsotg->lock\". After using this patch, my tool never\nreports the possible bug, with the kernelconfiguration allyesconfig for\nx86_64. Because I have no associated hardware, I cannot test the patch\nin runtime testing, and just verify it according to the code logic.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2023-52855 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2023-52855/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2023-52855 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2023-52855"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1225583",
					"href": "https://bugzilla.suse.com/1225583"
				}
			],
			"issued": {
				"date": "2024-06-13"
			},
			"updated": {
				"date": "2024-06-14"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-live-patching:15:sp5",
					"cpe:/o:suse:sle-module-public-cloud:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009764853",
						"comment": "SUSE Linux Enterprise Live Patching 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009865673",
						"comment": "kernel-livepatch-5_14_21-150500_13_58-rt-1-150500.11.3.1 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009762868",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865728",
								"comment": "kernel-azure-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865729",
								"comment": "kernel-azure-devel-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865734",
								"comment": "kernel-devel-azure-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865735",
								"comment": "kernel-source-azure-5.14.21-150500.33.57.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009865736",
								"comment": "kernel-syms-azure-5.14.21-150500.33.57.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

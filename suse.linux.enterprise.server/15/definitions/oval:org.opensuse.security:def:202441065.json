{
	"id": "oval:org.opensuse.security:def:202441065",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-41065",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP6",
				"SUSE Linux Enterprise Live Patching 15 SP5",
				"SUSE Linux Enterprise Live Patching 15 SP6",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP5",
				"SUSE Linux Enterprise Module for Public Cloud 15 SP6",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server 15 SP6",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-41065",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41065",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-41065",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-41065",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3190-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019403.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3194-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036835.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3195-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036842.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3209-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036854.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/pseries: Whitelist dtl slub object for copying to userspace\n\nReading the dispatch trace log from /sys/kernel/debug/powerpc/dtl/cpu-*\nresults in a BUG() when the config CONFIG_HARDENED_USERCOPY is enabled as\nshown below.\n\n    kernel BUG at mm/usercopy.c:102!\n    Oops: Exception in kernel mode, sig: 5 [#1]\n    LE PAGE_SIZE=64K MMU=Radix SMP NR_CPUS=2048 NUMA pSeries\n    Modules linked in: xfs libcrc32c dm_service_time sd_mod t10_pi sg ibmvfc\n    scsi_transport_fc ibmveth pseries_wdt dm_multipath dm_mirror dm_region_hash dm_log dm_mod fuse\n    CPU: 27 PID: 1815 Comm: python3 Not tainted 6.10.0-rc3 #85\n    Hardware name: IBM,9040-MRX POWER10 (raw) 0x800200 0xf000006 of:IBM,FW1060.00 (NM1060_042) hv:phyp pSeries\n    NIP:  c0000000005d23d4 LR: c0000000005d23d0 CTR: 00000000006ee6f8\n    REGS: c000000120c078c0 TRAP: 0700   Not tainted  (6.10.0-rc3)\n    MSR:  8000000000029033 <SF,EE,ME,IR,DR,RI,LE>  CR: 2828220f  XER: 0000000e\n    CFAR: c0000000001fdc80 IRQMASK: 0\n    [ ... GPRs omitted ... ]\n    NIP [c0000000005d23d4] usercopy_abort+0x78/0xb0\n    LR [c0000000005d23d0] usercopy_abort+0x74/0xb0\n    Call Trace:\n     usercopy_abort+0x74/0xb0 (unreliable)\n     __check_heap_object+0xf8/0x120\n     check_heap_object+0x218/0x240\n     __check_object_size+0x84/0x1a4\n     dtl_file_read+0x17c/0x2c4\n     full_proxy_read+0x8c/0x110\n     vfs_read+0xdc/0x3a0\n     ksys_read+0x84/0x144\n     system_call_exception+0x124/0x330\n     system_call_vectored_common+0x15c/0x2ec\n    --- interrupt: 3000 at 0x7fff81f3ab34\n\nCommit 6d07d1cd300f (\"usercopy: Restrict non-usercopy caches to size 0\")\nrequires that only whitelisted areas in slab/slub objects can be copied to\nuserspace when usercopy hardening is enabled using CONFIG_HARDENED_USERCOPY.\nDtl contains hypervisor dispatch events which are expected to be read by\nprivileged users. Hence mark this safe for user access.\nSpecify useroffset=0 and usersize=DISPATCH_LOG_BYTES to whitelist the\nentire object.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-41065 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-41065/",
					"impact": "medium",
					"cvss3": "4.4/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-41065 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-41065"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1228636",
					"href": "https://bugzilla.suse.com/1228636"
				}
			],
			"issued": {
				"date": "2024-09-11"
			},
			"updated": {
				"date": "2024-09-12"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-live-patching:15:sp5",
					"cpe:/o:suse:sle-module-live-patching:15:sp6",
					"cpe:/o:suse:sle-module-public-cloud:15:sp5",
					"cpe:/o:suse:sle-module-public-cloud:15:sp6",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009857543",
						"comment": "SUSE Linux Enterprise Live Patching 15 SP6 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009942033",
						"comment": "kernel-livepatch-6_4_0-150600_10_8-rt-1-150600.1.3.2 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterions": [
					{
						"test_ref": "oval:org.opensuse.security:tst:2009764853",
						"comment": "SUSE Linux Enterprise Live Patching 15 SP5 is installed"
					},
					{
						"test_ref": "oval:org.opensuse.security:tst:2009942378",
						"comment": "kernel-livepatch-5_14_21-150500_13_67-rt-1-150500.11.3.2 is installed"
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009762868",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009941981",
								"comment": "kernel-azure-5.14.21-150500.33.66.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009941982",
								"comment": "kernel-azure-devel-5.14.21-150500.33.66.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009941987",
								"comment": "kernel-devel-azure-5.14.21-150500.33.66.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009941988",
								"comment": "kernel-source-azure-5.14.21-150500.33.66.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009941989",
								"comment": "kernel-syms-azure-5.14.21-150500.33.66.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856320",
								"comment": "SUSE Linux Enterprise Module for Public Cloud 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009941998",
								"comment": "kernel-azure-6.4.0-150600.8.11.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009941999",
								"comment": "kernel-azure-devel-6.4.0-150600.8.11.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942004",
								"comment": "kernel-devel-azure-6.4.0-150600.8.11.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942005",
								"comment": "kernel-source-azure-6.4.0-150600.8.11.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009942006",
								"comment": "kernel-syms-azure-6.4.0-150600.8.11.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

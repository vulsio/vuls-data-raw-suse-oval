{
	"id": "oval:org.opensuse.security:def:202449882",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-49882",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise Desktop 15 SP6",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP6",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP6",
				"SUSE Linux Enterprise Module for Development Tools 15 SP5",
				"SUSE Linux Enterprise Module for Development Tools 15 SP6",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server 15 SP6",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-49882",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-49882",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-49882",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-49882",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3983-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019816.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3984-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019815.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3985-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019814.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3986-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019813.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4100-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019864.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4318-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019999.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4364-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/020019.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4387-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/020032.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "openSUSE-SU-2024:14500-1",
				"ref_url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/2NO44GTYBSPPWKFDREFWHITK4XKTNVLP/",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix double brelse() the buffer of the extents path\n\nIn ext4_ext_try_to_merge_up(), set path[1].p_bh to NULL after it has been\nreleased, otherwise it may be released twice. An example of what triggers\nthis is as follows:\n\n  split2    map    split1\n|--------|-------|--------|\n\next4_ext_map_blocks\n ext4_ext_handle_unwritten_extents\n  ext4_split_convert_extents\n   // path->p_depth == 0\n   ext4_split_extent\n     // 1. do split1\n     ext4_split_extent_at\n       |ext4_ext_insert_extent\n       |  ext4_ext_create_new_leaf\n       |    ext4_ext_grow_indepth\n       |      le16_add_cpu(&neh->eh_depth, 1)\n       |    ext4_find_extent\n       |      // return -ENOMEM\n       |// get error and try zeroout\n       |path = ext4_find_extent\n       |  path->p_depth = 1\n       |ext4_ext_try_to_merge\n       |  ext4_ext_try_to_merge_up\n       |    path->p_depth = 0\n       |    brelse(path[1].p_bh)  ---> not set to NULL here\n       |// zeroout success\n     // 2. update path\n     ext4_find_extent\n     // 3. do split2\n     ext4_split_extent_at\n       ext4_ext_insert_extent\n         ext4_ext_create_new_leaf\n           ext4_ext_grow_indepth\n             le16_add_cpu(&neh->eh_depth, 1)\n           ext4_find_extent\n             path[0].p_bh = NULL;\n             path->p_depth = 1\n             read_extent_tree_block  ---> return err\n             // path[1].p_bh is still the old value\n             ext4_free_ext_path\n               ext4_ext_drop_refs\n                 // path->p_depth == 1\n                 brelse(path[1].p_bh)  ---> brelse a buffer twice\n\nFinally got the following WARRNING when removing the buffer from lru:\n\n============================================\nVFS: brelse: Trying to free free buffer\nWARNING: CPU: 2 PID: 72 at fs/buffer.c:1241 __brelse+0x58/0x90\nCPU: 2 PID: 72 Comm: kworker/u19:1 Not tainted 6.9.0-dirty #716\nRIP: 0010:__brelse+0x58/0x90\nCall Trace:\n <TASK>\n __find_get_block+0x6e7/0x810\n bdev_getblk+0x2b/0x480\n __ext4_get_inode_loc+0x48a/0x1240\n ext4_get_inode_loc+0xb2/0x150\n ext4_reserve_inode_write+0xb7/0x230\n __ext4_mark_inode_dirty+0x144/0x6a0\n ext4_ext_insert_extent+0x9c8/0x3230\n ext4_ext_map_blocks+0xf45/0x2dc0\n ext4_map_blocks+0x724/0x1700\n ext4_do_writepages+0x12d6/0x2a70\n[...]\n============================================\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-49882 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-49882/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-49882 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-49882",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1232200",
					"href": "https://bugzilla.suse.com/1232200"
				}
			],
			"issued": {
				"date": "2024-10-27"
			},
			"updated": {
				"date": "2024-12-23"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-basesystem:15:sp6",
					"cpe:/o:suse:sle-module-development-tools:15:sp5",
					"cpe:/o:suse:sle-module-development-tools:15:sp6",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856173",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957890",
								"comment": "kernel-64kb-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957891",
								"comment": "kernel-64kb-devel-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957897",
								"comment": "kernel-default-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957898",
								"comment": "kernel-default-base-6.4.0-150600.23.30.1.150600.12.12.6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957900",
								"comment": "kernel-default-devel-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957906",
								"comment": "kernel-devel-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957912",
								"comment": "kernel-macros-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957918",
								"comment": "kernel-zfcpdump-6.4.0-150600.23.30.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856253",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957907",
								"comment": "kernel-docs-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957913",
								"comment": "kernel-obs-build-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957915",
								"comment": "kernel-source-6.4.0-150600.23.30.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009957917",
								"comment": "kernel-syms-6.4.0-150600.23.30.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958331",
								"comment": "kernel-64kb-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958332",
								"comment": "kernel-64kb-devel-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958338",
								"comment": "kernel-default-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958339",
								"comment": "kernel-default-base-5.14.21-150500.55.88.1.150500.6.39.4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958341",
								"comment": "kernel-default-devel-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958347",
								"comment": "kernel-devel-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958353",
								"comment": "kernel-macros-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958359",
								"comment": "kernel-zfcpdump-5.14.21-150500.55.88.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009760583",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958348",
								"comment": "kernel-docs-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958354",
								"comment": "kernel-obs-build-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958356",
								"comment": "kernel-source-5.14.21-150500.55.88.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009958358",
								"comment": "kernel-syms-5.14.21-150500.55.88.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:202456693",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-56693",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise Desktop 15 SP6",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP6",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP6",
				"SUSE Linux Enterprise Module for Development Tools 15 SP5",
				"SUSE Linux Enterprise Module for Development Tools 15 SP6",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server 15 SP6",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-56693",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56693",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-56693",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-56693",
				"source": "SUSE CVE"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nbrd: defer automatic disk creation until module initialization succeeds\n\nMy colleague Wupeng found the following problems during fault injection:\n\nBUG: unable to handle page fault for address: fffffbfff809d073\nPGD 6e648067 P4D 123ec8067 PUD 123ec4067 PMD 100e38067 PTE 0\nOops: Oops: 0000 [#1] PREEMPT SMP KASAN NOPTI\nCPU: 5 UID: 0 PID: 755 Comm: modprobe Not tainted 6.12.0-rc3+ #17\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\n1.16.1-2.fc37 04/01/2014\nRIP: 0010:__asan_load8+0x4c/0xa0\n...\nCall Trace:\n <TASK>\n blkdev_put_whole+0x41/0x70\n bdev_release+0x1a3/0x250\n blkdev_release+0x11/0x20\n __fput+0x1d7/0x4a0\n task_work_run+0xfc/0x180\n syscall_exit_to_user_mode+0x1de/0x1f0\n do_syscall_64+0x6b/0x170\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nloop_init() is calling loop_add() after __register_blkdev() succeeds and\nis ignoring disk_add() failure from loop_add(), for loop_add() failure\nis not fatal and successfully created disks are already visible to\nbdev_open().\n\nbrd_init() is currently calling brd_alloc() before __register_blkdev()\nsucceeds and is releasing successfully created disks when brd_init()\nreturns an error. This can cause UAF for the latter two case:\n\ncase 1:\n    T1:\nmodprobe brd\n  brd_init\n    brd_alloc(0) // success\n      add_disk\n        disk_scan_partitions\n          bdev_file_open_by_dev // alloc file\n          fput // won't free until back to userspace\n    brd_alloc(1) // failed since mem alloc error inject\n  // error path for modprobe will release code segment\n  // back to userspace\n  __fput\n    blkdev_release\n      bdev_release\n        blkdev_put_whole\n          bdev->bd_disk->fops->release // fops is freed now, UAF!\n\ncase 2:\n    T1:                            T2:\nmodprobe brd\n  brd_init\n    brd_alloc(0) // success\n                                   open(/dev/ram0)\n    brd_alloc(1) // fail\n  // error path for modprobe\n\n                                   close(/dev/ram0)\n                                   ...\n                                   /* UAF! */\n                                   bdev->bd_disk->fops->release\n\nFix this problem by following what loop_init() does. Besides,\nreintroduce brd_devices_mutex to help serialize modifications to\nbrd_list.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Important",
			"cve": [
				{
					"text": "CVE-2024-56693 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-56693/",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-56693 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-56693"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1235418",
					"href": "https://bugzilla.suse.com/1235418"
				},
				{
					"text": "SUSE bug 1235419",
					"href": "https://bugzilla.suse.com/1235419"
				}
			],
			"issued": {
				"date": "2025-01-09"
			},
			"updated": {
				"date": "2025-01-10"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-basesystem:15:sp6",
					"cpe:/o:suse:sle-module-development-tools:15:sp5",
					"cpe:/o:suse:sle-module-development-tools:15:sp6",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009760583",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856253",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009333995",
								"comment": "kernel-source is affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856173",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338032",
								"comment": "kernel-default is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009338034",
								"comment": "kernel-default-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335275",
								"comment": "kernel-devel is affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009335276",
								"comment": "kernel-macros is affected"
							}
						]
					}
				]
			}
		]
	}
}

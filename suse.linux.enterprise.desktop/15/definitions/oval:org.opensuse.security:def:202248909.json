{
	"id": "oval:org.opensuse.security:def:202248909",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2022-48909",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Development Tools 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2022-48909",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48909",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2022-48909",
				"ref_url": "https://www.suse.com/security/cve/CVE-2022-48909",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3190-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019403.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3209-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036854.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3227-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036874.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3408-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/037033.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3483-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/037089.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnet/smc: fix connection leak\n\nThere's a potential leak issue under following execution sequence :\n\nsmc_release  \t\t\t\tsmc_connect_work\nif (sk->sk_state == SMC_INIT)\n\t\t\t\t\tsend_clc_confirim\n\ttcp_abort();\n\t\t\t\t\t...\n\t\t\t\t\tsk.sk_state = SMC_ACTIVE\nsmc_close_active\nswitch(sk->sk_state) {\n...\ncase SMC_ACTIVE:\n\tsmc_close_final()\n\t// then wait peer closed\n\nUnfortunately, tcp_abort() may discard CLC CONFIRM messages that are\nstill in the tcp send buffer, in which case our connection token cannot\nbe delivered to the server side, which means that we cannot get a\npassive close message at all. Therefore, it is impossible for the to be\ndisconnected at all.\n\nThis patch tries a very simple way to avoid this issue, once the state\nhas changed to SMC_ACTIVE after tcp_abort(), we can actively abort the\nsmc connection, considering that the state is SMC_INIT before\ntcp_abort(), abandoning the complete disconnection process should not\ncause too much problem.\n\nIn fact, this problem may exist as long as the CLC CONFIRM message is\nnot received by the server. Whether a timer should be added after\nsmc_close_final() needs to be discussed in the future. But even so, this\npatch provides a faster release for connection in above case, it should\nalso be valuable.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2022-48909 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2022-48909/",
					"impact": "medium",
					"cvss3": "5.3/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L"
				},
				{
					"text": "CVE-2022-48909 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2022-48909",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1229611",
					"href": "https://bugzilla.suse.com/1229611"
				}
			],
			"issued": {
				"date": "2024-09-30"
			},
			"updated": {
				"date": "2024-09-30"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-development-tools:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945059",
								"comment": "kernel-64kb-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945060",
								"comment": "kernel-64kb-devel-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945068",
								"comment": "kernel-default-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945069",
								"comment": "kernel-default-base-5.14.21-150500.55.80.2.150500.6.35.6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945071",
								"comment": "kernel-default-devel-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945077",
								"comment": "kernel-devel-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945084",
								"comment": "kernel-macros-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945090",
								"comment": "kernel-zfcpdump-5.14.21-150500.55.80.2 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009760583",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945078",
								"comment": "kernel-docs-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945085",
								"comment": "kernel-obs-build-5.14.21-150500.55.80.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945087",
								"comment": "kernel-source-5.14.21-150500.55.80.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009945089",
								"comment": "kernel-syms-5.14.21-150500.55.80.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

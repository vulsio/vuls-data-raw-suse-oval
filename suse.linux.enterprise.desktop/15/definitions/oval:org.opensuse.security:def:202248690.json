{
	"id": "oval:org.opensuse.security:def:202248690",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2022-48690",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Development Tools 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2022-48690",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48690",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2022-48690",
				"ref_url": "https://www.suse.com/security/cve/CVE-2022-48690",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:1644-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035263.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1659-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035281.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1663-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019268.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nice: Fix DMA mappings leak\n\nFix leak, when user changes ring parameters.\nDuring reallocation of RX buffers, new DMA mappings are created for\nthose buffers. New buffers with different RX ring count should\nsubstitute older ones, but those buffers were freed in ice_vsi_cfg_rxq\nand reallocated again with ice_alloc_rx_buf. kfree on rx_buf caused\nleak of already mapped DMA.\nReallocate ZC with xdp_buf struct, when BPF program loads. Reallocate\nback to rx_buf, when BPF program unloads.\nIf BPF program is loaded/unloaded and XSK pools are created, reallocate\nRX queues accordingly in XDP_SETUP_XSK_POOL handler.\n\nSteps for reproduction:\nwhile :\ndo\n\tfor ((i=0; i<=8160; i=i+32))\n\tdo\n\t\tethtool -G enp130s0f0 rx $i tx $i\n\t\tsleep 0.5\n\t\tethtool -g enp130s0f0\n\tdone\ndone\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2022-48690 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2022-48690/",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2022-48690 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2022-48690"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1223960",
					"href": "https://bugzilla.suse.com/1223960"
				}
			],
			"issued": {
				"date": "2024-05-16"
			},
			"updated": {
				"date": "2024-08-20"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-development-tools:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861151",
								"comment": "kernel-64kb-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861152",
								"comment": "kernel-64kb-devel-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861160",
								"comment": "kernel-default-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861161",
								"comment": "kernel-default-base-5.14.21-150500.55.62.2.150500.6.27.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861163",
								"comment": "kernel-default-devel-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861169",
								"comment": "kernel-devel-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861176",
								"comment": "kernel-macros-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861182",
								"comment": "kernel-zfcpdump-5.14.21-150500.55.62.2 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009760583",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861170",
								"comment": "kernel-docs-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861177",
								"comment": "kernel-obs-build-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861179",
								"comment": "kernel-source-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861181",
								"comment": "kernel-syms-5.14.21-150500.55.62.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

{
	"id": "oval:org.opensuse.security:def:20214122",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2021-4122",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Enterprise Storage 7",
				"SUSE Enterprise Storage 7.1",
				"SUSE Linux Enterprise Desktop 15 SP2",
				"SUSE Linux Enterprise Desktop 15 SP3",
				"SUSE Linux Enterprise Desktop 15 SP4",
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise Desktop 15 SP6",
				"SUSE Linux Enterprise High Performance Computing 15 SP2",
				"SUSE Linux Enterprise High Performance Computing 15 SP3",
				"SUSE Linux Enterprise High Performance Computing 15 SP4",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP6",
				"SUSE Linux Enterprise Module for Basesystem 15 SP2",
				"SUSE Linux Enterprise Module for Basesystem 15 SP3",
				"SUSE Linux Enterprise Module for Basesystem 15 SP4",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP6",
				"SUSE Linux Enterprise Server 15 SP2",
				"SUSE Linux Enterprise Server 15 SP3",
				"SUSE Linux Enterprise Server 15 SP4",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server 15 SP6",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP2",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP3",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP4",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP6",
				"SUSE Manager Proxy 4.1",
				"SUSE Manager Proxy 4.2",
				"SUSE Manager Proxy 4.3",
				"SUSE Manager Retail Branch Server 4.1",
				"SUSE Manager Retail Branch Server 4.2",
				"SUSE Manager Retail Branch Server 4.3",
				"SUSE Manager Server 4.1",
				"SUSE Manager Server 4.2",
				"SUSE Manager Server 4.3"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2021-4122",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4122",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2021-4122",
				"ref_url": "https://www.suse.com/security/cve/CVE-2021-4122",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-CU-2022:108-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-February/010179.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-CU-2022:1765-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-August/011795.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-IU-2022:31-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-January/010131.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-IU-2022:32-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-January/010132.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-IU-2022:36-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-January/010139.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2022:0144-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2022-January/010043.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "openSUSE-SU-2022:0144-1",
				"ref_url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/ILTMKWZNQBSX2H2MPF3XKXVDEDPDYAIB/",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    It was found that a specially crafted LUKS header could trick cryptsetup into disabling encryption during the recovery of the device. An attacker with physical access to the medium, such as a flash disk, could use this flaw to force a user into permanently disabling the encryption layer of that medium.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2021-4122 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2021-4122/",
					"impact": "medium",
					"cvss3": "5.9/CVSS:3.1/AV:P/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N"
				},
				{
					"text": "CVE-2021-4122 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2021-4122",
					"impact": "medium",
					"cvss3": "4.3/CVSS:3.1/AV:P/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1194469",
					"href": "https://bugzilla.suse.com/1194469"
				}
			],
			"issued": {
				"date": "2022-01-21"
			},
			"updated": {
				"date": "2024-10-31"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:ses:7",
					"cpe:/o:suse:ses:7.1",
					"cpe:/o:suse:sle-module-basesystem:15:sp2",
					"cpe:/o:suse:sle-module-basesystem:15:sp3",
					"cpe:/o:suse:sle-module-basesystem:15:sp4",
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-basesystem:15:sp6",
					"cpe:/o:suse:sle_hpc:15:sp2",
					"cpe:/o:suse:sle_hpc:15:sp3",
					"cpe:/o:suse:sle_hpc:15:sp4",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp2",
					"cpe:/o:suse:sled:15:sp3",
					"cpe:/o:suse:sled:15:sp4",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp2",
					"cpe:/o:suse:sles:15:sp3",
					"cpe:/o:suse:sles:15:sp4",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp2",
					"cpe:/o:suse:sles_sap:15:sp3",
					"cpe:/o:suse:sles_sap:15:sp4",
					"cpe:/o:suse:sles_sap:15:sp5",
					"cpe:/o:suse:suse-manager-proxy:4.1",
					"cpe:/o:suse:suse-manager-proxy:4.2",
					"cpe:/o:suse:suse-manager-proxy:4.3",
					"cpe:/o:suse:suse-manager-retail-branch-server:4.1",
					"cpe:/o:suse:suse-manager-retail-branch-server:4.2",
					"cpe:/o:suse:suse-manager-retail-branch-server:4.3",
					"cpe:/o:suse:suse-manager-server:4.1",
					"cpe:/o:suse:suse-manager-server:4.2",
					"cpe:/o:suse:suse-manager-server:4.3"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302786",
								"comment": "SUSE Enterprise Storage 7 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669875",
								"comment": "SUSE Linux Enterprise Desktop 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009479728",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009281315",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009303870",
								"comment": "SUSE Linux Enterprise Server 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009659637",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302537",
								"comment": "SUSE Manager Proxy 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009346072",
								"comment": "SUSE Manager Retail Branch Server 4.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009302605",
								"comment": "SUSE Manager Server 4.1 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339165",
								"comment": "cryptsetup is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339174",
								"comment": "libcryptsetup-devel is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339166",
								"comment": "libcryptsetup12 is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339167",
								"comment": "libcryptsetup12-32bit is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339168",
								"comment": "libcryptsetup12-hmac is not affected"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009339169",
								"comment": "libcryptsetup12-hmac-32bit is not affected"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009681000",
								"comment": "SUSE Enterprise Storage 7.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669876",
								"comment": "SUSE Linux Enterprise Desktop 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669877",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009301949",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009476340",
								"comment": "SUSE Linux Enterprise Server 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669878",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669879",
								"comment": "SUSE Manager Proxy 4.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009677266",
								"comment": "SUSE Manager Retail Branch Server 4.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669880",
								"comment": "SUSE Manager Server 4.2 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664141",
								"comment": "cryptsetup-2.3.7-150300.3.5.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664142",
								"comment": "cryptsetup-lang-2.3.7-150300.3.5.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664143",
								"comment": "libcryptsetup-devel-2.3.7-150300.3.5.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664144",
								"comment": "libcryptsetup12-2.3.7-150300.3.5.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664145",
								"comment": "libcryptsetup12-32bit-2.3.7-150300.3.5.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664146",
								"comment": "libcryptsetup12-hmac-2.3.7-150300.3.5.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664147",
								"comment": "libcryptsetup12-hmac-32bit-2.3.7-150300.3.5.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669925",
								"comment": "SUSE Linux Enterprise Desktop 15 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669926",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009664291",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669927",
								"comment": "SUSE Linux Enterprise Server 15 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009669928",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009681297",
								"comment": "SUSE Manager Proxy 4.3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009681298",
								"comment": "SUSE Manager Retail Branch Server 4.3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009681299",
								"comment": "SUSE Manager Server 4.3 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887368",
								"comment": "cryptsetup-2.4.3-150400.1.110 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887369",
								"comment": "cryptsetup-lang-2.4.3-150400.1.110 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887370",
								"comment": "cryptsetup-ssh-2.4.3-150400.1.110 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887371",
								"comment": "libcryptsetup-devel-2.4.3-150400.1.110 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887372",
								"comment": "libcryptsetup12-2.4.3-150400.1.110 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887373",
								"comment": "libcryptsetup12-32bit-2.4.3-150400.1.110 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887374",
								"comment": "libcryptsetup12-hmac-2.4.3-150400.1.110 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009887375",
								"comment": "libcryptsetup12-hmac-32bit-2.4.3-150400.1.110 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856173",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009949150",
								"comment": "cryptsetup-2.7.0-150600.1.4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009949151",
								"comment": "cryptsetup-doc-2.7.0-150600.1.4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009949152",
								"comment": "cryptsetup-lang-2.7.0-150600.1.4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009949153",
								"comment": "cryptsetup-ssh-2.7.0-150600.1.4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009949154",
								"comment": "libcryptsetup-devel-2.7.0-150600.1.4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009949155",
								"comment": "libcryptsetup12-2.7.0-150600.1.4 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009949156",
								"comment": "libcryptsetup12-32bit-2.7.0-150600.1.4 is installed"
							}
						]
					}
				]
			}
		]
	}
}

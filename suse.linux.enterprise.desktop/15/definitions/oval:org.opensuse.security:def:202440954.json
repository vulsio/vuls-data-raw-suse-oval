{
	"id": "oval:org.opensuse.security:def:202440954",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-40954",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Development Tools 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-40954",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-40954",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-40954",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-40954",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:2894-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036430.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2902-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036443.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2929-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036473.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2939-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-August/019211.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2947-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-August/036488.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3194-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036835.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3195-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036842.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nnet: do not leave a dangling sk pointer, when socket creation fails\n\nIt is possible to trigger a use-after-free by:\n  * attaching an fentry probe to __sock_release() and the probe calling the\n    bpf_get_socket_cookie() helper\n  * running traceroute -I 1.1.1.1 on a freshly booted VM\n\nA KASAN enabled kernel will log something like below (decoded and stripped):\n==================================================================\nBUG: KASAN: slab-use-after-free in __sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nRead of size 8 at addr ffff888007110dd8 by task traceroute/299\n\nCPU: 2 PID: 299 Comm: traceroute Tainted: G            E      6.10.0-rc2+ #2\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014\nCall Trace:\n <TASK>\ndump_stack_lvl (lib/dump_stack.c:117 (discriminator 1))\nprint_report (mm/kasan/report.c:378 mm/kasan/report.c:488)\n? __sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nkasan_report (mm/kasan/report.c:603)\n? __sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nkasan_check_range (mm/kasan/generic.c:183 mm/kasan/generic.c:189)\n__sock_gen_cookie (./arch/x86/include/asm/atomic64_64.h:15 ./include/linux/atomic/atomic-arch-fallback.h:2583 ./include/linux/atomic/atomic-instrumented.h:1611 net/core/sock_diag.c:29)\nbpf_get_socket_ptr_cookie (./arch/x86/include/asm/preempt.h:94 ./include/linux/sock_diag.h:42 net/core/filter.c:5094 net/core/filter.c:5092)\nbpf_prog_875642cf11f1d139___sock_release+0x6e/0x8e\nbpf_trampoline_6442506592+0x47/0xaf\n__sock_release (net/socket.c:652)\n__sock_create (net/socket.c:1601)\n...\nAllocated by task 299 on cpu 2 at 78.328492s:\nkasan_save_stack (mm/kasan/common.c:48)\nkasan_save_track (mm/kasan/common.c:68)\n__kasan_slab_alloc (mm/kasan/common.c:312 mm/kasan/common.c:338)\nkmem_cache_alloc_noprof (mm/slub.c:3941 mm/slub.c:4000 mm/slub.c:4007)\nsk_prot_alloc (net/core/sock.c:2075)\nsk_alloc (net/core/sock.c:2134)\ninet_create (net/ipv4/af_inet.c:327 net/ipv4/af_inet.c:252)\n__sock_create (net/socket.c:1572)\n__sys_socket (net/socket.c:1660 net/socket.c:1644 net/socket.c:1706)\n__x64_sys_socket (net/socket.c:1718)\ndo_syscall_64 (arch/x86/entry/common.c:52 arch/x86/entry/common.c:83)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\n\nFreed by task 299 on cpu 2 at 78.328502s:\nkasan_save_stack (mm/kasan/common.c:48)\nkasan_save_track (mm/kasan/common.c:68)\nkasan_save_free_info (mm/kasan/generic.c:582)\npoison_slab_object (mm/kasan/common.c:242)\n__kasan_slab_free (mm/kasan/common.c:256)\nkmem_cache_free (mm/slub.c:4437 mm/slub.c:4511)\n__sk_destruct (net/core/sock.c:2117 net/core/sock.c:2208)\ninet_create (net/ipv4/af_inet.c:397 net/ipv4/af_inet.c:252)\n__sock_create (net/socket.c:1572)\n__sys_socket (net/socket.c:1660 net/socket.c:1644 net/socket.c:1706)\n__x64_sys_socket (net/socket.c:1718)\ndo_syscall_64 (arch/x86/entry/common.c:52 arch/x86/entry/common.c:83)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\n\nFix this by clearing the struct socket reference in sk_common_release() to cover\nall protocol families create functions, which may already attached the\nreference to the sk object with sock_init_data().\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-40954 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-40954/",
					"impact": "high",
					"cvss3": "7/CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-40954 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-40954",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1227808",
					"href": "https://bugzilla.suse.com/1227808"
				},
				{
					"text": "SUSE bug 1228786",
					"href": "https://bugzilla.suse.com/1228786"
				}
			],
			"issued": {
				"date": "2024-08-17"
			},
			"updated": {
				"date": "2024-09-11"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-development-tools:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879870",
								"comment": "kernel-64kb-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879871",
								"comment": "kernel-64kb-devel-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879879",
								"comment": "kernel-default-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879880",
								"comment": "kernel-default-base-5.14.21-150500.55.73.1.150500.6.33.8 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879882",
								"comment": "kernel-default-devel-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879888",
								"comment": "kernel-devel-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879895",
								"comment": "kernel-macros-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879901",
								"comment": "kernel-zfcpdump-5.14.21-150500.55.73.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009760583",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879889",
								"comment": "kernel-docs-5.14.21-150500.55.73.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879896",
								"comment": "kernel-obs-build-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879898",
								"comment": "kernel-source-5.14.21-150500.55.73.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009879900",
								"comment": "kernel-syms-5.14.21-150500.55.73.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

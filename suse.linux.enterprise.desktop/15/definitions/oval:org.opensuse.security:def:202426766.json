{
	"id": "oval:org.opensuse.security:def:202426766",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-26766",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Development Tools 15 SP5",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-26766",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26766",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-26766",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-26766",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:1490-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035140.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1641-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035266.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1644-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035263.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1647-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035260.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1659-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035281.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1677-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035289.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1679-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035290.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1680-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-May/018547.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1682-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-May/018546.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1685-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035299.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1695-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-May/018549.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1705-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035311.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1711-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035318.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1726-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035324.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1739-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-May/018580.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1740-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-May/018579.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1748-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035336.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1749-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035334.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1750-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035333.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1753-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-May/018584.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1757-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-May/035341.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:1759-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-May/018592.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2092-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-June/035659.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2162-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-June/018785.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:2163-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-June/018784.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nIB/hfi1: Fix sdma.h tx->num_descs off-by-one error\n\nUnfortunately the commit `fd8958efe877` introduced another error\ncausing the `descs` array to overflow. This reults in further crashes\neasily reproducible by `sendmsg` system call.\n\n[ 1080.836473] general protection fault, probably for non-canonical address 0x400300015528b00a: 0000 [#1] PREEMPT SMP PTI\n[ 1080.869326] RIP: 0010:hfi1_ipoib_build_ib_tx_headers.constprop.0+0xe1/0x2b0 [hfi1]\n--\n[ 1080.974535] Call Trace:\n[ 1080.976990]  <TASK>\n[ 1081.021929]  hfi1_ipoib_send_dma_common+0x7a/0x2e0 [hfi1]\n[ 1081.027364]  hfi1_ipoib_send_dma_list+0x62/0x270 [hfi1]\n[ 1081.032633]  hfi1_ipoib_send+0x112/0x300 [hfi1]\n[ 1081.042001]  ipoib_start_xmit+0x2a9/0x2d0 [ib_ipoib]\n[ 1081.046978]  dev_hard_start_xmit+0xc4/0x210\n--\n[ 1081.148347]  __sys_sendmsg+0x59/0xa0\n\ncrash> ipoib_txreq 0xffff9cfeba229f00\nstruct ipoib_txreq {\n  txreq = {\n    list = {\n      next = 0xffff9cfeba229f00,\n      prev = 0xffff9cfeba229f00\n    },\n    descp = 0xffff9cfeba229f40,\n    coalesce_buf = 0x0,\n    wait = 0xffff9cfea4e69a48,\n    complete = 0xffffffffc0fe0760 <hfi1_ipoib_sdma_complete>,\n    packet_len = 0x46d,\n    tlen = 0x0,\n    num_desc = 0x0,\n    desc_limit = 0x6,\n    next_descq_idx = 0x45c,\n    coalesce_idx = 0x0,\n    flags = 0x0,\n    descs = {{\n        qw = {0x8024000120dffb00, 0x4}  # SDMA_DESC0_FIRST_DESC_FLAG (bit 63)\n      }, {\n        qw = {  0x3800014231b108, 0x4}\n      }, {\n        qw = { 0x310000e4ee0fcf0, 0x8}\n      }, {\n        qw = {  0x3000012e9f8000, 0x8}\n      }, {\n        qw = {  0x59000dfb9d0000, 0x8}\n      }, {\n        qw = {  0x78000e02e40000, 0x8}\n      }}\n  },\n  sdma_hdr =  0x400300015528b000,  <<< invalid pointer in the tx request structure\n  sdma_status = 0x0,                   SDMA_DESC0_LAST_DESC_FLAG (bit 62)\n  complete = 0x0,\n  priv = 0x0,\n  txq = 0xffff9cfea4e69880,\n  skb = 0xffff9d099809f400\n}\n\nIf an SDMA send consists of exactly 6 descriptors and requires dword\npadding (in the 7th descriptor), the sdma_txreq descriptor array is not\nproperly expanded and the packet will overflow into the container\nstructure. This results in a panic when the send completion runs. The\nexact panic varies depending on what elements of the container structure\nget corrupted. The fix is to use the correct expression in\n_pad_sdma_tx_descs() to test the need to expand the descriptor array.\n\nWith this patch the crashes are no longer reproducible and the machine is\nstable.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Important",
			"cve": [
				{
					"text": "CVE-2024-26766 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-26766/",
					"impact": "high",
					"cvss3": "7.8/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
				},
				{
					"text": "CVE-2024-26766 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-26766"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1222726",
					"href": "https://bugzilla.suse.com/1222726"
				},
				{
					"text": "SUSE bug 1222882",
					"href": "https://bugzilla.suse.com/1222882"
				}
			],
			"issued": {
				"date": "2024-05-16"
			},
			"updated": {
				"date": "2024-06-22"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-development-tools:15:sp5",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterias": [
							{
								"operator": "OR",
								"criterias": [
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861528",
												"comment": "no kernel-livepatch-5_14_21-150500_13_11-rt is greater or equal than 10-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861632",
												"comment": "no kernel-livepatch-5_14_21-150500_13_18-rt is greater or equal than 9-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861529",
												"comment": "no kernel-livepatch-5_14_21-150500_13_21-rt is greater or equal than 8-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861530",
												"comment": "no kernel-livepatch-5_14_21-150500_13_24-rt is greater or equal than 8-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861531",
												"comment": "no kernel-livepatch-5_14_21-150500_13_27-rt is greater or equal than 7-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861633",
												"comment": "no kernel-livepatch-5_14_21-150500_13_30-rt is greater or equal than 6-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009868194",
												"comment": "no kernel-livepatch-5_14_21-150500_13_35-rt is greater or equal than 5-150500.11.8.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009711321",
												"comment": "kernel-default  is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861534",
												"comment": "no kernel-livepatch-5_14_21-150500_13_5-rt is greater or equal than 12-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009796015",
												"comment": "kernel-default 5.14.21-150500.55.12.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861858",
												"comment": "no kernel-livepatch-5_14_21-150500_55_12-default is greater or equal than 11-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009799694",
												"comment": "kernel-default 5.14.21-150500.55.19.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861859",
												"comment": "no kernel-livepatch-5_14_21-150500_55_19-default is greater or equal than 10-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009807722",
												"comment": "kernel-default 5.14.21-150500.55.28.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861860",
												"comment": "no kernel-livepatch-5_14_21-150500_55_28-default is greater or equal than 9-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009816469",
												"comment": "kernel-default 5.14.21-150500.55.31.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861861",
												"comment": "no kernel-livepatch-5_14_21-150500_55_31-default is greater or equal than 8-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009845879",
												"comment": "kernel-default 5.14.21-150500.55.36.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861862",
												"comment": "no kernel-livepatch-5_14_21-150500_55_36-default is greater or equal than 7-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009845884",
												"comment": "kernel-default 5.14.21-150500.55.39.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861634",
												"comment": "no kernel-livepatch-5_14_21-150500_55_39-default is greater or equal than 7-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009849163",
												"comment": "kernel-default 5.14.21-150500.55.44.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861863",
												"comment": "no kernel-livepatch-5_14_21-150500_55_44-default is greater or equal than 6-150500.2.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009854334",
												"comment": "kernel-default 5.14.21-150500.55.49.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861772",
												"comment": "no kernel-livepatch-5_14_21-150500_55_49-default is greater or equal than 4-150500.11.8.1"
											}
										]
									},
									{
										"operator": "AND",
										"criterions": [
											{
												"test_ref": "oval:org.opensuse.security:tst:2009796017",
												"comment": "kernel-default 5.14.21-150500.55.7.1 is installed"
											},
											{
												"test_ref": "oval:org.opensuse.security:tst:2009861775",
												"comment": "no kernel-livepatch-5_14_21-150500_55_7-default is greater or equal than 11-150500.2.1"
											}
										]
									}
								],
								"criterions": [
									{
										"test_ref": "oval:org.opensuse.security:tst:2009711367",
										"comment": "kernel-default is less than "
									}
								]
							}
						],
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861151",
								"comment": "kernel-64kb-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861152",
								"comment": "kernel-64kb-devel-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861161",
								"comment": "kernel-default-base-5.14.21-150500.55.62.2.150500.6.27.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861163",
								"comment": "kernel-default-devel-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861169",
								"comment": "kernel-devel-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861176",
								"comment": "kernel-macros-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861182",
								"comment": "kernel-zfcpdump-5.14.21-150500.55.62.2 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009760583",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861170",
								"comment": "kernel-docs-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861177",
								"comment": "kernel-obs-build-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861179",
								"comment": "kernel-source-5.14.21-150500.55.62.2 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009861181",
								"comment": "kernel-syms-5.14.21-150500.55.62.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

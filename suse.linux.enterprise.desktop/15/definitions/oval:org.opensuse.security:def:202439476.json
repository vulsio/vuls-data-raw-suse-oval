{
	"id": "oval:org.opensuse.security:def:202439476",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-39476",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP6",
				"SUSE Linux Enterprise High Performance Computing 15 SP6",
				"SUSE Linux Enterprise Module for Basesystem 15 SP6",
				"SUSE Linux Enterprise Module for Development Tools 15 SP6",
				"SUSE Linux Enterprise Server 15 SP6",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-39476",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39476",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-39476",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-39476",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3194-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036835.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3195-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-updates/2024-September/036842.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3383-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-September/019497.html",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    In the Linux kernel, the following vulnerability has been resolved:\n\nmd/raid5: fix deadlock that raid5d() wait for itself to clear MD_SB_CHANGE_PENDING\n\nXiao reported that lvm2 test lvconvert-raid-takeover.sh can hang with\nsmall possibility, the root cause is exactly the same as commit\nbed9e27baf52 (\"Revert \"md/raid5: Wait for MD_SB_CHANGE_PENDING in raid5d\"\")\n\nHowever, Dan reported another hang after that, and junxiao investigated\nthe problem and found out that this is caused by plugged bio can't issue\nfrom raid5d().\n\nCurrent implementation in raid5d() has a weird dependence:\n\n1) md_check_recovery() from raid5d() must hold 'reconfig_mutex' to clear\n   MD_SB_CHANGE_PENDING;\n2) raid5d() handles IO in a deadloop, until all IO are issued;\n3) IO from raid5d() must wait for MD_SB_CHANGE_PENDING to be cleared;\n\nThis behaviour is introduce before v2.6, and for consequence, if other\ncontext hold 'reconfig_mutex', and md_check_recovery() can't update\nsuper_block, then raid5d() will waste one cpu 100% by the deadloop, until\n'reconfig_mutex' is released.\n\nRefer to the implementation from raid1 and raid10, fix this problem by\nskipping issue IO if MD_SB_CHANGE_PENDING is still set after\nmd_check_recovery(), daemon thread will be woken up when 'reconfig_mutex'\nis released. Meanwhile, the hang problem will be fixed as well.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Moderate",
			"cve": [
				{
					"text": "CVE-2024-39476 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-39476/",
					"impact": "medium",
					"cvss3": "5.1/CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-39476 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-39476",
					"impact": "medium",
					"cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1227437",
					"href": "https://bugzilla.suse.com/1227437"
				}
			],
			"issued": {
				"date": "2024-09-24"
			},
			"updated": {
				"date": "2024-09-24"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp6",
					"cpe:/o:suse:sle-module-development-tools:15:sp6"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856173",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944158",
								"comment": "kernel-64kb-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944159",
								"comment": "kernel-64kb-devel-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944167",
								"comment": "kernel-default-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944168",
								"comment": "kernel-default-base-6.4.0-150600.23.22.1.150600.12.8.3 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944170",
								"comment": "kernel-default-devel-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944176",
								"comment": "kernel-devel-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944183",
								"comment": "kernel-macros-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944189",
								"comment": "kernel-zfcpdump-6.4.0-150600.23.22.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856253",
								"comment": "SUSE Linux Enterprise Module for Development Tools 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944177",
								"comment": "kernel-docs-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944184",
								"comment": "kernel-obs-build-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944186",
								"comment": "kernel-source-6.4.0-150600.23.22.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009944188",
								"comment": "kernel-syms-6.4.0-150600.23.22.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}

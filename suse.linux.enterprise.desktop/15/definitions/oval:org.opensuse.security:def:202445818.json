{
	"id": "oval:org.opensuse.security:def:202445818",
	"version": "1",
	"class": "vulnerability",
	"metadata": {
		"title": "CVE-2024-45818",
		"affected": {
			"family": "unix",
			"platform": [
				"SUSE Linux Enterprise Desktop 15 SP5",
				"SUSE Linux Enterprise Desktop 15 SP6",
				"SUSE Linux Enterprise High Performance Computing 15 SP5",
				"SUSE Linux Enterprise High Performance Computing 15 SP6",
				"SUSE Linux Enterprise Module for Basesystem 15 SP5",
				"SUSE Linux Enterprise Module for Basesystem 15 SP6",
				"SUSE Linux Enterprise Server 15 SP5",
				"SUSE Linux Enterprise Server 15 SP6",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP5",
				"SUSE Linux Enterprise Server for SAP Applications 15 SP6"
			]
		},
		"reference": [
			{
				"ref_id": "Mitre CVE-2024-45818",
				"ref_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45818",
				"source": "CVE"
			},
			{
				"ref_id": "SUSE CVE-2024-45818",
				"ref_url": "https://www.suse.com/security/cve/CVE-2024-45818",
				"source": "SUSE CVE"
			},
			{
				"ref_id": "SUSE-SU-2024:3977-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019810.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3979-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019812.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:3980-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019811.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4073-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019847.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4116-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-November/019878.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "SUSE-SU-2024:4163-1",
				"ref_url": "https://lists.suse.com/pipermail/sle-security-updates/2024-December/019907.html",
				"source": "SUSE-SU"
			},
			{
				"ref_id": "openSUSE-SU-2024:14530-1",
				"ref_url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/BEWRLARXOTVNP23NN77IW3VFLNMEXBMM/",
				"source": "SUSE-SU"
			}
		],
		"description": "\n    The hypervisor contains code to accelerate VGA memory accesses for HVM\nguests, when the (virtual) VGA is in \"standard\" mode.  Locking involved\nthere has an unusual discipline, leaving a lock acquired past the\nreturn from the function that acquired it.  This behavior results in a\nproblem when emulating an instruction with two memory accesses, both of\nwhich touch VGA memory (plus some further constraints which aren't\nrelevant here).  When emulating the 2nd access, the lock that is already\nbeing held would be attempted to be re-acquired, resulting in a\ndeadlock.\n\nThis deadlock was already found when the code was first introduced, but\nwas analysed incorrectly and the fix was incomplete.  Analysis in light\nof the new finding cannot find a way to make the existing locking\ndiscipline work.\n\nIn staging, this logic has all been removed because it was discovered\nto be accidentally disabled since Xen 4.7.  Therefore, we are fixing the\nlocking problem by backporting the removal of most of the feature.  Note\nthat even with the feature disabled, the lock would still be acquired\nfor any accesses to the VGA MMIO region.\n    ",
		"advisory": {
			"from": "security@suse.de",
			"severity": "Important",
			"cve": [
				{
					"text": "CVE-2024-45818 at SUSE",
					"href": "https://www.suse.com/security/cve/CVE-2024-45818/",
					"impact": "medium",
					"cvss3": "6.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H"
				},
				{
					"text": "CVE-2024-45818 at NVD",
					"href": "https://nvd.nist.gov/vuln/detail/CVE-2024-45818"
				}
			],
			"bugzilla": [
				{
					"text": "SUSE bug 1232622",
					"href": "https://bugzilla.suse.com/1232622"
				}
			],
			"issued": {
				"date": "2024-11-15"
			},
			"updated": {
				"date": "2024-12-23"
			},
			"affected_cpe_list": {
				"cpe": [
					"cpe:/o:suse:sle-module-basesystem:15:sp5",
					"cpe:/o:suse:sle-module-basesystem:15:sp6",
					"cpe:/o:suse:sle_hpc:15:sp5",
					"cpe:/o:suse:sled:15:sp5",
					"cpe:/o:suse:sles:15:sp5",
					"cpe:/o:suse:sles_sap:15:sp5"
				]
			}
		}
	},
	"criteria": {
		"operator": "OR",
		"criterias": [
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759898",
								"comment": "SUSE Linux Enterprise Desktop 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759899",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759900",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759901",
								"comment": "SUSE Linux Enterprise Server 15 SP5 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009759902",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP5 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009951996",
								"comment": "xen-libs-4.17.5_06-150500.3.42.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009951997",
								"comment": "xen-tools-domU-4.17.5_06-150500.3.42.1 is installed"
							}
						]
					}
				]
			},
			{
				"operator": "AND",
				"criterias": [
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856171",
								"comment": "SUSE Linux Enterprise Desktop 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856172",
								"comment": "SUSE Linux Enterprise High Performance Computing 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856173",
								"comment": "SUSE Linux Enterprise Module for Basesystem 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856174",
								"comment": "SUSE Linux Enterprise Server 15 SP6 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009856175",
								"comment": "SUSE Linux Enterprise Server for SAP Applications 15 SP6 is installed"
							}
						]
					},
					{
						"operator": "OR",
						"criterions": [
							{
								"test_ref": "oval:org.opensuse.security:tst:2009956464",
								"comment": "xen-libs-4.18.3_06-150600.3.12.1 is installed"
							},
							{
								"test_ref": "oval:org.opensuse.security:tst:2009956465",
								"comment": "xen-tools-domU-4.18.3_06-150600.3.12.1 is installed"
							}
						]
					}
				]
			}
		]
	}
}
